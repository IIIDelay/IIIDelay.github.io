<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/en/database/dbms/mysql.html"><meta property="og:site_name" content="IIIDelayçš„ Blog"><meta property="og:title" content="InnoDBå››å¤§ç‰¹æ€§"><meta property="og:description" content="InnoDBå››å¤§ç‰¹æ€§ 1ã€æ’å…¥ç¼“å†²(insert buffer) æ’å…¥ç¼“å†²(Insert Buffer/Change Buffer): æå‡æ’å…¥æ€§èƒ½, change bufferingæ˜¯insert bufferçš„åŠ å¼º, insert bufferåªé’ˆå¯¹insertæœ‰æ•ˆ, change bufferingå¯¹insertã€deleteã€update(delete+insert)ã€purgeéƒ½æœ‰æ•ˆ ä½¿ç”¨æ’å…¥ç¼“å†²çš„æ¡ä»¶: éèšé›†ç´¢å¼•(è¾…åŠ©ç´¢å¼•) éå”¯ä¸€ç´¢å¼•"><meta property="og:type" content="article"><meta property="og:image" content="https://mister-hope.github.io/"><meta property="og:locale" content="en-US"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="InnoDBå››å¤§ç‰¹æ€§"><meta property="article:author" content="Mr.IIIDelay"><meta property="article:tag" content="mysql"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"InnoDBå››å¤§ç‰¹æ€§","image":["https://mister-hope.github.io/"],"dateModified":null,"author":[{"@type":"Person","name":"Mr.IIIDelay","url":"https://mrhope.site"}]}</script><title>InnoDBå››å¤§ç‰¹æ€§ | IIIDelayçš„ Blog</title><meta name="description" content="InnoDBå››å¤§ç‰¹æ€§ 1ã€æ’å…¥ç¼“å†²(insert buffer) æ’å…¥ç¼“å†²(Insert Buffer/Change Buffer): æå‡æ’å…¥æ€§èƒ½, change bufferingæ˜¯insert bufferçš„åŠ å¼º, insert bufferåªé’ˆå¯¹insertæœ‰æ•ˆ, change bufferingå¯¹insertã€deleteã€update(delete+insert)ã€purgeéƒ½æœ‰æ•ˆ ä½¿ç”¨æ’å…¥ç¼“å†²çš„æ¡ä»¶: éèšé›†ç´¢å¼•(è¾…åŠ©ç´¢å¼•) éå”¯ä¸€ç´¢å¼•">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-6a04a3cc.css" as="style"><link rel="stylesheet" href="/assets/style-6a04a3cc.css">
    <link rel="modulepreload" href="/assets/app-9ec1fb3d.js"><link rel="modulepreload" href="/assets/framework-b5ea9e64.js"><link rel="modulepreload" href="/assets/mysql.html-324def58.js"><link rel="modulepreload" href="/assets/mysql.html-fdda8b04.js"><link rel="prefetch" href="/assets/intro.html-3cd3e86c.js" as="script"><link rel="prefetch" href="/assets/index.html-25ccf11e.js" as="script"><link rel="prefetch" href="/assets/slides.html-9b79b21a.js" as="script"><link rel="prefetch" href="/assets/disable.html-5833c3eb.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-5511ae0f.js" as="script"><link rel="prefetch" href="/assets/markdown.html-e4562c5e.js" as="script"><link rel="prefetch" href="/assets/page.html-5677046a.js" as="script"><link rel="prefetch" href="/assets/index.html-046ad4b0.js" as="script"><link rel="prefetch" href="/assets/intro.html-7d3ea627.js" as="script"><link rel="prefetch" href="/assets/index.html-fb2a0ee3.js" as="script"><link rel="prefetch" href="/assets/slides.html-9a7b8de6.js" as="script"><link rel="prefetch" href="/assets/disable.html-cf2277db.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-5219ca3b.js" as="script"><link rel="prefetch" href="/assets/markdown.html-3b8712bd.js" as="script"><link rel="prefetch" href="/assets/page.html-9f106f64.js" as="script"><link rel="prefetch" href="/assets/index.html-c3796375.js" as="script"><link rel="prefetch" href="/assets/disable.html-19217888.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-f9f4cdf1.js" as="script"><link rel="prefetch" href="/assets/markdown.html-890091b1.js" as="script"><link rel="prefetch" href="/assets/page.html-bf9b0ca5.js" as="script"><link rel="prefetch" href="/assets/index.html-28d85643.js" as="script"><link rel="prefetch" href="/assets/index.html-423a4e50.js" as="script"><link rel="prefetch" href="/assets/postgresql.html-65cc7a0e.js" as="script"><link rel="prefetch" href="/assets/mongodb.html-90acf583.js" as="script"><link rel="prefetch" href="/assets/redis.html-cd83f8a8.js" as="script"><link rel="prefetch" href="/assets/elaticsearch.html-0843c52d.js" as="script"><link rel="prefetch" href="/assets/nginx.html-de1349d5.js" as="script"><link rel="prefetch" href="/assets/rocketmq.html-75310599.js" as="script"><link rel="prefetch" href="/assets/list.html-7ad4f4ef.js" as="script"><link rel="prefetch" href="/assets/map.html-346fb2d1.js" as="script"><link rel="prefetch" href="/assets/set.html-8f466ae8.js" as="script"><link rel="prefetch" href="/assets/juc.html-c4a516a5.js" as="script"><link rel="prefetch" href="/assets/thread.html-bc15370b.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-0cfebaa4.js" as="script"><link rel="prefetch" href="/assets/spring.html-8cb8bc36.js" as="script"><link rel="prefetch" href="/assets/springboot.html-90d3e17d.js" as="script"><link rel="prefetch" href="/assets/springmvc.html-17aae2a0.js" as="script"><link rel="prefetch" href="/assets/404.html-8d7ddf59.js" as="script"><link rel="prefetch" href="/assets/index.html-117f57c1.js" as="script"><link rel="prefetch" href="/assets/index.html-64c23b9f.js" as="script"><link rel="prefetch" href="/assets/index.html-f3603623.js" as="script"><link rel="prefetch" href="/assets/index.html-cdb1cd21.js" as="script"><link rel="prefetch" href="/assets/index.html-2daae4c3.js" as="script"><link rel="prefetch" href="/assets/index.html-4c9b9c86.js" as="script"><link rel="prefetch" href="/assets/index.html-78bed988.js" as="script"><link rel="prefetch" href="/assets/index.html-cbc6836f.js" as="script"><link rel="prefetch" href="/assets/index.html-567289df.js" as="script"><link rel="prefetch" href="/assets/index.html-311ca7c9.js" as="script"><link rel="prefetch" href="/assets/index.html-1986a589.js" as="script"><link rel="prefetch" href="/assets/index.html-9a1933f9.js" as="script"><link rel="prefetch" href="/assets/index.html-0b7262b3.js" as="script"><link rel="prefetch" href="/assets/index.html-273e9410.js" as="script"><link rel="prefetch" href="/assets/index.html-6daa24b2.js" as="script"><link rel="prefetch" href="/assets/index.html-8b43dfd1.js" as="script"><link rel="prefetch" href="/assets/index.html-b9502ddb.js" as="script"><link rel="prefetch" href="/assets/index.html-860a114f.js" as="script"><link rel="prefetch" href="/assets/index.html-782963b7.js" as="script"><link rel="prefetch" href="/assets/index.html-fb4b5ad1.js" as="script"><link rel="prefetch" href="/assets/index.html-fd7d15c8.js" as="script"><link rel="prefetch" href="/assets/index.html-2c51a30d.js" as="script"><link rel="prefetch" href="/assets/index.html-a0864148.js" as="script"><link rel="prefetch" href="/assets/index.html-5fc0e626.js" as="script"><link rel="prefetch" href="/assets/index.html-263613fb.js" as="script"><link rel="prefetch" href="/assets/index.html-cce1ce08.js" as="script"><link rel="prefetch" href="/assets/index.html-6851c096.js" as="script"><link rel="prefetch" href="/assets/index.html-4ff8c7b7.js" as="script"><link rel="prefetch" href="/assets/index.html-3ac086ff.js" as="script"><link rel="prefetch" href="/assets/index.html-d1d41465.js" as="script"><link rel="prefetch" href="/assets/index.html-3b736981.js" as="script"><link rel="prefetch" href="/assets/index.html-2adeca1e.js" as="script"><link rel="prefetch" href="/assets/index.html-7f81a989.js" as="script"><link rel="prefetch" href="/assets/index.html-8eaf66f1.js" as="script"><link rel="prefetch" href="/assets/index.html-379e8d35.js" as="script"><link rel="prefetch" href="/assets/index.html-1d6c1649.js" as="script"><link rel="prefetch" href="/assets/index.html-4b5c4258.js" as="script"><link rel="prefetch" href="/assets/index.html-c954921e.js" as="script"><link rel="prefetch" href="/assets/index.html-c5d3e9ea.js" as="script"><link rel="prefetch" href="/assets/index.html-72a61392.js" as="script"><link rel="prefetch" href="/assets/index.html-4fa66a8d.js" as="script"><link rel="prefetch" href="/assets/index.html-e9a7e2c1.js" as="script"><link rel="prefetch" href="/assets/index.html-4f6ef9fe.js" as="script"><link rel="prefetch" href="/assets/index.html-72c728d5.js" as="script"><link rel="prefetch" href="/assets/index.html-0ca60537.js" as="script"><link rel="prefetch" href="/assets/index.html-0b3ed243.js" as="script"><link rel="prefetch" href="/assets/index.html-57a98e87.js" as="script"><link rel="prefetch" href="/assets/index.html-b9a16419.js" as="script"><link rel="prefetch" href="/assets/index.html-b4337409.js" as="script"><link rel="prefetch" href="/assets/index.html-76d6ea93.js" as="script"><link rel="prefetch" href="/assets/index.html-653530f0.js" as="script"><link rel="prefetch" href="/assets/index.html-c7ccd5a2.js" as="script"><link rel="prefetch" href="/assets/index.html-e6bad382.js" as="script"><link rel="prefetch" href="/assets/index.html-92d775ea.js" as="script"><link rel="prefetch" href="/assets/index.html-f0912e82.js" as="script"><link rel="prefetch" href="/assets/index.html-82c102ea.js" as="script"><link rel="prefetch" href="/assets/index.html-b83f8df8.js" as="script"><link rel="prefetch" href="/assets/index.html-467ea473.js" as="script"><link rel="prefetch" href="/assets/index.html-94c1a7a1.js" as="script"><link rel="prefetch" href="/assets/index.html-8dd82581.js" as="script"><link rel="prefetch" href="/assets/intro.html-88bbbba3.js" as="script"><link rel="prefetch" href="/assets/index.html-f6fd53c8.js" as="script"><link rel="prefetch" href="/assets/slides.html-b6ffd39e.js" as="script"><link rel="prefetch" href="/assets/disable.html-66a5c74b.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-3033137a.js" as="script"><link rel="prefetch" href="/assets/markdown.html-cb727f4d.js" as="script"><link rel="prefetch" href="/assets/page.html-8678032e.js" as="script"><link rel="prefetch" href="/assets/index.html-3499a5f6.js" as="script"><link rel="prefetch" href="/assets/intro.html-63d51bdd.js" as="script"><link rel="prefetch" href="/assets/index.html-5d64d0b2.js" as="script"><link rel="prefetch" href="/assets/slides.html-af8ef7ce.js" as="script"><link rel="prefetch" href="/assets/disable.html-5dcf458d.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-0f82cb4a.js" as="script"><link rel="prefetch" href="/assets/markdown.html-b9914991.js" as="script"><link rel="prefetch" href="/assets/page.html-1004e52f.js" as="script"><link rel="prefetch" href="/assets/index.html-b594eaa5.js" as="script"><link rel="prefetch" href="/assets/disable.html-2277927a.js" as="script"><link rel="prefetch" href="/assets/encrypt.html-1aabfd29.js" as="script"><link rel="prefetch" href="/assets/markdown.html-5245eceb.js" as="script"><link rel="prefetch" href="/assets/page.html-8e83bdc7.js" as="script"><link rel="prefetch" href="/assets/index.html-b3c715af.js" as="script"><link rel="prefetch" href="/assets/index.html-065ae608.js" as="script"><link rel="prefetch" href="/assets/postgresql.html-ae4c86e1.js" as="script"><link rel="prefetch" href="/assets/mongodb.html-c8cedc56.js" as="script"><link rel="prefetch" href="/assets/redis.html-c1b5bdc0.js" as="script"><link rel="prefetch" href="/assets/elaticsearch.html-67956eb2.js" as="script"><link rel="prefetch" href="/assets/nginx.html-96968426.js" as="script"><link rel="prefetch" href="/assets/rocketmq.html-09fae1c3.js" as="script"><link rel="prefetch" href="/assets/list.html-ae9043b4.js" as="script"><link rel="prefetch" href="/assets/map.html-573233b4.js" as="script"><link rel="prefetch" href="/assets/set.html-92d35319.js" as="script"><link rel="prefetch" href="/assets/juc.html-b62643aa.js" as="script"><link rel="prefetch" href="/assets/thread.html-ca30083f.js" as="script"><link rel="prefetch" href="/assets/mybatis.html-067666aa.js" as="script"><link rel="prefetch" href="/assets/spring.html-221d03d8.js" as="script"><link rel="prefetch" href="/assets/springboot.html-c5be012c.js" as="script"><link rel="prefetch" href="/assets/springmvc.html-59b25145.js" as="script"><link rel="prefetch" href="/assets/404.html-efcbdfb8.js" as="script"><link rel="prefetch" href="/assets/index.html-c167fb4a.js" as="script"><link rel="prefetch" href="/assets/index.html-4f9a4b5f.js" as="script"><link rel="prefetch" href="/assets/index.html-91822548.js" as="script"><link rel="prefetch" href="/assets/index.html-990bfc25.js" as="script"><link rel="prefetch" href="/assets/index.html-17eeb5a1.js" as="script"><link rel="prefetch" href="/assets/index.html-5ec2fddd.js" as="script"><link rel="prefetch" href="/assets/index.html-b9049faa.js" as="script"><link rel="prefetch" href="/assets/index.html-d7c67c90.js" as="script"><link rel="prefetch" href="/assets/index.html-7b822086.js" as="script"><link rel="prefetch" href="/assets/index.html-11b87b78.js" as="script"><link rel="prefetch" href="/assets/index.html-48e2a336.js" as="script"><link rel="prefetch" href="/assets/index.html-58b4f273.js" as="script"><link rel="prefetch" href="/assets/index.html-178f0ee6.js" as="script"><link rel="prefetch" href="/assets/index.html-4d0f7e32.js" as="script"><link rel="prefetch" href="/assets/index.html-ebf9fe5f.js" as="script"><link rel="prefetch" href="/assets/index.html-da90ef68.js" as="script"><link rel="prefetch" href="/assets/index.html-409f1932.js" as="script"><link rel="prefetch" href="/assets/index.html-dbf81064.js" as="script"><link rel="prefetch" href="/assets/index.html-616a6c28.js" as="script"><link rel="prefetch" href="/assets/index.html-890a76e8.js" as="script"><link rel="prefetch" href="/assets/index.html-8128a73c.js" as="script"><link rel="prefetch" href="/assets/index.html-7c752282.js" as="script"><link rel="prefetch" href="/assets/index.html-74822ef3.js" as="script"><link rel="prefetch" href="/assets/index.html-d80f1d2d.js" as="script"><link rel="prefetch" href="/assets/index.html-87fc4efd.js" as="script"><link rel="prefetch" href="/assets/index.html-6ee8b06d.js" as="script"><link rel="prefetch" href="/assets/index.html-e3aa9d99.js" as="script"><link rel="prefetch" href="/assets/index.html-980af55e.js" as="script"><link rel="prefetch" href="/assets/index.html-51ef4f9f.js" as="script"><link rel="prefetch" href="/assets/index.html-2ad7ffac.js" as="script"><link rel="prefetch" href="/assets/index.html-b2a58a8d.js" as="script"><link rel="prefetch" href="/assets/index.html-f52000ab.js" as="script"><link rel="prefetch" href="/assets/index.html-a3cf3b28.js" as="script"><link rel="prefetch" href="/assets/index.html-025251c7.js" as="script"><link rel="prefetch" href="/assets/index.html-8e0d7594.js" as="script"><link rel="prefetch" href="/assets/index.html-edee18a6.js" as="script"><link rel="prefetch" href="/assets/index.html-e82c4191.js" as="script"><link rel="prefetch" href="/assets/index.html-177d03c9.js" as="script"><link rel="prefetch" href="/assets/index.html-9a262995.js" as="script"><link rel="prefetch" href="/assets/index.html-144bdc4f.js" as="script"><link rel="prefetch" href="/assets/index.html-7a26a869.js" as="script"><link rel="prefetch" href="/assets/index.html-5551fcaa.js" as="script"><link rel="prefetch" href="/assets/index.html-c8e4cb15.js" as="script"><link rel="prefetch" href="/assets/index.html-7a0739b7.js" as="script"><link rel="prefetch" href="/assets/index.html-ca4faf6e.js" as="script"><link rel="prefetch" href="/assets/index.html-69f2b437.js" as="script"><link rel="prefetch" href="/assets/index.html-a36273be.js" as="script"><link rel="prefetch" href="/assets/index.html-ff2ab13e.js" as="script"><link rel="prefetch" href="/assets/index.html-c20b48b5.js" as="script"><link rel="prefetch" href="/assets/index.html-fba460db.js" as="script"><link rel="prefetch" href="/assets/index.html-1ee7a748.js" as="script"><link rel="prefetch" href="/assets/index.html-9f82e955.js" as="script"><link rel="prefetch" href="/assets/index.html-28bf1937.js" as="script"><link rel="prefetch" href="/assets/index.html-b7547097.js" as="script"><link rel="prefetch" href="/assets/index.html-fec46570.js" as="script"><link rel="prefetch" href="/assets/index.html-89bfd3d4.js" as="script"><link rel="prefetch" href="/assets/index.html-64389379.js" as="script"><link rel="prefetch" href="/assets/index.html-f69eb88c.js" as="script"><link rel="prefetch" href="/assets/index.html-b93c98f4.js" as="script"><link rel="prefetch" href="/assets/index.html-48db118f.js" as="script"><link rel="prefetch" href="/assets/giscus-16d370b8.js" as="script"><link rel="prefetch" href="/assets/auto-ba5ecab5.js" as="script"><link rel="prefetch" href="/assets/index-8764208e.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-90b2a35e.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/VuePlayground-2c99d46e.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-6e6cbe40.js" as="script"><link rel="prefetch" href="/assets/SearchResult-bbaa0877.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="IIIDelayçš„ Blog"><!----><span class="site-name hide-in-pad">IIIDelayçš„ Blog</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="Blog Home"><span class="font-icon icon iconfont icon-home" style=""></span>Blog Home<!----></a></div><div class="nav-item hide-in-mobile"><a href="/demo/" class="nav-link" aria-label="Demo"><span class="font-icon icon iconfont icon-discover" style=""></span>Demo<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="JavaBase"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>JavaBase</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>é›†åˆ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/javabase/collection/list" class="nav-link" aria-label="List"><span class="font-icon icon iconfont icon-edit" style=""></span>List<!----></a></li><li class="dropdown-subitem"><a href="/en/database/dbms/en/javabase/collection/set" class="nav-link" aria-label="Set"><span class="font-icon icon iconfont icon-edit" style=""></span>Set<!----></a></li><li class="dropdown-subitem"><a href="/en/database/dbms/en/javabase/collection/map" class="nav-link" aria-label="Map"><span class="font-icon icon iconfont icon-edit" style=""></span>Map<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å¹¶å‘ç¼–ç¨‹</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/javabase/juc/thread" class="nav-link" aria-label="Thread"><span class="font-icon icon iconfont icon-edit" style=""></span>Thread<!----></a></li><li class="dropdown-subitem"><a href="/en/database/dbms/en/javabase/juc/juc" class="nav-link" aria-label="JUC"><span class="font-icon icon iconfont icon-edit" style=""></span>JUC<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•°æ®åº“"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>æ•°æ®åº“</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>dbms</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/database/dbms/mysql" class="nav-link" aria-label="Mysql"><span class="font-icon icon iconfont icon-edit" style=""></span>Mysql<!----></a></li><li class="dropdown-subitem"><a href="/en/database/dbms/en/database/dbms/postgresql" class="nav-link" aria-label="Postgresql"><span class="font-icon icon iconfont icon-edit" style=""></span>Postgresql<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>NoSql</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/database/nosql/mongodb" class="nav-link" aria-label="MongoDB"><span class="font-icon icon iconfont icon-edit" style=""></span>MongoDB<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åˆ†å¸ƒå¼"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>åˆ†å¸ƒå¼</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Cache</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/distributed/cache/redis" class="nav-link" aria-label="Redis"><span class="font-icon icon iconfont icon-edit" style=""></span>Redis<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Load-Balance</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/distributed/loadbalance/nginx" class="nav-link" aria-label="Nginx"><span class="font-icon icon iconfont icon-edit" style=""></span>Nginx<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>MQS</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/distributed/mqs/rocketmq" class="nav-link" aria-label="RocketMQ"><span class="font-icon icon iconfont icon-edit" style=""></span>RocketMQ<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="JavaEE"><span class="title"><span class="font-icon icon iconfont icon-edit" style=""></span>JavaEE</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring-Framework</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/javaee/spring_framework/spring" class="nav-link" aria-label="Spring"><span class="font-icon icon iconfont icon-edit" style=""></span>Spring<!----></a></li><li class="dropdown-subitem"><a href="/en/database/dbms/en/javaee/spring_framework/springmvc" class="nav-link" aria-label="SpringMVC"><span class="font-icon icon iconfont icon-edit" style=""></span>SpringMVC<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ORM</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/en/database/dbms/en/javaee/orm/mybatis" class="nav-link" aria-label="Mybatis"><span class="font-icon icon iconfont icon-edit" style=""></span>Mybatis<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="https://github.com/" rel="noopener noreferrer" target="_blank" aria-label="å®˜ç½‘" class="nav-link"><span class="font-icon icon iconfont icon-note" style=""></span>å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><div class="nav-item"><div class="dropdown-wrapper i18n-dropdown"><button class="dropdown-title" type="button" aria-label="Select language"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/en/database/dbms/mysql.html" class="router-link-active router-link-exact-active nav-link active" aria-label="English"><!---->English<!----></a></li><li class="dropdown-item"><a href="/zh/" class="nav-link" aria-label="ç®€ä½“ä¸­æ–‡"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="nav-item"><a class="repo-link" href="https://github.com/vuepress-theme-hope/vuepress-theme-hope" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">Search</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="Blog Home"><span class="font-icon icon iconfont icon-home" style=""></span>Blog Home<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="font-icon icon iconfont icon-discover" style=""></span><a href="/demo/" class="title">Demo</a><!----></p><ul class="sidebar-links"><li><!--[--><a href="/demo/page.html" class="nav-link sidebar-link sidebar-page" aria-label="Page Config"><span class="font-icon icon iconfont icon-page" style=""></span>Page Config<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/markdown.html" class="nav-link sidebar-link sidebar-page" aria-label="Markdown Enhance"><span class="font-icon icon iconfont icon-markdown" style=""></span>Markdown Enhance<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/disable.html" class="nav-link sidebar-link sidebar-page" aria-label="Disabling layout and features"><span class="font-icon icon iconfont icon-config" style=""></span>Disabling layout and features<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/demo/encrypt.html" class="nav-link sidebar-link sidebar-page" aria-label="Encryption Article"><span class="font-icon icon iconfont icon-lock" style=""></span>Encryption Article<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-note" style=""></span><span class="title">Articles</span><!----></p><ul class="sidebar-links"></ul></section></li><li><!--[--><a href="/intro.html" class="nav-link sidebar-link sidebar-page" aria-label="Intro Page"><span class="font-icon icon iconfont icon-info" style=""></span>Intro Page<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/slides.html" class="nav-link sidebar-link sidebar-page" aria-label="Slide page"><span class="font-icon icon iconfont icon-slides" style=""></span>Slide page<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-edit" style=""></span>InnoDBå››å¤§ç‰¹æ€§</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://mrhope.site" target="_blank" rel="noopener noreferrer">Mr.IIIDelay</a></span><span property="author" content="Mr.IIIDelay"></span></span><!----><!----><!----><span class="page-reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 107 min</span><meta property="timeRequired" content="PT107M"></span><span class="page-category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="page-category-item category1 clickable" role="navigation">DBMS</span><span class="page-category-item category3 clickable" role="navigation">SQL</span><meta property="articleSection" content="DBMS,SQL"></span><span class="page-tag-info" aria-label="TagğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="page-tag-item tag4 clickable" role="navigation">mysql</span><meta property="keywords" content="mysql"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<button class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#èƒŒæ™¯" class="router-link-active router-link-exact-active toc-link level2">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#hash-è¡¨" class="router-link-active router-link-exact-active toc-link level2">Hash è¡¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#äºŒå‰æŸ¥æ‰¾æ ‘-bst" class="router-link-active router-link-exact-active toc-link level2">äºŒå‰æŸ¥æ‰¾æ ‘(BST)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#çº¢é»‘æ ‘" class="router-link-active router-link-exact-active toc-link level2">çº¢é»‘æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å¹³è¡¡äºŒå‰æ ‘-avl" class="router-link-active router-link-exact-active toc-link level2">å¹³è¡¡äºŒå‰æ ‘(AVL)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#bæ ‘" class="router-link-active router-link-exact-active toc-link level2">Bæ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#b-æ ‘" class="router-link-active router-link-exact-active toc-link level2">B+æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#b-æ ‘-1" class="router-link-active router-link-exact-active toc-link level2">B*æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯bæ ‘" class="router-link-active router-link-exact-active toc-link level2">ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯Bæ ‘?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯hashç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯Hashç´¢å¼•?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ€»ç»“" class="router-link-active router-link-exact-active toc-link level2">æ€»ç»“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å‚çœ‹" class="router-link-active router-link-exact-active toc-link level2">å‚çœ‹:</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#èƒŒæ™¯-1" class="router-link-active router-link-exact-active toc-link level2">èƒŒæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å­˜å‚¨å¼•æ“ç®€ä»‹" class="router-link-active router-link-exact-active toc-link level2">å­˜å‚¨å¼•æ“ç®€ä»‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mysql-ä¸­æŸ¥çœ‹å­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">MySQL ä¸­æŸ¥çœ‹å­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#innodbå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">InnoDBå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#myisamå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">MyISAMå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#memoryå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">MEMORYå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#archiveå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level2">ARCHIVEå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å››ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“å¦‚ä½•é€‰æ‹©" class="router-link-active router-link-exact-active toc-link level2">å››ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“å¦‚ä½•é€‰æ‹©</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å…¶ä»–ä¸å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åˆ†æ-äº†è§£å³å¯" class="router-link-active router-link-exact-active toc-link level2">å…¶ä»–ä¸å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åˆ†æ(äº†è§£å³å¯)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#csvå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level3">CSVå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#blackholeå­˜å‚¨å¼•æ“-é»‘æ´å¼•æ“" class="router-link-active router-link-exact-active toc-link level3">BLACKHOLEå­˜å‚¨å¼•æ“(é»‘æ´å¼•æ“)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#performance-schemaå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level3">PERFORMANCE_SCHEMAå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#federatedå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level3">Federatedå­˜å‚¨å¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mergeå­˜å‚¨å¼•æ“" class="router-link-active router-link-exact-active toc-link level3">MERGEå­˜å‚¨å¼•æ“</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é¢è¯•é¢˜-mysql-ä¸­-myisam-å’Œ-innodb-çš„åŒºåˆ«æœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level2">é¢è¯•é¢˜: Mysql ä¸­ MyISAM å’Œ InnoDB çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é¢è¯•é¢˜-mysqlå„ç§å­˜å‚¨å¼•æ“çš„ä½¿ç”¨åœºæ™¯" class="router-link-active router-link-exact-active toc-link level2">é¢è¯•é¢˜: MySQLå„ç§å­˜å‚¨å¼•æ“çš„ä½¿ç”¨åœºæ™¯ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å‚çœ‹-1" class="router-link-active router-link-exact-active toc-link level2">å‚çœ‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ•°æ®åº“ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®åº“ä¼˜åŒ–</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mysql-å•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢-å“ªä¸ªæ•ˆç‡é«˜" class="router-link-active router-link-exact-active toc-link level3">mysql å•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜?</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ…¢æŸ¥è¯¢ä¼˜åŒ–" class="router-link-active router-link-exact-active toc-link level2">æ…¢æŸ¥è¯¢ä¼˜åŒ–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#äº‹åŠ¡" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ˜¯äº‹åŠ¡" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#äº‹åŠ¡çš„ç‰¹æ€§-acid" class="router-link-active router-link-exact-active toc-link level3">äº‹åŠ¡çš„ç‰¹æ€§(ACID)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ˜¯redo-undoæœºåˆ¶" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯Redo/Undoæœºåˆ¶ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ˜¯è„è¯»-å¹»è¯»-ä¸å¯é‡å¤è¯»-äº‹åŠ¡å¯èƒ½å¯¼è‡´çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯è„è¯»ï¼Ÿå¹»è¯»ï¼Ÿä¸å¯é‡å¤è¯»ï¼Ÿ(äº‹åŠ¡å¯èƒ½å¯¼è‡´çš„é—®é¢˜)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#äº‹åŠ¡éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active toc-link level3">äº‹åŠ¡éš”ç¦»çº§åˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mvccåŸç†" class="router-link-active router-link-exact-active toc-link level3">MVCCåŸç†</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mysqlåŠ é”çš„ç›®çš„æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level2">MySQLåŠ é”çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#mysqlçš„é”æ˜¯åŸºäºä»€ä¹ˆå®ç°çš„" class="router-link-active router-link-exact-active toc-link level2">MySQLçš„é”æ˜¯åŸºäºä»€ä¹ˆå®ç°çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è§£å†³å¹¶å‘äº‹åŠ¡é—®é¢˜çš„æ–¹å¼" class="router-link-active router-link-exact-active toc-link level2">è§£å†³å¹¶å‘äº‹åŠ¡é—®é¢˜çš„æ–¹å¼</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å†™å†™æƒ…å†µ" class="router-link-active router-link-exact-active toc-link level3">å†™å†™æƒ…å†µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¯»å†™æˆ–å†™è¯»æƒ…å†µ" class="router-link-active router-link-exact-active toc-link level3">è¯»å†™æˆ–å†™è¯»æƒ…å†µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä¸€è‡´æ€§è¯»" class="router-link-active router-link-exact-active toc-link level3">ä¸€è‡´æ€§è¯»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”å®šè¯»" class="router-link-active router-link-exact-active toc-link level3">é”å®šè¯»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å†™æ“ä½œ" class="router-link-active router-link-exact-active toc-link level3">å†™æ“ä½œ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”çš„å†…å­˜ç»“æ„" class="router-link-active router-link-exact-active toc-link level2">é”çš„å†…å­˜ç»“æ„</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#åŸºæœ¬ä»‹ç»" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”ç»“æ„çš„å˜åŒ–" class="router-link-active router-link-exact-active toc-link level3">é”ç»“æ„çš„å˜åŒ–ï¼š</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å“ªäº›è®°å½•å¯ä»¥æ”¾åœ¨ä¸€ä¸ªé”ç»“æ„ä¸­" class="router-link-active router-link-exact-active toc-link level3">å“ªäº›è®°å½•å¯ä»¥æ”¾åœ¨ä¸€ä¸ªé”ç»“æ„ä¸­ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”ç»“æ„è¯¦è§£" class="router-link-active router-link-exact-active toc-link level3">é”ç»“æ„è¯¦è§£</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”çš„åˆ†ç±»" class="router-link-active router-link-exact-active toc-link level2">é”çš„åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å…±äº«é”å’Œæ’å®ƒé”-è¯»å†™é”" class="router-link-active router-link-exact-active toc-link level2">å…±äº«é”å’Œæ’å®ƒé”(è¯»å†™é”)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å…±äº«é”" class="router-link-active router-link-exact-active toc-link level3">å…±äº«é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ’å®ƒé”" class="router-link-active router-link-exact-active toc-link level3">æ’å®ƒé”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¯»å†™æ„å‘é”" class="router-link-active router-link-exact-active toc-link level2">è¯»å†™æ„å‘é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡¨é”" class="router-link-active router-link-exact-active toc-link level2">è¡¨é”</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ˜¯è¡¨é”" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯è¡¨é”ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ˜¾å¼åŠ è¡¨é”" class="router-link-active router-link-exact-active toc-link level3">æ˜¾å¼åŠ è¡¨é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¡¨é”" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¡¨é”ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡¨çº§åˆ«çš„sé”ã€xé”" class="router-link-active router-link-exact-active toc-link level3">è¡¨çº§åˆ«çš„Sé”ã€Xé”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡¨çº§åˆ«çš„isé”ã€ixé”" class="router-link-active router-link-exact-active toc-link level3">è¡¨çº§åˆ«çš„ISé”ã€IXé”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡¨çº§åˆ«çš„auto-incé”" class="router-link-active router-link-exact-active toc-link level3">è¡¨çº§åˆ«çš„AUTO-INCé”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡Œé”" class="router-link-active router-link-exact-active toc-link level2">è¡Œé”</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä»€ä¹ˆæ˜¯è¡Œé”" class="router-link-active router-link-exact-active toc-link level3">ä»€ä¹ˆæ˜¯è¡Œé”ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡Œé”çš„åŸç†" class="router-link-active router-link-exact-active toc-link level3">è¡Œé”çš„åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è¡Œé”çš„ç±»å‹" class="router-link-active router-link-exact-active toc-link level3">è¡Œé”çš„ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#è®°å½•é”-record-lock" class="router-link-active router-link-exact-active toc-link level3">è®°å½•é”(Record Lock)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é—´éš™é”-gap-lock" class="router-link-active router-link-exact-active toc-link level3">é—´éš™é”(Gap Lock)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä¸´é”®é”-next-key-lock" class="router-link-active router-link-exact-active toc-link level3">ä¸´é”®é”(Next-Key Lock)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ’å…¥æ„å‘é”-lock-insert-intention" class="router-link-active router-link-exact-active toc-link level3">æ’å…¥æ„å‘é”(LOCK_INSERT_INTENTION)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#éšå¼é”" class="router-link-active router-link-exact-active toc-link level3">éšå¼é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#åŠ é”è¯­å¥åˆ†æ" class="router-link-active router-link-exact-active toc-link level2">åŠ é”è¯­å¥åˆ†æ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ™®é€šselectè¯­å¥" class="router-link-active router-link-exact-active toc-link level3">æ™®é€šSELECTè¯­å¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#é”å®šè¯»çš„è¯­å¥" class="router-link-active router-link-exact-active toc-link level3">é”å®šè¯»çš„è¯­å¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#åŠä¸€è‡´æ€§è¯»è¯­å¥" class="router-link-active router-link-exact-active toc-link level3">åŠä¸€è‡´æ€§è¯»è¯­å¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#insertè¯­å¥" class="router-link-active router-link-exact-active toc-link level3">INSERTè¯­å¥</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#åŠ é”æƒ…å†µæ€»ç»“" class="router-link-active router-link-exact-active toc-link level2">åŠ é”æƒ…å†µæ€»ç»“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æŸ¥çœ‹äº‹åŠ¡çš„åŠ é”æƒ…å†µ" class="router-link-active router-link-exact-active toc-link level2">æŸ¥çœ‹äº‹åŠ¡çš„åŠ é”æƒ…å†µ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä½¿ç”¨-information-schema-æ•°æ®åº“ä¸­çš„è¡¨è·å–é”ä¿¡æ¯" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ information_schema æ•°æ®åº“ä¸­çš„è¡¨è·å–é”ä¿¡æ¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#ä½¿ç”¨-show-eninge-innodb-status-è·å–é”ä¿¡æ¯" class="router-link-active router-link-exact-active toc-link level3">ä½¿ç”¨ SHOW ENINGE INNODB STATUS è·å–é”ä¿¡æ¯</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#æ­»é”é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">æ­»é”é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å‚çœ‹-2" class="router-link-active router-link-exact-active toc-link level2">å‚çœ‹ï¼š</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_1-ç´¢å¼•æ˜¯ä»€ä¹ˆ" class="router-link-active router-link-exact-active toc-link level2">1 ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_2-ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active toc-link level2">2 ç´¢å¼•çš„ä¼˜ç¼ºç‚¹ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_3-mysqlçš„ç´¢å¼•ç±»å‹" class="router-link-active router-link-exact-active toc-link level2">3 MySQLçš„ç´¢å¼•ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_4-mysql-ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„é€‰å‹-ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨b-tree-è€Œä¸æ˜¯b-tree-hash-äºŒå‰æ ‘-çº¢é»‘æ ‘" class="router-link-active router-link-exact-active toc-link level2">4 Mysql ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„é€‰å‹(ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨B+Treeï¼Œè€Œä¸æ˜¯B-Treeï¼ŒHashï¼ŒäºŒå‰æ ‘ï¼Œçº¢é»‘æ ‘ï¼Ÿ)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å“ˆå¸Œè¡¨" class="router-link-active router-link-exact-active toc-link level3">å“ˆå¸Œè¡¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#äºŒå‰æŸ¥æ‰¾æ•°-bst" class="router-link-active router-link-exact-active toc-link level3">äºŒå‰æŸ¥æ‰¾æ•°(BST)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#çº¢é»‘æ ‘-1" class="router-link-active router-link-exact-active toc-link level3">çº¢é»‘æ ‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å¹³è¡¡äºŒå‰æ ‘-avl-1" class="router-link-active router-link-exact-active toc-link level3">å¹³è¡¡äºŒå‰æ ‘(AVL)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#bæ ‘-b-æ ‘" class="router-link-active router-link-exact-active toc-link level3">Bæ ‘(B-æ ‘)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#b-æ ‘-2" class="router-link-active router-link-exact-active toc-link level3">B+æ ‘</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_5-innodb-å¼•æ“å’Œ-myisam-å¼•æ“å¯¹ç´¢å¼•çš„å®ç°" class="router-link-active router-link-exact-active toc-link level2">5 Innodb å¼•æ“å’Œ Myisam å¼•æ“å¯¹ç´¢å¼•çš„å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_6-innodbä¸­ä¸€æ£µb-æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®" class="router-link-active router-link-exact-active toc-link level2">6 InnoDBä¸­ä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_7-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">7 èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_8-éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—-è¦†ç›–ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">8 éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—ï¼Ÿ(è¦†ç›–ç´¢å¼•)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_9-è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº" class="router-link-active router-link-exact-active toc-link level2">9 è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåºï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_10-mysqlçš„æœ€å·¦å‰ç¼€åŸåˆ™" class="router-link-active router-link-exact-active toc-link level2">10 MySQLçš„æœ€å·¦å‰ç¼€åŸåˆ™?</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_11-å‰ç¼€ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">11 å‰ç¼€ç´¢å¼•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_12-ç´¢å¼•ä¸‹æ¨" class="router-link-active router-link-exact-active toc-link level2">12 ç´¢å¼•ä¸‹æ¨ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_13-æ€ä¹ˆæŸ¥çœ‹mysqlè¯­å¥æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">13 æ€ä¹ˆæŸ¥çœ‹MySQLè¯­å¥æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_14-ä»€ä¹ˆæƒ…å†µä¸‹ä¸èµ°ç´¢å¼•-ç´¢å¼•å¤±æ•ˆ" class="router-link-active router-link-exact-active toc-link level2">14 ä»€ä¹ˆæƒ…å†µä¸‹ä¸èµ°ç´¢å¼•(ç´¢å¼•å¤±æ•ˆ)ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_15-ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿æ•°å­—ä¸»é”®ä½œä¸ºç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">15 ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿æ•°å­—ä¸»é”®ä½œä¸ºç´¢å¼•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_16-å¦‚ä½•åˆ›å»ºç´¢å¼•" class="router-link-active router-link-exact-active toc-link level2">16 å¦‚ä½•åˆ›å»ºç´¢å¼•ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_17-åˆ›å»ºç´¢å¼•æ—¶éœ€è¦æ³¨æ„ä»€ä¹ˆ-å»ºç´¢å¼•çš„åŸåˆ™æœ‰å“ªäº›" class="router-link-active router-link-exact-active toc-link level2">17 åˆ›å»ºç´¢å¼•æ—¶éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå»ºç´¢å¼•çš„åŸåˆ™æœ‰å“ªäº›ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_18-ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸€å®šèƒ½æé«˜æŸ¥è¯¢çš„æ€§èƒ½å—" class="router-link-active router-link-exact-active toc-link level2">18 ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸€å®šèƒ½æé«˜æŸ¥è¯¢çš„æ€§èƒ½å—ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#_19-mysqlç´¢å¼•å¯¹nullå€¼å¦‚ä½•å¤„ç†çš„" class="router-link-active router-link-exact-active toc-link level2">19. mysqlç´¢å¼•å¯¹Nullå€¼å¦‚ä½•å¤„ç†çš„ï¼Ÿ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å‚è€ƒ" class="router-link-active router-link-exact-active toc-link level2">å‚è€ƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/en/database/dbms/mysql.html#å‚è€ƒ-1" class="router-link-active router-link-exact-active toc-link level2">å‚è€ƒ</a></li><!----><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="innodbå››å¤§ç‰¹æ€§" tabindex="-1"><a class="header-anchor" href="#innodbå››å¤§ç‰¹æ€§" aria-hidden="true">#</a> InnoDBå››å¤§ç‰¹æ€§</h1><h4 id="_1ã€æ’å…¥ç¼“å†²-insert-buffer" tabindex="-1"><a class="header-anchor" href="#_1ã€æ’å…¥ç¼“å†²-insert-buffer" aria-hidden="true">#</a> 1ã€æ’å…¥ç¼“å†²(insert buffer)</h4><blockquote><p>æ’å…¥ç¼“å†²(Insert Buffer/Change Buffer): æå‡æ’å…¥æ€§èƒ½, change bufferingæ˜¯insert bufferçš„åŠ å¼º, insert bufferåªé’ˆå¯¹insertæœ‰æ•ˆ, change bufferingå¯¹insertã€deleteã€update(delete+insert)ã€purgeéƒ½æœ‰æ•ˆ</p></blockquote><p>ä½¿ç”¨æ’å…¥ç¼“å†²çš„æ¡ä»¶:</p><ul><li>éèšé›†ç´¢å¼•(è¾…åŠ©ç´¢å¼•)</li><li>éå”¯ä¸€ç´¢å¼•</li></ul><p>Change bufferæ˜¯ä½œä¸ºbuffer poolä¸­çš„ä¸€éƒ¨åˆ†å­˜åœ¨ã€‚<code>Innodb_change_buffering</code>å‚æ•°ç¼“å­˜æ‰€å¯¹åº”çš„æ“ä½œ(updateä¼šè¢«è®¤ä¸ºæ˜¯delete+insert):</p><ul><li><code>all</code>: é»˜è®¤å€¼, ç¼“å­˜insert, delete, purgesæ“ä½œ</li><li><code>none</code>: ä¸ç¼“å­˜</li><li><code>inserts</code>: ç¼“å­˜insertæ“ä½œ</li><li><code>deletes</code>: ç¼“å­˜deleteæ“ä½œ</li><li><code>changes</code>: ç¼“å­˜insertå’Œdeleteæ“ä½œ</li><li><code>purges</code>: ç¼“å­˜åå°æ‰§è¡Œçš„ç‰©ç†åˆ é™¤æ“ä½œ</li></ul><p><code>innodb_change_buffer_max_size</code>å‚æ•°: æ§åˆ¶ä½¿ç”¨çš„å¤§å°, é»˜è®¤25%, æœ€å¤§å¯è®¾ç½®50%, å¦‚æœmysqlå®ä¾‹ä¸­æœ‰å¤§é‡çš„ä¿®æ”¹æ“ä½œ, å¯è€ƒè™‘å¢å¤§è¯¥å‚æ•°ï¼›</p><p>å¯¹æ»¡è¶³æ’å…¥ç¼“å­˜æ¡ä»¶çš„æ’å…¥, æ¯ä¸€æ¬¡çš„æ’å…¥ä¸æ˜¯å†™åˆ°ç´¢å¼•é¡µä¸­, è€Œæ˜¯:</p><ol><li>ä¼šå…ˆåˆ¤æ–­æ’å…¥çš„éèšé›†ç´¢å¼•é¡µæ˜¯å¦åœ¨ç¼“å†²æ± ä¸­, å¦‚æœåœ¨ç›´æ¥æ’å…¥ï¼›</li><li>å¦‚æœä¸åœ¨, åˆ™å…ˆæ”¾åˆ°insert bufferä¸­, å†æŒ‰ç…§ä¸€å®šçš„é¢‘ç‡è¿›è¡Œåˆå¹¶æ“ä½œ, å†å†™ä¼šç£ç›˜ï¼›</li><li>é€šå¸¸å¯ä»¥å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­, ç›®çš„æ˜¯ä¸ºäº†å‡å°‘éšæœºIOå¸¦æ¥çš„æ€§èƒ½æŸè€—ï¼›</li></ol><p>è¿™æ ·é€šå¸¸èƒ½å°†å¤šä¸ªæ’å…¥åˆå¹¶åˆ°ä¸€ä¸ªæ“ä½œä¸­, ç›®çš„è¿˜æ˜¯ä¸ºäº†<strong>å‡å°‘éšæœºIOå¸¦æ¥æ€§èƒ½æŸè€—</strong>ã€‚</p><p><strong>ä¸Šé¢æè¿‡åœ¨ä¸€å®šé¢‘ç‡ä¸‹è¿›è¡Œåˆå¹¶, é‚£æ‰€è°“çš„é¢‘ç‡æ˜¯ä»€ä¹ˆæ¡ä»¶</strong>ï¼Ÿ</p><ol><li>è¾…åŠ©ç´¢å¼•é¡µè¢«è¯»å–åˆ°ç¼“å†²æ± ä¸­ã€‚æ­£å¸¸çš„selectå…ˆæ£€æŸ¥Insert Bufferæ˜¯å¦æœ‰è¯¥éèšé›†ç´¢å¼•é¡µå­˜åœ¨, è‹¥æœ‰åˆ™åˆå¹¶æ’å…¥ã€‚</li><li>è¾…åŠ©ç´¢å¼•é¡µæ²¡æœ‰å¯ç”¨ç©ºé—´ã€‚ç©ºé—´å°äº1/32é¡µçš„å¤§å°, åˆ™ä¼šå¼ºåˆ¶åˆå¹¶æ“ä½œã€‚</li><li>Master Thread æ¯ç§’å’Œæ¯10ç§’çš„åˆå¹¶æ“ä½œã€‚</li></ol><p>insert bufferçš„æ•°æ®ç»“æ„æ˜¯ä¸€é¢—B+æ ‘ï¼›</p><ul><li>å…¨å±€åªæœ‰ä¸€é¢—insert buffer B+æ ‘, è´Ÿè´£å¯¹æ‰€æœ‰è¡¨çš„è¾…åŠ©ç´¢å¼•è¿›è¡Œinsert bufferï¼›</li><li>è¿™é¢—B+æ ‘æ”¾åœ¨å…±äº«è¡¨ç©ºé—´ä¸­, è¯•å›¾é€šè¿‡ç‹¬ç«‹è¡¨ç©ºé—´ibdæ–‡ä»¶æ¢å¤è¡¨ä¸­æ•°æ®æ—¶, å¾€å¾€ä¼šå¯¼è‡´check tableå¤±è´¥, å› ä¸ºè¡¨ä¸­çš„è¾…åŠ©ç´¢å¼•ä¸­çš„æ•°æ®å¯èƒ½è¿˜åœ¨insert bufferä¸­, ä¹Ÿå°±æ˜¯å…±äº«è¡¨ç©ºé—´ä¸­, æ‰€ä»¥ibdæ–‡ä»¶æ¢å¤å, è¿˜éœ€è¦repair tableæ“ä½œæ¥é‡å»ºè¡¨ä¸Šæ‰€æœ‰çš„è¾…åŠ©ç´¢å¼•ï¼›</li></ul><h4 id="_2ã€äºŒæ¬¡å†™-double-write" tabindex="-1"><a class="header-anchor" href="#_2ã€äºŒæ¬¡å†™-double-write" aria-hidden="true">#</a> 2ã€äºŒæ¬¡å†™(double write)</h4><ol><li>doublewriteç¼“å­˜ä½äºç³»ç»Ÿè¡¨ç©ºé—´çš„å­˜å‚¨åŒºåŸŸ, ç”¨æ¥ç¼“å­˜innodbçš„æ•°æ®é¡µä»innodb buffer poolä¸­flushä¹‹åå¹¶å†™å…¥åˆ°æ•°æ®æ–‡ä»¶ä¹‹å‰ï¼›</li><li>å½“æ“ä½œç³»ç»Ÿæˆ–æ•°æ®åº“è¿›ç¨‹åœ¨æ•°æ®é¡µå†™å…¥ç£ç›˜çš„è¿‡ç¨‹ä¸­å´©æºƒ, å¯ä»¥åœ¨doublewriteç¼“å­˜ä¸­æ‰¾åˆ°æ•°æ®é¡µçš„å¤‡ä»½, ç”¨æ¥æ‰§è¡Œcrashæ¢å¤ï¼›</li><li>æ•°æ®é¡µå†™å…¥åˆ°doublewriteç¼“å­˜çš„åŠ¨ä½œæ‰€éœ€è¦çš„ioæ¶ˆè€—è¦å°äºå†™å…¥åˆ°æ•°æ®æ–‡ä»¶çš„æ¶ˆè€—, å› ä¸ºæ­¤å†™å…¥æ“ä½œä¼šä»¥ä¸€æ¬¡å¤§çš„è¿ç»­å—çš„æ–¹å¼å†™å…¥ï¼›</li></ol><figure><img src="/assets/20210627104446-dfeebea1.png" alt="äºŒæ¬¡å†™è¿‡ç¨‹" tabindex="0" loading="lazy"><figcaption>äºŒæ¬¡å†™è¿‡ç¨‹</figcaption></figure><p>ä»ä¸Šå›¾å¯çŸ¥:</p><ol><li>å†…å­˜ä¸­doublewrite bufferå¤§å°2Mï¼›ç‰©ç†ç£ç›˜ä¸Šå…±äº«è¡¨ç©ºé—´ä¸­è¿ç»­çš„128ä¸ªé¡µ, ä¹Ÿå°±æ˜¯2ä¸ªåŒº(extent)å¤§å°åŒæ ·ä¸º2M</li><li>å¯¹ç¼“å†²æ± è„é¡µè¿›è¡Œåˆ·æ–°æ—¶, ä¸æ˜¯ç›´æ¥å†™ç£ç›˜ã€‚æµç¨‹: <ol><li>é€šè¿‡memcpy()å‡½æ•°å°†è„é¡µå…ˆå¤åˆ¶åˆ°å†…å­˜ä¸­çš„doublewrite buffer</li><li>é€šè¿‡doublewriteåˆ†ä¸¤æ¬¡, æ¯æ¬¡1Mé¡ºåºçš„å†™å…¥å…±äº«è¡¨ç©ºé—´çš„ç‰©ç†ç£ç›˜ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­, doublewriteé¡µæ˜¯è¿ç»­çš„, å› æ­¤è¿™ä¸ªè¿‡ç¨‹æ˜¯é¡ºåºçš„, æ‰€ä»¥å¼€é”€å¹¶ä¸å¤§ï¼›</li><li>å®Œæˆdoublewriteé¡µçš„å†™å…¥å, å†å°†doublewrite bufferä¸­çš„é¡µå†™å…¥å„ä¸ªè¡¨ç©ºé—´æ–‡ä»¶ä¸­, æ­¤æ—¶å†™å…¥æ˜¯ç¦»æ•£çš„, å¯èƒ½ä¼šè¾ƒæ…¢ï¼›</li><li>å¦‚æœæ“ä½œç³»ç»Ÿåœ¨ç¬¬ä¸‰æ­¥çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å´©æºƒ, åœ¨æ¢å¤è¿‡ç¨‹ä¸­, å¯ä»¥ä»å…±äº«è¡¨ç©ºé—´ä¸­çš„doublewriteä¸­æ‰¾åˆ°è¯¥é¡µçš„ä¸€ä¸ªå‰¯æœ¬, å°†å…¶å¤åˆ¶åˆ°è¡¨ç©ºé—´æ–‡ä»¶ä¸­, å†åº”ç”¨é‡åšæ—¥å¿—ï¼›</li></ol></li></ol><h4 id="_3ã€è‡ªé€‚åº”hashç´¢å¼•-ahi" tabindex="-1"><a class="header-anchor" href="#_3ã€è‡ªé€‚åº”hashç´¢å¼•-ahi" aria-hidden="true">#</a> 3ã€è‡ªé€‚åº”hashç´¢å¼•(ahi)</h4><blockquote><p>innodbå­˜å‚¨å¼•æ“ä¼šç›‘æ§å¯¹è¡¨ä¸ŠäºŒçº§ç´¢å¼•çš„æŸ¥æ‰¾, å¦‚æœå‘ç°æŸäºŒçº§ç´¢å¼•è¢«é¢‘ç¹è®¿é—®, æ­¤ç´¢å¼•æˆä¸ºçƒ­æ•°æ®, å»ºç«‹hashç´¢å¼•ä»¥æå‡æŸ¥è¯¢é€Ÿåº¦, æ­¤å»ºç«‹æ˜¯è‡ªåŠ¨å»ºç«‹å“ˆå¸Œç´¢å¼•, æ•…ç§°ä¸ºè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•(adaptive hash index)ã€‚</p></blockquote><p>è¯¥å±æ€§é€šè¿‡<code>innodb_adapitve_hash_index</code>å¼€å¯, ä¹Ÿå¯ä»¥é€šè¿‡<code>â€”skip-innodb_adaptive_hash_index</code>å‚æ•°å…³é—­</p><p>æ³¨æ„äº‹é¡¹:</p><ul><li>è‡ªé€‚åº”å“ˆå¸Œç´¢å¼•ä¼šå ç”¨innodb buffer pool</li><li>åªé€‚åˆæœç´¢ç­‰å€¼(=)çš„æŸ¥è¯¢, å¯¹äºèŒƒå›´æŸ¥æ‰¾ç­‰æ“ä½œ, æ˜¯ä¸èƒ½ä½¿ç”¨çš„</li><li>æç«¯æƒ…å†µä¸‹, è‡ªé€‚åº”hashç´¢å¼•æ‰æœ‰æ¯”è¾ƒå¤§çš„æ„ä¹‰, å¯ä»¥é™ä½é€»è¾‘è¯»</li></ul><h4 id="_4ã€é¢„è¯»-read-ahead" tabindex="-1"><a class="header-anchor" href="#_4ã€é¢„è¯»-read-ahead" aria-hidden="true">#</a> 4ã€é¢„è¯»(read ahead)</h4><blockquote><p><strong>extent å®šä¹‰</strong>: è¡¨ç©ºé—´(tablespace ä¸­çš„ä¸€ç»„ page)</p></blockquote><p>InnoDBä½¿ç”¨ä¸¤ç§é¢„è¯»ç®—æ³•æ¥æé«˜I/Oæ€§èƒ½: çº¿æ€§é¢„è¯»(linear read-ahead)å’Œéšæœºé¢„è¯»(randomread-ahead)ã€‚</p><ul><li>çº¿æ€§é¢„è¯»: ä»¥extentä¸ºå•ä½, å°†ä¸‹ä¸€ä¸ªextentæå‰è¯»å–åˆ°buffer poolä¸­ï¼›</li><li>éšæœºé¢„è¯»: ä»¥extentä¸­çš„pageä¸ºå•ä½, å°†å½“å‰extentä¸­çš„å‰©ä½™çš„pageæå‰è¯»å–åˆ°buffer poolä¸­ï¼›</li></ul><p>çº¿æ€§é¢„è¯»ä¸€ä¸ªé‡è¦å‚æ•°: innodb_read_ahead_threshold, æ§åˆ¶ä»€ä¹ˆæ—¶é—´(è®¿é—®extentä¸­å¤šå°‘é¡µçš„é˜ˆå€¼)è§¦å‘é¢„è¯»ï¼›</p><ul><li>é»˜è®¤: 56, èŒƒå›´: 0ï½64, å€¼è¶Šé«˜, è®¿é—®æ¨¡å¼æ£€æŸ¥è¶Šä¸¥æ ¼ï¼›</li><li>æ²¡æœ‰è¯¥å˜é‡ä¹‹å‰, å½“è®¿é—®åˆ°extentæœ€åä¸€ä¸ªpageæ—¶, innodbä¼šå†³å®šæ˜¯å¦å°†ä¸‹ä¸€ä¸ªextentæ”¾å…¥åˆ°buffer poolä¸­ï¼›</li></ul><p>éšæœºé¢„è¯»è¯´æ˜:</p><ul><li>å½“åŒä¸€ä¸ªextentçš„ä¸€äº›pageåœ¨buffer poolä¸­å‘ç°æ—¶, innodbä¼šå°†extentä¸­å‰©ä½™pageä¸€å¹¶è¯»å–åˆ°buffer poolä¸­ï¼›</li><li>éšæœºé¢„è¯»ç»™innodb codeå¸¦æ¥ä¸€äº›ä¸å¿…è¦çš„å¤æ‚æ€§, æ€§èƒ½ä¸Šä¹Ÿä¸ç¨³å®š, åœ¨5.5ç‰ˆæœ¬å·²ç»åºŸå¼ƒ, å¦‚æœå¯ç”¨, éœ€è¦ä¿®æ”¹å˜é‡: innodb_random_read_aheadä¸ºONï¼›</li></ul><h1 id="mysqlæ•°æ®åº“è¦ç”¨b-æ ‘å­˜å‚¨ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#mysqlæ•°æ®åº“è¦ç”¨b-æ ‘å­˜å‚¨ç´¢å¼•" aria-hidden="true">#</a> Mysqlæ•°æ®åº“è¦ç”¨B+æ ‘å­˜å‚¨ç´¢å¼•ï¼Ÿ</h1><h2 id="èƒŒæ™¯" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯" aria-hidden="true">#</a> èƒŒæ™¯</h2><p>åœ¨é¢è¯•ä¸­, mysqlçš„ç´¢å¼•ç»“æ„åº”è¯¥æ˜¯é«˜é¢‘è€ƒç‚¹äº†ã€‚</p><blockquote><p>é¢è¯•å®˜: ä½ äº†è§£mysqlçš„ç´¢å¼•å—ï¼Ÿ</p><p>æˆ‘: ç´¢å¼•æ˜¯ä¸€ç§ååŠ©å¿«é€ŸæŸ¥è¯¢æ•°æ®çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚</p><p>é¢è¯•å®˜: é‚£ä½ çŸ¥é“mysqlä¸­å­˜å‚¨ç´¢å¼•ç”¨çš„ä»€ä¹ˆæ•°æ®ç»“æ„å—ï¼Ÿ</p><p>æˆ‘: ä¸€èˆ¬ä½¿ç”¨B+æ•°å§ã€‚</p><p>é¢è¯•å®˜: B+æ ‘çš„æŸ¥è¯¢æ—¶é—´å¤§æ¦‚æ˜¯å¤šå°‘ï¼Ÿ</p><p>æˆ‘: å’Œæ ‘çš„é«˜åº¦æœ‰å…³, log(n)</p><p>é¢è¯•å®˜: <strong>mysqlçš„ç´¢å¼•ç»“æ„ä¸ºä»€ä¹ˆé€‰ç”¨B+æ ‘, è€Œä¸æ˜¯é€‰æ‹©äºŒå‰æ’åºæ ‘ã€å¹³è¡¡äºŒå‰æ ‘ã€çº¢é»‘æ ‘ä»¥åŠHashå‘¢ï¼Ÿ</strong></p><p>æˆ‘: â€¦â€¦</p></blockquote><p><strong>mysqlçš„ç´¢å¼•ç»“æ„ä¸ºä»€ä¹ˆé€‰ç”¨B+æ ‘ï¼Ÿ</strong> è¿™ä¸ªé—®é¢˜ä¹‹å‰åœ¨æ€»ç»“ <strong>mysqlç´¢å¼•</strong> çš„æ—¶å€™å·²ç»æ€»ç»“è¿‡äº†, ä½†æ˜¯æ„Ÿè§‰è¿˜æ˜¯æ²¡æœ‰æ€»ç»“åˆ°ä½, è€ƒè™‘çš„æ–¹é¢è¿˜ä¸å¤Ÿå…¨é¢, æ‰€ä»¥è¿™ç¯‡æ–‡ç« å†æ¥ç»†ç»†åœ°æ‹ä¸€ä¸‹ã€‚</p><p>æ•°æ®ç»“æ„é€‰å‹ä»¥å¦‚ä¸‹å›¾çš„userè¡¨è¿›è¡Œåˆ†æ:</p><img src="/assets/20210626100234-4f58496e.png" alt="userè¡¨éƒ¨åˆ†æ•°æ®ç¤ºä¾‹" style="zoom:50%;"><h2 id="hash-è¡¨" tabindex="-1"><a class="header-anchor" href="#hash-è¡¨" aria-hidden="true">#</a> Hash è¡¨</h2><blockquote><p>å“ˆå¸Œç®—æ³•: ä¹Ÿå«æ•£åˆ—ç®—æ³•, å°±æ˜¯æŠŠä»»æ„å€¼(key)é€šè¿‡å“ˆå¸Œå‡½æ•°å˜æ¢ä¸ºå›ºå®šé•¿åº¦çš„ key åœ°å€, é€šè¿‡è¿™ä¸ªåœ°å€è¿›è¡Œæ•°æ®æŸ¥è¯¢çš„æ•°æ®ç»“æ„ã€‚</p></blockquote><img src="/assets/20210626100002-03d427b2.png" alt="å“ˆå¸Œè¡¨åŸç†" style="zoom:67%;"><p>å¦‚æœéœ€è¦æ£€ç´¢<code>id=7</code>çš„æ•°æ®, sqlå¦‚ä¸‹:</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token keyword">user</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“ˆå¸Œç®—æ³•å¿«é€Ÿæ£€ç´¢æ•°æ®çš„è®¡ç®—è¿‡ç¨‹: é¦–å…ˆè®¡ç®—å­˜å‚¨ id=7 çš„æ•°æ®çš„ç‰©ç†åœ°å€ addr=hash(7)=4231, è€Œ 4231 æ˜ å°„çš„ç‰©ç†åœ°å€æ˜¯ 0x77, 0x77 å°±æ˜¯ id=7 å­˜å‚¨çš„é¢æ•°æ®çš„ç‰©ç†åœ°å€, é€šè¿‡è¯¥ç‹¬ç«‹åœ°å€å¯ä»¥æ‰¾åˆ°å¯¹åº” user_name=&#39;g&#39;è¿™ä¸ªæ•°æ®ã€‚</p><p>ä½†æ˜¯hashç®—æ³•å¯èƒ½å‡ºç°<strong>ç¢°æ’é—®é¢˜</strong>, å³hashå‡½æ•°å¯èƒ½è®¡ç®—ç›¸åŒçš„keyå€¼, ä¸åŒçš„keyæ˜ å°„åˆ°äº†åŒä¸€ä¸ªç»“æœã€‚è§£å†³ç¢°æ’é—®é¢˜çš„å¸¸è§æ–¹æ³•æ˜¯<strong>é“¾åœ°å€æ³•</strong> : ç¢°æ’æ•°æ®ä½¿ç”¨é“¾è¡¨è¿æ¥, è®¡ç®—hashå€¼å, åˆ¤æ–­è¯¥å€¼å¦‚æœæœ‰ç¢°æ’, éå†åˆ°é“¾è¡¨, ç›´åˆ°æ‰¾åˆ°çœŸæ­£çš„keyæ‰€å¯¹åº”çš„æ•°æ®ä¸ºæ­¢ã€‚</p><figure><img src="/assets/20210626101110-b95b1b61.png" alt="hashç¢°æ’-é“¾åœ°å€æ³•" tabindex="0" loading="lazy"><figcaption>hashç¢°æ’-é“¾åœ°å€æ³•</figcaption></figure><p>ä»ç®—æ³•æ—¶é—´å¤æ‚åº¦åˆ†ææ¥çœ‹, å“ˆå¸Œç®—æ³•<strong>æ—¶é—´å¤æ‚åº¦ä¸º O(1)</strong>, æ£€ç´¢é€Ÿåº¦éå¸¸å¿«ã€‚æ¯”å¦‚æŸ¥æ‰¾ id=7 çš„æ•°æ®, å“ˆå¸Œç´¢å¼•åªéœ€è¦è®¡ç®—ä¸€æ¬¡å°±å¯ä»¥è·å–åˆ°å¯¹åº”çš„æ•°æ®, æ£€ç´¢é€Ÿåº¦éå¸¸å¿«ã€‚ä½†æ˜¯ Mysql å¹¶æ²¡æœ‰é‡‡å–å“ˆå¸Œä½œä¸ºå…¶åº•å±‚ç®—æ³•ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>select * from user where id &gt;3;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å³hashç®—æ³•é’ˆå¯¹èŒƒå›´æŸ¥æ‰¾æ•ˆç‡å¤ªä½, éœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ‰¾å‡ºæ¥åŠ è½½åˆ°å†…å­˜, ç„¶åå†åœ¨å†…å­˜é‡Œç­›é€‰ç­›é€‰ç›®æ ‡èŒƒå›´å†…çš„æ•°æ®ã€‚</p><p>Hashç´¢å¼•ä»…ä»…é€‚åˆ<strong>ç­‰å€¼æŸ¥è¯¢</strong>, å¦‚æœæ˜¯<strong>èŒƒå›´æŸ¥è¯¢</strong>å’Œ<strong>æ’åº</strong>çš„è¯, å®ƒçš„æ€§èƒ½å°±ä¼šå¤§å¤§ä¸‹é™ã€‚</p><p>è€Œå¾€å¾€æˆ‘ä»¬çš„ä¸šåŠ¡éƒ½æ˜¯å¤æ‚çš„æŸ¥è¯¢, æˆ‘ä»¬æ•°æ®åº“å¤§éƒ¨åˆ†ç“¶é¢ˆä¹Ÿæ˜¯åœ¨æŸ¥è¯¢ä¸Š, æ‰€ä»¥Hashç´¢å¼•åœ¨å¤§éƒ¨åˆ†åœºæ™¯ä¸‹æ˜¯ä¸é€‚åˆçš„ã€‚</p><p><strong>æ€»ç»“: hashè¡¨å¯ä»¥å¿«é€Ÿæ£€ç´¢å•æ¡æ•°æ®, ä½†æ˜¯èŒƒå›´æŸ¥è¯¢å’Œæ’åºçš„æ•ˆç‡å¤ªä½, è€Œä¸”å¯èƒ½éœ€è¦Hashç¢°æ’, æç«¯æƒ…å†µä¸‹æ•ˆç‡ä½ã€‚æ‰€ä»¥ä¸é€‚åˆä½œä¸ºMySQLçš„ç´¢å¼•æ•°æ®ç»“æ„</strong>ã€‚</p><h2 id="äºŒå‰æŸ¥æ‰¾æ ‘-bst" tabindex="-1"><a class="header-anchor" href="#äºŒå‰æŸ¥æ‰¾æ ‘-bst" aria-hidden="true">#</a> äºŒå‰æŸ¥æ‰¾æ ‘(BST)</h2><p>ä¸ºäº†<strong>è§£å†³hashè¡¨èŒƒå›´æŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜</strong>, æˆ‘ä»¬è€ƒè™‘äºŒå‰æŸ¥æ‰¾æ ‘ã€‚</p><p>äºŒå‰æŸ¥æ‰¾æ ‘æ”¯æŒå¿«é€ŸæŸ¥æ‰¾æ•°æ®, æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º, åªéœ€è®¡ç®—ä¸‰æ¬¡å³å¯æ‰¾åˆ°<code>id=7</code>çš„æ•°æ®ã€‚</p><img src="/assets/20210626101831-b0b1e749.png" alt="image-20210626101831123" style="zoom:67%;"><p>äºŒå‰æŸ¥æ‰¾æ•°æŒ‰åºæ’åˆ—(ä»å·¦åˆ°å³å‡åº), å¦‚æœæƒ³æ‰¾åˆ°<code>id&gt;5</code>çš„æ•°æ®, åªéœ€è¦æ‰¾åˆ°<strong>èŠ‚ç‚¹6åŠå…¶å³å­æ ‘</strong>çš„æ•°æ®å³å¯, èŒƒå›´æŸ¥æ‰¾æ¯”è¾ƒå®¹æ˜“å®ç°ã€‚</p><p><strong>æ™®é€šäºŒå‰æ ‘çš„è‡´å‘½ç¼ºç‚¹</strong>: æç«¯æƒ…å†µä¸‹ä¼šé€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨, æ—¶é—´å¤æ‚åº¦ä¸ºO(n), æ€§èƒ½æ€¥å‰§ä¸‹é™, å¦‚ä¸‹å›¾:</p><img src="/assets/20210626102314-689c1c60.png" alt="äºŒå‰æ ‘é€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨"><p>æ•°æ®åº“è¡¨çš„ä¸»é”®idä¸€èˆ¬ä¸ºè‡ªå¢, ä¸Šè¿°çš„çº¿æ€§ç»“æ„æŸ¥æ‰¾é—®é¢˜å¿…ç„¶å‡ºç°, è€Œä¸”é¢‘ç‡è¿˜å¾ˆé«˜ã€‚</p><p><strong>æ€»ç»“: äºŒå‰æŸ¥æ‰¾æ•°æŸ¥è¯¢æ•ˆç‡é«˜, è€Œä¸”å¯ä»¥è§£å†³hashè¡¨èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä½çš„é—®é¢˜, ä½†æ˜¯ä¼šé¢‘ç¹å‡ºç°ä¸å¹³è¡¡é€€åŒ–é—®é¢˜å¯¼è‡´æŸ¥è¯¢æ•ˆç‡ä½çš„é—®é¢˜, æ‰€ä»¥ä¸é€‚åˆä½œä¸ºMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ã€‚</p><h2 id="çº¢é»‘æ ‘" tabindex="-1"><a class="header-anchor" href="#çº¢é»‘æ ‘" aria-hidden="true">#</a> çº¢é»‘æ ‘</h2><p>äºŒå‰æŸ¥æ‰¾æ ‘ä¸å¹³è¡¡, å¯ä»¥é€šè¿‡æ ‘èŠ‚ç‚¹çš„è‡ªåŠ¨æ—‹è½¬å’Œè°ƒæ•´æ¥è§£å†³, ä»è€Œä¿è¯äºŒå‰æ ‘çš„æŸ¥æ‰¾æ€§èƒ½ã€‚æœ€å¸¸è§çš„æ€è·¯æ˜¯å¹³è¡¡äºŒå‰æ ‘å’Œçº¢é»‘æ ‘ã€‚</p><p>çº¢é»‘æ ‘å¯ä»¥è‡ªåŠ¨è°ƒæ•´æ ‘çš„ç»“æ„, å½“äºŒå‰æ ‘ä¸å¹³è¡¡æ—¶, çº¢é»‘æ ‘è‡ªåŠ¨å·¦å³æ—‹è½¬å’ŒèŠ‚ç‚¹å˜è‰², ä¿æŒåŸºæœ¬å¹³è¡¡, æ—¶é—´å¤æ‚åº¦ä¸ºO(logn), æŸ¥è¯¢æ•ˆç‡ä¸ä¼šé™ä½ã€‚å¦‚ä¸‹å›¾, çº¢é»‘æ ‘æŸ¥æ‰¾<code>id=7</code>çš„èŠ‚ç‚¹åªéœ€è¦æŸ¥æ‰¾4æ¬¡:</p><img src="/assets/20210626105121-2725e72c.png" alt="çº¢é»‘æ ‘æŸ¥æ‰¾èŠ‚ç‚¹" style="zoom:80%;"><p><strong>ä½†æ˜¯çº¢é»‘æ ‘ä¹Ÿæœ‰ç¼ºç‚¹, å³â€œå³å€¾â€ç°è±¡</strong>(å‚çœ‹ä¸‹å›¾), è™½ç„¶æ²¡æœ‰äºŒå‰æ ‘é€€åŒ–é‚£ä¹ˆå¤¸å¼ , ä½†æ•°æ®åº“ä¸»é”®åŸºæœ¬éƒ½æ˜¯è‡ªå¢, é¢å¯¹æˆåƒä¸Šç™¾ä¸‡çš„æ•°æ®, è¿™æŸ¥è¯¢æ•ˆç‡å¯æƒ³è€ŒçŸ¥ã€‚</p><figure><img src="/assets/20210626105920-4c5fa6db.png" alt="çº¢é»‘æ ‘â€œå³å€¾â€ç°è±¡" tabindex="0" loading="lazy"><figcaption>çº¢é»‘æ ‘â€œå³å€¾â€ç°è±¡</figcaption></figure><p><strong>æ€»ç»“: çº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡ä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸ä¼¼, æç«¯é€€åŒ–æƒ…å†µæ¯”å¹³è¡¡äºŒå‰æ ‘å¥½, ä½†æ˜¯ä¹Ÿæ²¡èƒ½è¾¾åˆ°é¢„æœŸ, æ‰€ä»¥ä¸é€‚åˆMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ã€‚</p><h2 id="å¹³è¡¡äºŒå‰æ ‘-avl" tabindex="-1"><a class="header-anchor" href="#å¹³è¡¡äºŒå‰æ ‘-avl" aria-hidden="true">#</a> å¹³è¡¡äºŒå‰æ ‘(AVL)</h2><p>æ—¢ç„¶äºŒå‰æ ‘ä¸å¹³è¡¡, ä¸ºäº†è§£å†³å…¶æç«¯æƒ…å†µä¸‹é€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨çš„é—®é¢˜, æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨å¹³è¡¡äºŒå‰æ ‘ã€‚</p><p>AVL æ ‘é¡ºåºæ’å…¥ 1~7 ä¸ªèŠ‚ç‚¹, æŸ¥æ‰¾ id=7 æ‰€è¦æ¯”è¾ƒèŠ‚ç‚¹çš„æ¬¡æ•°ä¸º 3ã€‚</p><p>AVL æ ‘æ’å…¥ 1~16 ä¸ªèŠ‚ç‚¹, æŸ¥æ‰¾ id=16 éœ€è¦æ¯”è¾ƒçš„èŠ‚ç‚¹æ•°ä¸º 4ã€‚ä»æŸ¥æ‰¾æ•ˆç‡è€Œè¨€, AVL æ ‘æŸ¥æ‰¾çš„é€Ÿåº¦è¦é«˜äºçº¢é»‘æ ‘çš„æŸ¥æ‰¾æ•ˆç‡(AVL æ ‘æ˜¯ 4 æ¬¡æ¯”è¾ƒ, çº¢é»‘æ ‘æ˜¯ 6 æ¬¡æ¯”è¾ƒ)ã€‚</p><p>ä»æ ‘çš„å½¢æ€çœ‹æ¥, AVL æ ‘ä¸å­˜åœ¨çº¢é»‘æ ‘çš„â€œå³å€¾â€é—®é¢˜ã€‚å¤§é‡çš„é¡ºåºæ’å…¥ä¸ä¼šå¯¼è‡´æŸ¥è¯¢æ€§èƒ½çš„é™ä½, è¿™ä»æ ¹æœ¬ä¸Šè§£å†³äº†çº¢é»‘æ ‘çš„é—®é¢˜ã€‚</p><p><strong>AVL æ ‘çš„ä¼˜ç‚¹</strong>:</p><ul><li>æŸ¥è¯¢æ•ˆç‡é«˜O(logn), ä¸å­˜åœ¨æç«¯æƒ…å†µã€‚</li><li>å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾å’Œæ’åºã€‚</li></ul><p><strong>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸é€‰å–AVLæ ‘ä½œä¸ºMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ï¼Ÿ</p><p><strong>ä¸»è¦æ˜¯ç£ç›˜IOå› ç´ çš„å½±å“</strong>ã€‚å¦‚æœä½¿ç”¨AVLæ ‘, æ¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹, åªå­˜å‚¨ä¸€ä¸ªæ•°æ®ã€‚å¦‚æœæŸ¥è¯¢<code>id=7</code>çš„æ•°æ®, éœ€è¦æ¯”å¯¹ä¸‰æ¬¡æ ‘èŠ‚ç‚¹, å³è¿›è¡Œä¸‰æ¬¡ç£ç›˜IOæ“ä½œ, å¦‚æœæ•°æ®é‡å¤§äº†, é‚£ç£ç›˜IOçš„æ¬¡æ•°ä¼šå¾ˆé«˜, æ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚</p><p>æ‰€ä»¥, <strong>è®¾è®¡æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™, è¿˜éœ€è¦è€ƒè™‘æ€ä¹ˆå°½å¯èƒ½å‡å°‘ç£ç›˜çš„IOæ¬¡æ•°</strong>ã€‚</p><blockquote><p>æ³¨æ„, æˆ‘ä»¬è¯´çš„å¹³è¡¡äºŒå‰æ ‘ç»“æ„, æŒ‡çš„æ˜¯é€»è¾‘ç»“æ„ä¸Šçš„å¹³è¡¡äºŒå‰æ ‘, å…¶ç‰©ç†å®ç°æ˜¯æ•°ç»„ã€‚ç„¶åç”±äºåœ¨<strong>é€»è¾‘ç»“æ„ä¸Šç›¸è¿‘çš„èŠ‚ç‚¹åœ¨ç‰©ç†ç»“æ„ä¸Šå¯èƒ½ä¼šå·®å¾ˆè¿œ</strong>ã€‚å› æ­¤, <strong>æ¯æ¬¡è¯»å–çš„ç£ç›˜é¡µçš„æ•°æ®ä¸­æœ‰è®¸å¤šæ˜¯ç”¨ä¸ä¸Šçš„</strong>ã€‚å› æ­¤, æŸ¥æ‰¾è¿‡ç¨‹ä¸­è¦è¿›è¡Œè®¸å¤šæ¬¡çš„ç£ç›˜è¯»å–æ“ä½œã€‚</p></blockquote><p><strong>ç£ç›˜è¯»å–1Bå’Œ1KBçš„æ•°æ®æ¶ˆè€—çš„æ—¶é—´åŸºæœ¬æ˜¯ä¸€æ ·çš„, æ‰€ä»¥å¯ä»¥åœ¨ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨æ›´å¤šçš„æ•°æ®, å³ä¸€æ¬¡ç£ç›˜IOè¯»å–æ›´å¤šæ•°æ®, å³å¯è§£å†³é—®é¢˜ã€‚æ‰€ä»¥å°±è€ƒè™‘åˆ°äº†Bæ ‘</strong>ã€‚</p><h2 id="bæ ‘" tabindex="-1"><a class="header-anchor" href="#bæ ‘" aria-hidden="true">#</a> Bæ ‘</h2><p>Bæ ‘æ˜¯ä¸€ç§å¹³è¡¡å¤šè·¯æœç´¢æ ‘, å®ƒçš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰å¤šäºä¸¤ä¸ªå­©å­èŠ‚ç‚¹ã€‚Mè·¯çš„Bæ ‘æœ€å¤šèƒ½æ‹¥æœ‰Mä¸ªå­©å­èŠ‚ç‚¹ã€‚</p><p>å¹³è¡¡äºŒå‰æ ‘æ²¡èƒ½å……åˆ†åˆ©ç”¨ç£ç›˜é¢„è¯»åŠŸèƒ½, è€ŒBæ ‘æ˜¯ä¸ºäº†<strong>å……åˆ†åˆ©ç”¨ç£ç›˜é¢„è¯»åŠŸèƒ½</strong>æ¥è€Œåˆ›å»ºçš„ä¸€ç§æ•°æ®ç»“æ„, ä¹Ÿå°±æ˜¯è¯´Bæ ‘å°±æ˜¯ä¸ºäº†ä½œä¸ºç´¢å¼•æ‰è¢«å‘æ˜å‡ºæ¥çš„çš„ã€‚</p><blockquote><p><strong>ä¸ºå•¥è¦è®¾è®¡æˆå¤šè·¯å‘¢ï¼Ÿ</strong></p><p>æ˜¯ä¸ºäº†è¿›ä¸€æ­¥é™ä½æ ‘çš„é«˜åº¦ã€‚è·¯æ•°è¶Šå¤š, æ ‘çš„é«˜åº¦è¶Šä½ã€‚</p><p><strong>å¦‚æœè®¾è®¡æˆæ— é™å¤šè·¯å¯ä»¥å—ï¼Ÿ</strong></p><p>è®¾è®¡æˆæ— é™å¤šè·¯, æ ‘ä¼šé€€åŒ–æˆæœ‰åºæ•°ç»„ã€‚mysqlé»˜è®¤ä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå°±æ˜¯ä¸€æ¬¡IOè¯»å–æ•°æ®çš„å¤§å°åˆšå¥½æ˜¯16K, ä¸€æ¬¡IOæ˜¯ä¸ºäº†åŠ è½½ä¸€ä¸ªèŠ‚ç‚¹, è¯»å–ä¸€é¡µæ•°æ®, è¿™æ ·å¯ä»¥è¯»æ›´å¤šçš„æ•°æ®ã€‚å¦‚æœæ˜¯æœ‰åºæ•°ç»„, è¿™æ ·åè€Œä¸å¥½, å› ä¸ºæ•°æ®é‡å¤ªå¤§ä¸€æ¬¡ä¸èƒ½å¤Ÿå°†æ•°æ®åŠ è½½åˆ°å†…å­˜ã€‚</p><p><strong>ä½ çŸ¥é“Bæ ‘ä¸€èˆ¬ç”¨åœ¨å“ªé‡Œå—ï¼Ÿ</strong></p><p>Bæ ‘åšæ–‡ä»¶ç³»ç»Ÿçš„ç´¢å¼•æ¯”è¾ƒå¤šã€‚</p><p><strong>ä¸ºä»€ä¹ˆæ–‡ä»¶ç³»ç»Ÿçš„ç´¢å¼•å–œæ¬¢ç”¨Bæ ‘è€Œä¸ç”¨çº¢é»‘æ ‘æˆ–è€…æœ‰åºæ•°ç»„å‘¢?</strong></p><p>æ–‡ä»¶ç³»ç»Ÿå’Œæ•°æ®åº“çš„ç´¢å¼•éƒ½æ˜¯å­˜åœ¨ç¡¬ç›˜ä¸Šçš„, å¹¶ä¸”å¦‚æœæ•°æ®é‡å¤§çš„è¯, ä¸ä¸€å®šèƒ½ä¸€æ¬¡æ€§åŠ è½½åˆ°å†…å­˜ä¸­ã€‚</p><p><strong>å¦‚æœä¸€æ£µæ ‘éƒ½æ— æ³•ä¸€æ¬¡æ€§åŠ è½½è¿›å†…å­˜, ä½ è¯¥æ€ä¹ˆæŸ¥æ‰¾å‘¢?</strong></p><p>è¿™æ—¶å€™Bæ ‘çš„å¤šè·¯å­˜å‚¨å¨åŠ›å°±å‡ºæ¥äº†, å¯ä»¥æ¯æ¬¡åŠ è½½Bæ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹, ç„¶åä¸€æ­¥æ­¥å¾€ä¸‹æ‰¾ã€‚</p><p>å¦‚æœåœ¨å†…å­˜ä¸­,çº¢é»‘æ ‘æ¯”Bæ ‘æ•ˆç‡æ›´é«˜, ä½†æ˜¯æ¶‰åŠåˆ°ç£ç›˜æ“ä½œ, Bæ ‘å°±æ›´ä¼˜äº†ã€‚</p></blockquote><blockquote><p><strong>ç£ç›˜IOä¸é¢„è¯»</strong></p><p>è€ƒè™‘åˆ°ç£ç›˜IOæ˜¯éå¸¸é«˜æ˜‚çš„æ“ä½œ, è®¡ç®—æœºæ“ä½œç³»ç»Ÿåšäº†ä¸€äº›ä¼˜åŒ–, å½“ä¸€æ¬¡IOæ—¶, ä¸å…‰æŠŠå½“å‰ç£ç›˜åœ°å€çš„æ•°æ®, è€Œæ˜¯æŠŠç›¸é‚»çš„æ•°æ®ä¹Ÿéƒ½è¯»å–åˆ°å†…å­˜ç¼“å†²åŒºå†…, å› ä¸ºå±€éƒ¨é¢„è¯»æ€§åŸç†å‘Šè¯‰æˆ‘ä»¬, å½“è®¡ç®—æœºè®¿é—®ä¸€ä¸ªåœ°å€çš„æ•°æ®çš„æ—¶å€™, ä¸å…¶ç›¸é‚»çš„æ•°æ®ä¹Ÿä¼šå¾ˆå¿«è¢«è®¿é—®åˆ°ã€‚</p><p>mysqlæ¯ä¸€æ¬¡IOè¯»å–çš„æ•°æ®æˆ‘ä»¬ç§°ä¹‹ä¸ºä¸€é¡µ(page)ã€‚</p></blockquote><p><strong>å¦‚æœæ¯ä¸ªèŠ‚ç‚¹é™åˆ¶æœ€å¤šå­˜å‚¨ä¸¤ä¸ªkey(å³äºŒå‰æ ‘), ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœè¶…è¿‡ä¸¤ä¸ªkeyä¼šè‡ªåŠ¨åˆ†è£‚ã€‚</strong></p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå­˜å‚¨äº† 7 ä¸ªæ•°æ® B æ ‘, åªéœ€è¦æŸ¥è¯¢ä¸¤ä¸ªèŠ‚ç‚¹å°±å¯ä»¥çŸ¥é“ id=7 è¿™æ•°æ®çš„å…·ä½“ä½ç½®, ä¹Ÿå°±æ˜¯ä¸¤æ¬¡ç£ç›˜ IO å°±å¯ä»¥æŸ¥è¯¢åˆ°æŒ‡å®šæ•°æ®, ä¼˜äº AVL æ ‘ã€‚</p><img src="/assets/20210626112940-eb38c8fa.png" alt="Bæ ‘7èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=2)" style="zoom:80%;"><p>å¦‚æœæ˜¯ä¸€ä¸ªå­˜å‚¨äº† 16 ä¸ªæ•°æ®çš„ B æ ‘, åŒæ ·æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨ 2 ä¸ª key, æŸ¥è¯¢ id=16 è¿™ä¸ªæ•°æ®éœ€è¦æŸ¥è¯¢æ¯”è¾ƒ 4 ä¸ªèŠ‚ç‚¹, ä¹Ÿå°±æ˜¯ç»è¿‡ 4 æ¬¡ç£ç›˜ IOã€‚çœ‹èµ·æ¥æŸ¥è¯¢æ€§èƒ½ä¸ AVL æ ‘ä¸€æ ·ã€‚</p><img src="/assets/20210626115100-cce4d784.png" alt="Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=2)" style="zoom:80%;"><p><strong>å¦‚æœé™åˆ¶æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨6ä¸ªkeyã€‚</strong></p><p>ä¸€ä¸ªå­˜å‚¨äº† 7 ä¸ªæ•°æ®çš„ B æ ‘, æŸ¥è¯¢ id=7 è¿™ä¸ªæ•°æ®æ‰€è¦è¿›è¡Œçš„ç£ç›˜ IO ä¸º 2 æ¬¡ã€‚</p><img src="/assets/20210626115252-4b1a3723.png" alt="Bæ ‘7èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)" style="zoom:80%;"><p>ä¸€ä¸ªå­˜å‚¨äº† 16 ä¸ªæ•°æ®çš„ B æ ‘, æŸ¥è¯¢ id=7 è¿™ä¸ªæ•°æ®æ‰€è¦è¿›è¡Œçš„ç£ç›˜ IO ä¸º 2 æ¬¡ã€‚ç›¸å¯¹äº AVL æ ‘è€Œè¨€ç£ç›˜ IO æ¬¡æ•°é™ä½ä¸ºä¸€åŠã€‚</p><figure><img src="/assets/20210626115329-3e54ec23.png" alt="Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)" tabindex="0" loading="lazy"><figcaption>Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)</figcaption></figure><p><strong>B æ ‘ä½œæ•°æ®åº“ç´¢å¼•ä¼˜ç‚¹</strong>:</p><ul><li>ä¼˜ç§€æ£€ç´¢é€Ÿåº¦, æ—¶é—´å¤æ‚åº¦: B æ ‘çš„æŸ¥æ‰¾æ€§èƒ½ç­‰äº O(h*logn), å…¶ä¸­ h ä¸ºæ ‘é«˜, n ä¸ºæ¯ä¸ªèŠ‚ç‚¹å…³é”®è¯çš„ä¸ªæ•°ï¼›</li><li>å°½å¯èƒ½å°‘çš„ç£ç›˜ IO, åŠ å¿«äº†æ£€ç´¢é€Ÿåº¦ï¼›</li><li>å¯ä»¥æ”¯æŒèŒƒå›´æŸ¥æ‰¾ã€‚</li></ul><p><strong>ç¼ºç‚¹</strong>:</p><p>å¦‚æœæ˜¯å¤šæ¡çš„è¯, Bæ ‘éœ€è¦åš<strong>å±€éƒ¨çš„ä¸­åºéå†, å¯èƒ½è¦è·¨å±‚è®¿é—®</strong>ã€‚</p><h2 id="b-æ ‘" tabindex="-1"><a class="header-anchor" href="#b-æ ‘" aria-hidden="true">#</a> B+æ ‘</h2><p>æ¯”Bæ ‘æ›´é€‚åˆä½œä¸ºç´¢å¼•çš„ç»“æ„æ˜¯B+æ ‘ã€‚MySQLä¸­ä¹Ÿæ˜¯ä½¿ç”¨B+æ ‘ä½œä¸ºç´¢å¼•ã€‚å®ƒæ˜¯Bæ ‘çš„å˜ç§, å› æ­¤æ˜¯åŸºäºBæ ‘æ¥æ”¹è¿›çš„ã€‚ä¸ºä»€ä¹ˆB+æ ‘ä¼šæ¯”Bæ ‘æ›´åŠ ä¼˜ç§€å‘¢ï¼Ÿ</p><ul><li>Bæ ‘: æœ‰åºæ•°ç»„+å¹³è¡¡å¤šå‰æ ‘ï¼›</li><li>B+æ ‘: æœ‰åºæ•°ç»„é“¾è¡¨+å¹³è¡¡å¤šå‰æ ‘ï¼›</li></ul><p><strong>B+æ ‘çš„å…³é”®å­—å…¨éƒ¨å­˜æ”¾åœ¨å¶å­èŠ‚ç‚¹ä¸­, éå¶å­èŠ‚ç‚¹ç”¨æ¥åšç´¢å¼•, è€Œå¶å­èŠ‚ç‚¹ä¸­æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸‹ä¸ªå¶å­èŠ‚ç‚¹</strong>ã€‚åšè¿™ä¸ªä¼˜åŒ–çš„ç›®çš„æ˜¯ä¸ºäº†<strong>æé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½</strong>ã€‚è€Œæ­£æ˜¯è¿™ä¸ªç‰¹æ€§å†³å®šäº†B+æ ‘æ›´é€‚åˆç”¨æ¥å­˜å‚¨å¤–éƒ¨æ•°æ®ã€‚</p><figure><img src="/assets/20210626115803-e46c33d6.png" alt="B+æ ‘" tabindex="0" loading="lazy"><figcaption>B+æ ‘</figcaption></figure><blockquote><p>B+æ ‘è¿˜æœ‰ä¸€ä¸ªæœ€å¤§çš„å¥½å¤„, æ–¹ä¾¿æ‰«åº“, Bæ ‘å¿…é¡»ç”¨ä¸­åºéå†çš„æ–¹æ³•æŒ‰åºæ‰«åº“, è€ŒB+æ ‘ç›´æ¥ä»å¶å­ç»“ç‚¹æŒ¨ä¸ªæ‰«ä¸€éå°±å®Œäº†, B+æ ‘æ”¯æŒrange-queryéå¸¸æ–¹ä¾¿, è€ŒBæ ‘ä¸æ”¯æŒã€‚è¿™æ˜¯æ•°æ®åº“é€‰ç”¨B+æ ‘çš„æœ€ä¸»è¦åŸå› ã€‚</p><p>â€”â€”æ¢æ–Œã€Šèµ°è¿›æœç´¢å¼•æ“ã€‹</p></blockquote><p>æ¯”å¦‚è¦æŸ¥ 5-10ä¹‹é—´çš„, B+æ ‘ä¸€æŠŠåˆ°5è¿™ä¸ªæ ‡è®°, å†ä¸€æŠŠåˆ°10, ç„¶åä¸²èµ·æ¥å°±è¡Œäº†, Bæ ‘å°±éå¸¸éº»çƒ¦ã€‚</p><p>åªæŸ¥è¯¢ä¸€æ¡è®°å½•, Bæ ‘æ€§èƒ½ä¼šå¥½äºB+æ ‘, å› ä¸ºBæ ‘çš„é«˜åº¦æ€»ä½“è¦æ¯”B+æ ‘çŸ®ã€‚ä½†æ˜¯æ›´å¤šçš„ä¸šåŠ¡éœ€è¦çš„å´æ˜¯èŒƒå›´æŸ¥è¯¢ã€‚</p><blockquote><p>æ•°æ®åº“ç´¢å¼•é‡‡ç”¨B+æ ‘çš„ä¸»è¦åŸå› æ˜¯Bæ ‘åœ¨æé«˜äº†ç£ç›˜IOæ€§èƒ½çš„åŒæ—¶å¹¶æ²¡æœ‰è§£å†³å…ƒç´ éå†çš„æ•ˆç‡ä½ä¸‹çš„é—®é¢˜ã€‚æ­£æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, B+æ ‘åº”è¿è€Œç”Ÿã€‚</p><p>B+æ ‘åªè¦éå†å¶å­èŠ‚ç‚¹å°±å¯ä»¥å®ç°æ•´æ£µæ ‘çš„éå†ã€‚è€Œä¸”åœ¨æ•°æ®åº“ä¸­åŸºäºèŒƒå›´çš„æŸ¥è¯¢æ˜¯éå¸¸é¢‘ç¹çš„, è€ŒBæ ‘ä¸æ”¯æŒè¿™æ ·çš„æ“ä½œ(æˆ–è€…è¯´æ•ˆç‡å¤ªä½)ã€‚</p></blockquote><p><strong>åœ¨æ•°æ®åº“ä¸­åŸºäºèŒƒå›´çš„æŸ¥è¯¢æ˜¯éå¸¸é¢‘ç¹çš„, å› æ­¤MySQLæœ€ç»ˆé€‰æ‹©çš„ç´¢å¼•ç»“æ„æ˜¯B+æ ‘è€Œä¸æ˜¯Bæ ‘ã€‚</strong></p><p>B+æ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹:</p><figure><img src="/assets/202109232157672-5b8cf238.jpeg" alt="B+æ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹" tabindex="0" loading="lazy"><figcaption>B+æ ‘çš„æŸ¥æ‰¾è¿‡ç¨‹</figcaption></figure><p>å¦‚å›¾æ‰€ç¤º, å¦‚æœè¦æŸ¥æ‰¾æ•°æ®é¡¹29, é‚£ä¹ˆé¦–å…ˆä¼šæŠŠç£ç›˜å—1ç”±ç£ç›˜åŠ è½½åˆ°å†…å­˜, æ­¤æ—¶å‘ç”Ÿä¸€æ¬¡IO, åœ¨å†…å­˜ä¸­ç”¨äºŒåˆ†æŸ¥æ‰¾ç¡®å®š29åœ¨17å’Œ35ä¹‹é—´, é”å®šç£ç›˜å—1çš„P2æŒ‡é’ˆ, å†…å­˜æ—¶é—´å› ä¸ºéå¸¸çŸ­(ç›¸æ¯”ç£ç›˜çš„IO)å¯ä»¥å¿½ç•¥ä¸è®¡, é€šè¿‡ç£ç›˜å—1çš„P2æŒ‡é’ˆçš„ç£ç›˜åœ°å€æŠŠç£ç›˜å—3ç”±ç£ç›˜åŠ è½½åˆ°å†…å­˜, å‘ç”Ÿç¬¬äºŒæ¬¡IO, 29åœ¨26å’Œ30ä¹‹é—´, é”å®šç£ç›˜å—3çš„P2æŒ‡é’ˆ, é€šè¿‡æŒ‡é’ˆåŠ è½½ç£ç›˜å—8åˆ°å†…å­˜, å‘ç”Ÿç¬¬ä¸‰æ¬¡IO, åŒæ—¶å†…å­˜ä¸­åšäºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°29, ç»“æŸæŸ¥è¯¢, æ€»è®¡ä¸‰æ¬¡IOã€‚</p><p>çœŸå®çš„æƒ…å†µæ˜¯, 3å±‚çš„b+æ ‘å¯ä»¥è¡¨ç¤ºä¸Šç™¾ä¸‡çš„æ•°æ®, å¦‚æœä¸Šç™¾ä¸‡çš„æ•°æ®æŸ¥æ‰¾åªéœ€è¦ä¸‰æ¬¡IO, æ€§èƒ½æé«˜å°†æ˜¯å·¨å¤§çš„, å¦‚æœæ²¡æœ‰ç´¢å¼•, æ¯ä¸ªæ•°æ®é¡¹éƒ½è¦å‘ç”Ÿä¸€æ¬¡IO, é‚£ä¹ˆæ€»å…±éœ€è¦ç™¾ä¸‡æ¬¡çš„IO, æ˜¾ç„¶æˆæœ¬éå¸¸éå¸¸é«˜ã€‚</p><h2 id="b-æ ‘-1" tabindex="-1"><a class="header-anchor" href="#b-æ ‘-1" aria-hidden="true">#</a> B*æ ‘</h2><p>B*Treeæ˜¯B+æ ‘çš„å˜ä½“, åœ¨B+Treeçš„éæ ¹å’Œéå¶å­ç»“ç‚¹å†å¢åŠ æŒ‡å‘å…„å¼Ÿçš„æŒ‡é’ˆï¼›</p><p>B*æ ‘å®šä¹‰äº†éå¶å­ç»“ç‚¹å…³é”®å­—ä¸ªæ•°è‡³å°‘ä¸º(2/3)*M, å³å—çš„æœ€ä½ä½¿ç”¨ç‡ä¸º2/3(ä»£æ›¿B+æ ‘çš„1/2)ï¼›</p><p>B+æ ‘çš„åˆ†è£‚: å½“ä¸€ä¸ªç»“ç‚¹æ»¡æ—¶, åˆ†é…ä¸€ä¸ªæ–°çš„ç»“ç‚¹, å¹¶å°†åŸç»“ç‚¹ä¸­1/2çš„æ•°æ®å¤åˆ¶åˆ°æ–°ç»“ç‚¹, æœ€ååœ¨çˆ¶ç»“ç‚¹ä¸­å¢åŠ æ–°ç»“ç‚¹çš„æŒ‡é’ˆï¼›B+æ ‘çš„åˆ†è£‚åªå½±å“åŸç»“ç‚¹å’Œçˆ¶ç»“ç‚¹, è€Œä¸ä¼šå½±å“å…„å¼Ÿç»“ç‚¹, æ‰€ä»¥å®ƒä¸éœ€è¦æŒ‡å‘å…„å¼Ÿçš„æŒ‡é’ˆï¼›</p><p>B* æ ‘çš„åˆ†è£‚: å½“ä¸€ä¸ªç»“ç‚¹æ»¡æ—¶, å¦‚æœå®ƒçš„ä¸‹ä¸€ä¸ªå…„å¼Ÿç»“ç‚¹æœªæ»¡, é‚£ä¹ˆå°†ä¸€éƒ¨åˆ†æ•°æ®ç§»åˆ°å…„å¼Ÿç»“ç‚¹ä¸­, å†åœ¨åŸç»“ç‚¹æ’å…¥å…³é”®å­—, æœ€åä¿®æ”¹çˆ¶ç»“ç‚¹ä¸­å…„å¼Ÿç»“ç‚¹çš„å…³é”®å­—(å› ä¸ºå…„å¼Ÿç»“ç‚¹çš„å…³é”®å­—èŒƒå›´æ”¹å˜äº†)ï¼›å¦‚æœå…„å¼Ÿä¹Ÿæ»¡äº†, åˆ™åœ¨åŸç»“ç‚¹ä¸å…„å¼Ÿç»“ç‚¹ä¹‹é—´å¢åŠ æ–°ç»“ç‚¹, å¹¶å„å¤åˆ¶1/3çš„æ•°æ®åˆ°æ–°ç»“ç‚¹, æœ€ååœ¨çˆ¶ç»“ç‚¹å¢åŠ æ–°ç»“ç‚¹çš„æŒ‡é’ˆï¼›</p><p>æ‰€ä»¥, B*æ ‘åˆ†é…æ–°ç»“ç‚¹çš„æ¦‚ç‡æ¯”B+æ ‘è¦ä½, ç©ºé—´ä½¿ç”¨ç‡æ›´é«˜ï¼›</p><h2 id="ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯bæ ‘" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯bæ ‘" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯Bæ ‘?</h2><p>ä¸¤ä¸ªè§’åº¦: èŒƒå›´æŸ¥è¯¢å’Œæ ‘çš„é«˜åº¦(IOæŸ¥è¯¢æ¬¡æ•°)ã€‚</p><ol><li>B+æ ‘åœ¨Bæ ‘åŸºç¡€ä¸Šè¿›è¡Œå˜ç§, éå¶å­èŠ‚ç‚¹ç”¨æ¥åšç´¢å¼•, è€Œå¶å­èŠ‚ç‚¹ä¸­æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸‹ä¸ªå¶å­èŠ‚ç‚¹, éå¸¸ä¾¿äºèŒƒå›´æŸ¥è¯¢ã€‚ <ol><li>å¦‚æœæ˜¯å¤šæ¡çš„è¯, Bæ ‘éœ€è¦åš<strong>å±€éƒ¨çš„ä¸­åºéå†, å¯èƒ½è¦è·¨å±‚è®¿é—®</strong>ã€‚</li><li>è€ŒB+æ ‘ç”±äºæ‰€æœ‰æ•°æ®éƒ½åœ¨å¶å­ç»“ç‚¹, ä¸ç”¨è·¨å±‚, åŒæ—¶ç”±äºæœ‰é“¾è¡¨ç»“æ„, åªéœ€è¦æ‰¾åˆ°é¦–å°¾, é€šè¿‡é“¾è¡¨å°±èƒ½æŠŠæ‰€æœ‰æ•°æ®å–å‡ºæ¥äº†ã€‚</li></ol></li><li>Bæ ‘ä¸ç®¡å¶å­èŠ‚ç‚¹è¿˜æ˜¯éå¶å­èŠ‚ç‚¹, éƒ½ä¼šä¿å­˜æ•°æ®, è¿™æ ·å¯¼è‡´åœ¨éå¶å­èŠ‚ç‚¹ä¸­èƒ½ä¿å­˜çš„æŒ‡é’ˆæ•°é‡å˜å°‘ã€‚æŒ‡é’ˆå°‘çš„æƒ…å†µä¸‹è¦ä¿å­˜å¤§é‡æ•°æ®, åªèƒ½å¢åŠ æ ‘çš„é«˜åº¦, å¯¼è‡´IOæ“ä½œå˜å¤š, æŸ¥è¯¢æ€§èƒ½å˜ä½ã€‚</li></ol><h2 id="ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯hashç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#ä¸ºä»€ä¹ˆmysqlçš„ç´¢å¼•è¦ä½¿ç”¨b-æ ‘è€Œä¸æ˜¯hashç´¢å¼•" aria-hidden="true">#</a> ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘è€Œä¸æ˜¯Hashç´¢å¼•?</h2><p>å¦‚æœåªé€‰ä¸€ä¸ªæ•°æ®, é‚£ç¡®å®æ˜¯hashæ›´å¿«ã€‚ä½†æ˜¯æ•°æ®åº“ä¸­ç»å¸¸ä¼šé€‰æ‹©å¤šæ¡, è¿™æ—¶å€™ç”±äºB+æ ‘ç´¢å¼•æœ‰åº, å¹¶ä¸”åˆæœ‰é“¾è¡¨ç›¸è¿, å®ƒçš„æŸ¥è¯¢æ•ˆç‡æ¯”hashå°±å¿«å¾ˆå¤šäº†ã€‚</p><p>è€Œä¸”æ•°æ®åº“ä¸­çš„ç´¢å¼•ä¸€èˆ¬æ˜¯åœ¨ç£ç›˜ä¸Š, æ•°æ®é‡å¤§çš„æƒ…å†µå¯èƒ½æ— æ³•ä¸€æ¬¡è£…å…¥å†…å­˜, B+æ ‘çš„è®¾è®¡å¯ä»¥å…è®¸æ•°æ®åˆ†æ‰¹åŠ è½½, åŒæ—¶æ ‘çš„é«˜åº¦è¾ƒä½, æé«˜æŸ¥æ‰¾æ•ˆç‡ã€‚</p><h2 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“" aria-hidden="true">#</a> æ€»ç»“</h2><ol><li>Hashç´¢å¼•å¯ä»¥å¿«é€Ÿè¿›è¡Œç­‰å€¼æŸ¥è¯¢, æ—¶é—´å¤æ‚åº¦ä¸ºO(1), ä½†æ˜¯å¹¶ä¸é€‚åˆèŒƒå›´æŸ¥è¯¢å’Œæ’åº, è€Œä¸”å¯èƒ½éœ€è¦Hashç¢°æ’, æç«¯æƒ…å†µä¸‹æ•ˆç‡ä½ã€‚</li><li>äºŒå‰æŸ¥æ‰¾æ ‘å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥è¯¢, æ—¶é—´å¤æ‚åº¦ä¸ºO(log(n))æ•ˆç‡ä¹Ÿå¯ä»¥, ä½†æ˜¯æç«¯æƒ…å†µä¸‹ä¼šé€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨, æœ€åæ—¶é—´å¤æ‚åº¦ä¸ºO(n), è€Œä¸”é€šå¸¸æ˜¯åŸºäºä¸»é”®æ’å…¥æ•°æ®, é€€åŒ–æ¦‚ç‡å¾ˆé«˜, æ€§èƒ½ä½ã€‚</li><li>å¹³è¡¡æ ‘ä¸­, çº¢é»‘æ ‘æç«¯æƒ…å†µä¹Ÿä¼šæœ‰å³å€¾é€€åŒ–çš„é—®é¢˜(ç±»ä¼¼äºé“¾)ï¼›å¹³è¡¡äºŒå‰æ ‘ç»å¯¹å‡è¡¡, æŸ¥è¯¢æ•ˆç‡å¾ˆé«˜, ä½†æ’å…¥æ—¶éœ€è¦é¢‘ç¹è°ƒæ•´, æ€§èƒ½ä½ã€‚æœ€é‡è¦çš„åŸå› æ˜¯: <strong>å¹³è¡¡äºŒå‰æ ‘æ ‘æ¯”è¾ƒé«˜, éœ€è¦å¤šæ¬¡IOæŸ¥è¯¢</strong>ã€‚</li><li>Bæ ‘æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨æ›´å¤šçš„æ•°æ®, è€Œä¸”æ˜¯å¤šè·¯, å¯ä»¥å¤§å¤§é™ä½æ ‘çš„é«˜åº¦, å‡å°‘äº†IOæŸ¥è¯¢ã€‚ä½†æ˜¯èŒƒå›´æŸ¥è¯¢æ—¶æ¯”è¾ƒå¤æ‚, æ•ˆç‡ç•¥ä½ã€‚</li><li>B+æ ‘åœ¨Bæ ‘åŸºç¡€ä¸Šè¿›è¡Œå˜ç§, éå¶å­èŠ‚ç‚¹ç”¨æ¥åšç´¢å¼•, è€Œå¶å­èŠ‚ç‚¹ä¸­æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸‹ä¸ªå¶å­èŠ‚ç‚¹, éå¸¸ä¾¿äºèŒƒå›´æŸ¥è¯¢ã€‚</li><li>B*æ ‘: åœ¨B+æ ‘åŸºç¡€ä¸Š, ä¸ºéå¶å­ç»“ç‚¹ä¹Ÿå¢åŠ é“¾è¡¨æŒ‡é’ˆ, å°†ç»“ç‚¹çš„æœ€ä½åˆ©ç”¨ç‡ä»1/2æé«˜åˆ°2/3ï¼›</li></ol><h2 id="å‚çœ‹" tabindex="-1"><a class="header-anchor" href="#å‚çœ‹" aria-hidden="true">#</a> å‚çœ‹:</h2><ul><li><a href="https://www.cxyxiaowu.com/2440.html" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆ MySQL æ•°æ®åº“è¦ç”¨B+æ ‘å­˜å‚¨ç´¢å¼•ï¼Ÿâ€”â€”å´å¸ˆå…„å­¦ç¼–ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (æ¼«ç”»å½¢å¼ä¸€æ­¥æ­¥è¿›è¡Œåˆ†æ)</li><li><a href="https://www.zhihu.com/zvideo/1415976539947585536" target="_blank" rel="noopener noreferrer">é¢è¯•å®˜:ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ç”¨ B+ æ ‘, è€Œä¸æ˜¯Bæ ‘ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (çŸ¥ä¹å°è§†é¢‘)</li><li><a href="https://www.cxyxiaowu.com/18067.html" target="_blank" rel="noopener noreferrer">é˜¿é‡Œé¢è¯•: åˆ†æä¸ºä»€ä¹ˆB+æ ‘æ›´é€‚åˆä½œä¸ºç´¢å¼•çš„ç»“æ„ä»¥åŠç´¢å¼•åŸç†â€”â€”å´å¸ˆå…„å­¦ç¼–ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/81273236" target="_blank" rel="noopener noreferrer">é¢è¯•å®˜: ä¸ºä»€ä¹ˆMySQLçš„ç´¢å¼•è¦ä½¿ç”¨B+æ ‘, è€Œä¸æ˜¯å…¶å®ƒæ ‘ï¼Ÿæ¯”å¦‚Bæ ‘ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (ä»åº•å±‚å­˜å‚¨è§’åº¦åˆ†æ)</li></ul><h1 id="mysqlçš„å­˜å‚¨å¼•æ“æœ‰å“ªäº›-åŠåœºæ™¯å¯¹æ¯”" tabindex="-1"><a class="header-anchor" href="#mysqlçš„å­˜å‚¨å¼•æ“æœ‰å“ªäº›-åŠåœºæ™¯å¯¹æ¯”" aria-hidden="true">#</a> MySQLçš„å­˜å‚¨å¼•æ“æœ‰å“ªäº›, åŠåœºæ™¯å¯¹æ¯”</h1><h2 id="èƒŒæ™¯-1" tabindex="-1"><a class="header-anchor" href="#èƒŒæ™¯-1" aria-hidden="true">#</a> èƒŒæ™¯</h2><p>mysqlçš„å­˜å‚¨å¼•æ“ä¹Ÿæ˜¯é¢è¯•ä¸­çš„å¸¸å®¢äº†:</p><blockquote><p>é¢è¯•å®˜: ä½ äº†è§£çš„mysqlå­˜å‚¨å¼•æ“éƒ½æœ‰å“ªäº›ï¼Ÿä»–ä»¬æœ‰ä»€ä¹ˆåŒºåˆ«, ä»¥åŠä½¿ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>æˆ‘: â€¦â€¦</p><p>é¢è¯•å®˜: ä½ èƒ½è¯´è¯´mysqlå­˜å‚¨å¼•æ“ä¸­çš„ InnoDB å’Œ MyISAMæœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿ</p><p>æˆ‘: â€¦â€¦</p></blockquote><p>ä¹‹å‰å·²ç»æ€»ç»“è¿‡äº†<strong>InnoDB å’Œ MyISAMçš„åŒºåˆ«å’Œä½¿ç”¨åœºæ™¯</strong>, ä½†æ˜¯é¢è¯•ä¸­ä»…ä»…æŒæ¡è¿™äº›å¥½åƒè¿˜ä¸å¤Ÿ, é¢è¯•å®˜æ›´å€¾å‘äºä½ å¯¹å­˜å‚¨å¼•æ“äº†è§£çš„æ›´å¤šã€‚æ‰€ä»¥è¿™ç¯‡æ–‡ç« å†æ¥æ€»ç»“ä¸€ç•ª<strong>mysqlçš„å­˜å‚¨å¼•æ“</strong>ã€‚</p><h2 id="å­˜å‚¨å¼•æ“ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“ç®€ä»‹" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“ç®€ä»‹</h2><p>å­˜å‚¨å¼•æ“å…¶å®å°±æ˜¯<strong>å¯¹äºæ•°æ®åº“æ–‡ä»¶çš„ä¸€ç§å­˜å–æœºåˆ¶</strong>, å¦‚ä½•å®ç°å­˜å‚¨æ•°æ®, å¦‚ä½•ä¸ºå­˜å‚¨çš„æ•°æ®å»ºç«‹ç´¢å¼•ä»¥åŠå¦‚ä½•æ›´æ–°, æŸ¥è¯¢æ•°æ®ç­‰æŠ€æœ¯å®ç°çš„æ–¹æ³•ã€‚</p><p>MySQLä¸­çš„æ•°æ®ç”¨å„ç§ä¸åŒçš„æŠ€æœ¯å­˜å‚¨åœ¨æ–‡ä»¶(æˆ–å†…å­˜)ä¸­, è¿™äº›æŠ€æœ¯ä¸­çš„æ¯ä¸€ç§æŠ€æœ¯éƒ½ä½¿ç”¨ä¸åŒçš„å­˜å‚¨æœºåˆ¶, ç´¢å¼•æŠ€å·§, é”å®šæ°´å¹³å¹¶ä¸”æœ€ç»ˆæä¾›å¹¿æ³›çš„ä¸åŒåŠŸèƒ½å’Œèƒ½åŠ›ã€‚åœ¨MySQLä¸­å°†è¿™äº›ä¸åŒçš„æŠ€æœ¯åŠé…å¥—çš„ç›¸å…³åŠŸèƒ½ç§°ä¸ºå­˜å‚¨å¼•æ“ã€‚</p><h2 id="mysql-ä¸­æŸ¥çœ‹å­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#mysql-ä¸­æŸ¥çœ‹å­˜å‚¨å¼•æ“" aria-hidden="true">#</a> MySQL ä¸­æŸ¥çœ‹å­˜å‚¨å¼•æ“</h2><p>MySQLæä¾›äº†æŸ¥è¯¢å­˜å‚¨å¼•æ“çš„åŠŸèƒ½, æ‰§è¡Œä»¥ä¸‹sqlå³å¯æŸ¥è¯¢åˆ°mysqlä¸­çš„å­˜å‚¨å¼•æ“</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SHOW</span>
ENGINES<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>mysqlç‰ˆæœ¬æ˜¯8.0.12, ä¸‹é¢æ˜¯åœ¨Navicatä¸­æ‰§è¡Œçš„ç»“æœ:</p><figure><img src="/assets/202109251451522-423e771d.png" alt="mysqlæ”¯æŒçš„å­˜å‚¨å¼•æ“" tabindex="0" loading="lazy"><figcaption>mysqlæ”¯æŒçš„å­˜å‚¨å¼•æ“</figcaption></figure><p>å…¶ä»–å‘½ä»¤:</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code># æŸ¥çœ‹mysql é»˜è®¤çš„å­˜å‚¨å¼•æ“
show variables like &#39;% storage_engine&#39;;

# æŸ¥çœ‹å…·ä½“æŸä¸€ä¸ªè¡¨æ‰€ä½¿ç”¨çš„å­˜å‚¨å¼•æ“
show create table tablename;

#å‡†ç¡®æŸ¥çœ‹æŸä¸ªæ•°æ®åº“ä¸­çš„æŸä¸€è¡¨æ‰€ä½¿ç”¨çš„å­˜å‚¨å¼•æ“
show table status from database where name = &quot;tablename&quot;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä»ä¸Šå›¾ä¸­å¯ä»¥çœ‹å‡º, mysqlæä¾›äº†9ä¸­å­˜å‚¨å¼•æ“, é»˜è®¤ä½¿ç”¨çš„æ˜¯InnoDBã€‚ä½†æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ä¸€èˆ¬ä¹Ÿå°±æ˜¯4ä¸­å­˜å‚¨å¼•æ“, åˆ†åˆ«æ˜¯: InnoDBã€MyISAMã€MEMORYå’ŒARCHIVE, æ‰€ä»¥æˆ‘ä»¬é‡ç‚¹åˆ†æè¿™4ä¸­å­˜å‚¨å¼•æ“ã€‚</p><h1 id="mysql-å„ç§å­˜å‚¨å¼•æ“åˆ†æ" tabindex="-1"><a class="header-anchor" href="#mysql-å„ç§å­˜å‚¨å¼•æ“åˆ†æ" aria-hidden="true">#</a> MySQL å„ç§å­˜å‚¨å¼•æ“åˆ†æ</h1><h2 id="innodbå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#innodbå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> InnoDBå­˜å‚¨å¼•æ“</h2><p>InnoDBæ˜¯ç›®å‰MYSQLçš„é»˜è®¤å­˜å‚¨å¼•æ“, æ˜¯äº‹åŠ¡å‹æ•°æ®åº“çš„é¦–é€‰å¼•æ“, æ˜¯ç›®å‰æœ€é‡è¦ã€ä½¿ç”¨æœ€å¹¿æ³›çš„å­˜å‚¨å¼•æ“ã€‚ä¸»è¦ç‰¹æ€§æœ‰:</p><ol><li>æä¾›äº†äº‹åŠ¡, å›æ»šä»¥åŠç³»ç»Ÿå´©æºƒä¿®å¤èƒ½åŠ›å’Œå¤šç‰ˆæœ¬è¿¸å‘æ§åˆ¶çš„äº‹åŠ¡çš„å®‰å…¨ã€‚</li><li>æ”¯æŒè‡ªå¢é•¿åˆ—(auto_increment)ã€‚</li><li>æ”¯æŒå¤–é”®(foreign key)ã€‚</li><li>æ”¯æŒMVCCçš„è¡Œçº§é”ã€‚</li><li>ç´¢å¼•ä½¿ç”¨çš„æ˜¯B+Treeã€‚</li></ol><p><strong>ä¼˜ç‚¹</strong>: æä¾›äº†è‰¯å¥½çš„äº‹åŠ¡å¤„ç†ã€å´©æºƒä¿®å¤èƒ½åŠ›å’Œå¹¶å‘æ§åˆ¶ã€‚</p><p><strong>ç¼ºç‚¹</strong>: è¯»å†™æ•ˆç‡è¾ƒå·®, å ç”¨çš„æ•°æ®ç©ºé—´ç›¸å¯¹è¾ƒå¤§ã€‚</p><p><strong>åœºæ™¯</strong>: æ—¢æœ‰è¯»å†™ä¹ŸæŒºé¢‘ç¹, è¯·ä½¿ç”¨InnoDBã€‚ä¸çŸ¥é“å¦‚ä½•é€‰æ‹©æ—¶, ä¹Ÿå¯ä»¥é€‰æ‹©InnoDB, ç”¨ä»¥åº”å¯¹æœªæ¥å¯èƒ½å­˜åœ¨çš„å¤æ‚ä¸šåŠ¡ã€‚</p><h2 id="myisamå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#myisamå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> MyISAMå­˜å‚¨å¼•æ“</h2><p>MyISAM è¿™ç§å­˜å‚¨å¼•æ“ä¸æ”¯æŒäº‹åŠ¡, ä¸æ”¯æŒè¡Œçº§é”, åªæ”¯æŒå¹¶å‘æ’å…¥çš„è¡¨é”, ä¸»è¦ç”¨äºé«˜è´Ÿè½½çš„<code>select</code>ã€‚</p><p><strong>ä¼˜ç‚¹</strong>: å ç”¨ç©ºé—´å°, å¤„ç†é€Ÿåº¦å¿«ã€‚</p><p><strong>ç¼ºç‚¹</strong>: æ˜¯ä¸æ”¯æŒäº‹åŠ¡çš„å®Œæ•´æ€§å’Œå¹¶å‘æ€§ã€‚</p><p><strong>åœºæ™¯</strong>: è¡¨ä¸­ç»å¤§å¤šæ•°éƒ½åªæ˜¯è¯»æŸ¥è¯¢(ä¸€èˆ¬R/W &gt; 100:1ä¸”updateç›¸å¯¹è¾ƒå°‘), å¯ä»¥è€ƒè™‘ MyISAM</p><h2 id="memoryå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#memoryå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> MEMORYå­˜å‚¨å¼•æ“</h2><p>MEMORYå­˜å‚¨å¼•æ“å°†è¡¨ä¸­çš„<strong>æ•°æ®å­˜å‚¨åˆ°å†…å­˜ä¸­</strong>ã€‚</p><p>æ¯ä¸ªåŸºäºMEMORYå­˜å‚¨å¼•æ“çš„è¡¨å®é™…å¯¹åº”ä¸€ä¸ªç£ç›˜æ–‡ä»¶, è¯¥æ–‡ä»¶çš„æ–‡ä»¶åå’Œè¡¨åæ˜¯ç›¸åŒçš„, ç±»å‹ä¸º.frmã€‚è¯¥æ–‡ä»¶åªå­˜å‚¨è¡¨çš„ç»“æ„, è€Œå…¶æ•°æ®æ–‡ä»¶, éƒ½æ˜¯å­˜å‚¨åœ¨å†…å­˜ä¸­, è¿™æ ·æœ‰åˆ©äºå¯¹æ•°æ®çš„å¿«é€Ÿå¤„ç†, æé«˜æ•´ä¸ªè¡¨çš„å¤„ç†èƒ½åŠ›ã€‚</p><p>MEMORYå­˜å‚¨å¼•æ“é»˜è®¤ä½¿ç”¨å“ˆå¸Œ(HASH)ç´¢å¼•, å…¶é€Ÿåº¦æ¯”B+Treeè¦å¿«, å¦‚æœå¸Œæœ›ä½¿ç”¨Bæ ‘å‹, å¯åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ä½¿ç”¨ã€‚</p><p><strong>ä¼˜ç‚¹</strong>: æ•°æ®å¿«é€Ÿè®¿é—®å’Œå¤„ç†ã€‚</p><p><strong>ç¼ºç‚¹</strong>: ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸, é‡å¯æˆ–å…³é—­æœºå™¨, æ•°æ®éƒ½ä¼šä¸¢å¤±ã€‚</p><p><strong>åœºæ™¯</strong>: é€‚åˆç”¨äº<strong>æŸ¥è¯¢çš„ä¸´æ—¶è¡¨</strong>ã€‚</p><h2 id="archiveå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#archiveå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> ARCHIVEå­˜å‚¨å¼•æ“</h2><p>Archiveæ˜¯å½’æ¡£çš„æ„æ€, åœ¨å½’æ¡£ä¹‹åå¾ˆå¤šçš„é«˜çº§åŠŸèƒ½å°±ä¸å†æ”¯æŒäº†, ä»…ä»…æ”¯æŒæœ€åŸºæœ¬çš„æ’å…¥å’ŒæŸ¥è¯¢ä¸¤ç§åŠŸèƒ½ã€‚</p><p>åœ¨MySQL 5.5ç‰ˆä»¥å‰, Archiveæ˜¯ä¸æ”¯æŒç´¢å¼•, ä½†æ˜¯åœ¨MySQL 5.5ä»¥åçš„ç‰ˆæœ¬ä¸­å°±å¼€å§‹æ”¯æŒç´¢å¼•äº†ã€‚</p><p>Archiveæ‹¥æœ‰å¾ˆå¥½çš„å‹ç¼©æœºåˆ¶, å®ƒä½¿ç”¨zlibå‹ç¼©åº“, æ‹¥æœ‰é«˜æ•ˆçš„æ’å…¥é€Ÿåº¦ã€‚</p><p><strong>ä¼˜ç‚¹</strong>: é«˜å‹ç¼©, å¿«é€Ÿæ’å…¥ã€‚</p><p><strong>ç¼ºç‚¹</strong>: ä¸é€‚åˆé¢‘ç¹æŸ¥è¯¢ã€‚</p><p><strong>åœºæ™¯</strong>: <strong>éå¸¸é€‚åˆå­˜å‚¨å¤§é‡ç‹¬ç«‹çš„ã€ä½œä¸ºå†å²è®°å½•çš„æ•°æ®</strong>ã€‚ä¾‹å¦‚: éå¸¸é€‚åˆä½œä¸ºæ—¥å¿—è¡¨çš„å­˜å‚¨å¼•æ“, ä½†æ˜¯å‰ææ˜¯ä¸ç»å¸¸å¯¹è¯¥è¡¨è¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚</p><h2 id="å››ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“å¦‚ä½•é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#å››ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“å¦‚ä½•é€‰æ‹©" aria-hidden="true">#</a> å››ç§å¸¸ç”¨çš„å­˜å‚¨å¼•æ“å¦‚ä½•é€‰æ‹©</h2><table><thead><tr><th>åŠŸ èƒ½</th><th>InnoDB</th><th>MYISAM</th><th>Memory</th><th>Archive</th></tr></thead><tbody><tr><td>å­˜å‚¨é™åˆ¶</td><td>64TB</td><td>256TB</td><td>RAM</td><td>None</td></tr><tr><td>æ”¯æŒäº‹åŠ¡</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr><tr><td>æ”¯æŒå…¨æ–‡ç´¢å¼•</td><td>No</td><td>Yes</td><td>No</td><td>No</td></tr><tr><td>æ”¯æŒæ•°ç´¢å¼•</td><td>Yes</td><td>Yes</td><td>Yes</td><td>No</td></tr><tr><td>æ”¯æŒå“ˆå¸Œç´¢å¼•</td><td>No</td><td>No</td><td>Yes</td><td>No</td></tr><tr><td>æ”¯æŒæ•°æ®ç¼“å­˜</td><td>Yes</td><td>No</td><td>N/A</td><td>No</td></tr><tr><td>æ”¯æŒå¤–é”®</td><td>Yes</td><td>No</td><td>No</td><td>No</td></tr></tbody></table><h2 id="å…¶ä»–ä¸å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åˆ†æ-äº†è§£å³å¯" tabindex="-1"><a class="header-anchor" href="#å…¶ä»–ä¸å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åˆ†æ-äº†è§£å³å¯" aria-hidden="true">#</a> å…¶ä»–ä¸å¸¸ç”¨çš„å­˜å‚¨å¼•æ“åˆ†æ(äº†è§£å³å¯)</h2><h3 id="csvå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#csvå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> CSVå­˜å‚¨å¼•æ“</h3><p>ä½¿ç”¨è¯¥å¼•æ“çš„MySQLæ•°æ®åº“è¡¨ä¼šåœ¨MySQLå®‰è£…ç›®å½•dataæ–‡ä»¶å¤¹ä¸­çš„å’Œè¯¥è¡¨æ‰€åœ¨æ•°æ®åº“åç›¸åŒçš„ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ª.CSVæ–‡ä»¶(æ‰€ä»¥, å®ƒå¯ä»¥<strong>å°†CSVç±»å‹çš„æ–‡ä»¶å½“åšè¡¨è¿›è¡Œå¤„ç†</strong>), è¿™ç§æ–‡ä»¶æ˜¯ä¸€ç§æ™®é€šæ–‡æœ¬æ–‡ä»¶, æ¯ä¸ªæ•°æ®è¡Œå ç”¨ä¸€ä¸ªæ–‡æœ¬è¡Œã€‚</p><p>è¯¥ç§ç±»å‹çš„å­˜å‚¨å¼•æ“ä¸æ”¯æŒç´¢å¼•, å³ä½¿ç”¨è¯¥ç§ç±»å‹çš„è¡¨æ²¡æœ‰ä¸»é”®åˆ—ï¼›å¦å¤–ä¹Ÿ<strong>ä¸å…è®¸è¡¨ä¸­çš„å­—æ®µä¸ºnull</strong>ã€‚csvçš„ç¼–ç è½¬æ¢éœ€è¦æ ¼å¤–æ³¨æ„ã€‚</p><p><strong>åœºæ™¯</strong>: æ”¯æŒä»æ•°æ®åº“ä¸­æ‹·å…¥/æ‹·å‡ºCSVæ–‡ä»¶ã€‚å¦‚æœä»ç”µå­è¡¨æ ¼è½¯ä»¶è¾“å‡ºä¸€ä¸ªCSVæ–‡ä»¶, å°†å…¶å­˜æ”¾åœ¨MySQLæœåŠ¡å™¨çš„æ•°æ®ç›®å½•ä¸­, æœåŠ¡å™¨å°±èƒ½å¤Ÿé©¬ä¸Šè¯»å–ç›¸å…³çš„CSVæ–‡ä»¶ã€‚åŒæ ·, å¦‚æœå†™æ•°æ®åº“åˆ°ä¸€ä¸ªCSVè¡¨, å¤–éƒ¨ç¨‹åºä¹Ÿå¯ä»¥ç«‹åˆ»è¯»å–å®ƒã€‚** åœ¨å®ç°æŸç§ç±»å‹çš„æ—¥å¿—è®°å½•æ—¶, CSVè¡¨ä½œä¸ºä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼, ç‰¹åˆ«æœ‰ç”¨**ã€‚</p><h3 id="blackholeå­˜å‚¨å¼•æ“-é»‘æ´å¼•æ“" tabindex="-1"><a class="header-anchor" href="#blackholeå­˜å‚¨å¼•æ“-é»‘æ´å¼•æ“" aria-hidden="true">#</a> BLACKHOLE<strong>å­˜å‚¨å¼•æ“</strong>(é»‘æ´å¼•æ“)</h3><p>æ”¯æŒäº‹åŠ¡, è€Œä¸”æ”¯æŒMVCCçš„è¡Œçº§é”, <strong>å†™å…¥è¿™ç§å¼•æ“è¡¨ä¸­çš„ä»»ä½•æ•°æ®éƒ½ä¼šæ¶ˆå¤±</strong>, ä¸»è¦ç”¨äºåšæ—¥å¿—è®°å½•æˆ–åŒæ­¥å½’æ¡£çš„ä¸­ç»§å­˜å‚¨ã€‚</p><p>è¿™ä¸ªå­˜å‚¨å¼•æ“é™¤éæœ‰ç‰¹åˆ«ç›®çš„, å¦åˆ™ä¸é€‚åˆä½¿ç”¨ã€‚</p><p>åƒUnixç³»ç»Ÿä¸‹é¢çš„&quot;<code>/dev/null</code>&quot;è®¾å¤‡ä¸€æ ·, ä¸ç®¡æˆ‘ä»¬å†™å…¥ä»»ä½•ä¿¡æ¯, éƒ½æ˜¯æœ‰å»æ— å›, <strong>é‚£ä¹ˆBLACKHOLEå­˜å‚¨å¼•æ“æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</strong></p><blockquote><p>åœ¨æ•°æ®è¿ç§»è¿‡ç¨‹ä¸­, æ•°æ®é¡»è¦ç»è¿‡ä¸€ä¸ªä¸­è½¬çš„MySQLæœåŠ¡å™¨åšä¸€äº›ç›¸å…³çš„è½¬æ¢æ“ä½œ, ç„¶åå†é€šè¿‡å¤åˆ¶ç§»æ¤åˆ°æ–°çš„æœåŠ¡å™¨ä¸Šé¢ã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥æ”¯æŒè¿™ä¸ªä¸­è½¬æœåŠ¡å™¨çš„åŠ¨ä½œ, è¿™æ—¶å€™å°±æ˜¾ç¤ºå‡ºBLACKHOLEçš„åŠŸæ•ˆäº†, ä»–ä¸ä¼šè®°å½•ä¸‹ä»»ä½•æ•°æ®, ä½†æ˜¯ä¼š<strong>åœ¨binlogä¸­è®°å½•ä¸‹æ‰€æœ‰çš„Queryã€‚è€Œè¿™äº›Queryæœ€ç»ˆéƒ½ä¼šè¢«å¤åˆ¶åˆ©ç”¨, å¹¶å®æ–½åˆ°æœ€ç»ˆçš„slaveç«¯</strong>ã€‚</p></blockquote><p>æ‰€ä»¥, å¦‚æœé…ç½®ä¸€ä¸»å¤šä»çš„è¯, å¤šä¸ªä»æœåŠ¡å™¨ä¼šåœ¨ä¸»æœåŠ¡å™¨ä¸Šåˆ†åˆ«å¼€å¯è‡ªå·±ç›¸å¯¹åº”çš„çº¿ç¨‹, æ‰§è¡Œbinlogdumpå‘½ä»¤è€Œä¸”å¤šä¸ªæ­¤ç±»è¿›ç¨‹å¹¶ä¸æ˜¯å…±äº«çš„ã€‚ä¸ºäº†é¿å…å› å¤šä¸ªä»æœåŠ¡å™¨åŒæ—¶è¯·æ±‚åŒæ ·çš„äº‹ä»¶è€Œå¯¼è‡´ä¸»æœºèµ„æºè€—å°½, å¯ä»¥å•ç‹¬å»ºç«‹ä¸€ä¸ªä¼ªçš„ä»æœåŠ¡å™¨æˆ–è€…å«åˆ†å‘æœåŠ¡å™¨ã€‚</p><p>MySQLçš„ç”¨æˆ·æ‰‹å†Œä¸Šé¢ä»‹ç»äº†BLACKHOLEå­˜å‚¨å¼•æ“å…¶ä»–å‡ é¡¹ç”¨é€”:</p><ul><li>Queryè¯­æ³•çš„éªŒè¯;</li><li>æµ‹è¯•äºŒè¿›åˆ¶æ—¥å¿—è®°å½•çš„æ€§èƒ½å¼€é”€, å¦‚é€šè¿‡æ¯”è¾ƒå…è®¸äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½çš„BLACKHOLEä¸ç¦æ­¢äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½çš„BLACKHOLEçš„æ€§èƒ½æ¥å®ç°</li><li>æŸ¥æ‰¾ä¸å­˜å‚¨å¼•æ“è‡ªèº«ä¸ç›¸å…³çš„æ€§èƒ½ç“¶é¢ˆ, å› ä¸ºBLACKHOLEæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª&quot;no-op&quot;çš„å­˜å‚¨å¼•æ“</li></ul><h3 id="performance-schemaå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#performance-schemaå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> PERFORMANCE_SCHEMAå­˜å‚¨å¼•æ“</h3><p>è¯¥å¼•æ“ä¸»è¦ç”¨äº<strong>æ”¶é›†æ•°æ®åº“æœåŠ¡å™¨æ€§èƒ½å‚æ•°</strong>ã€‚</p><p>è¿™ç§å¼•æ“æä¾›ä»¥ä¸‹åŠŸèƒ½: æä¾›è¿›ç¨‹ç­‰å¾…çš„è¯¦ç»†ä¿¡æ¯, åŒ…æ‹¬é”ã€äº’æ–¥å˜é‡ã€æ–‡ä»¶ä¿¡æ¯ï¼›ä¿å­˜å†å²çš„äº‹ä»¶æ±‡æ€»ä¿¡æ¯, ä¸ºæä¾›MySQLæœåŠ¡å™¨æ€§èƒ½åšå‡ºè¯¦ç»†çš„åˆ¤æ–­ï¼›å¯¹äºæ–°å¢å’Œåˆ é™¤ç›‘æ§äº‹ä»¶ç‚¹éƒ½éå¸¸å®¹æ˜“, å¹¶å¯ä»¥éšæ„æ”¹å˜mysqlæœåŠ¡å™¨çš„ç›‘æ§å‘¨æœŸ, ä¾‹å¦‚(CYCLEã€MICROSECOND)ã€‚</p><p>MySQLç”¨æˆ·æ˜¯ä¸èƒ½åˆ›å»ºå­˜å‚¨å¼•æ“ä¸ºPERFORMANCE_SCHEMAçš„è¡¨ã€‚</p><p><strong>åœºæ™¯</strong>: åˆ†ææ€§èƒ½é™ä½å¯èƒ½æ˜¯ç”±äºå“ªäº›ç“¶é¢ˆã€‚</p><h3 id="federatedå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#federatedå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> Federatedå­˜å‚¨å¼•æ“</h3><p>è¯¥å­˜å‚¨å¼•æ“å¯ä»¥ä¸åŒçš„MysqlæœåŠ¡å™¨è”åˆèµ·æ¥, é€»è¾‘ä¸Šç»„æˆä¸€ä¸ªå®Œæ•´çš„æ•°æ®åº“ã€‚è¿™ç§å­˜å‚¨å¼•æ“éå¸¸é€‚åˆæ•°æ®åº“åˆ†å¸ƒå¼åº”ç”¨ã€‚</p><p>Federatedå­˜å‚¨å¼•æ“å¯ä»¥ä½¿ä½ åœ¨æœ¬åœ°æ•°æ®åº“ä¸­è®¿é—®è¿œç¨‹æ•°æ®åº“ä¸­çš„æ•°æ®, é’ˆå¯¹federatedå­˜å‚¨å¼•æ“è¡¨çš„æŸ¥è¯¢ä¼šè¢«å‘é€åˆ°è¿œç¨‹æ•°æ®åº“çš„è¡¨ä¸Šæ‰§è¡Œ, æœ¬åœ°æ˜¯ä¸å­˜å‚¨ä»»ä½•æ•°æ®çš„ã€‚ç¼ºç‚¹:</p><ol><li><p>å¯¹æœ¬åœ°è™šæ‹Ÿè¡¨çš„ç»“æ„ä¿®æ”¹, å¹¶ä¸ä¼šä¿®æ”¹è¿œç¨‹è¡¨çš„ç»“æ„</p></li><li><p>truncate å‘½ä»¤, ä¼šæ¸…é™¤è¿œç¨‹è¡¨æ•°æ®</p></li><li><p>dropå‘½ä»¤åªä¼šåˆ é™¤è™šæ‹Ÿè¡¨, å¹¶ä¸ä¼šåˆ é™¤è¿œç¨‹è¡¨</p></li><li><p>ä¸æ”¯æŒ alter table å‘½ä»¤</p></li><li><p><code>select count(*)</code>, <code>select * from limit M, N</code> ç­‰è¯­å¥æ‰§è¡Œæ•ˆç‡éå¸¸ä½, æ•°æ®é‡è¾ƒå¤§æ—¶å­˜åœ¨å¾ˆä¸¥é‡çš„é—®é¢˜, ä½†æ˜¯æŒ‰ä¸»é”®æˆ–ç´¢å¼•åˆ—æŸ¥è¯¢, åˆ™å¾ˆå¿«</p></li><li><p>å¦‚æœè™šæ‹Ÿè™šæ‹Ÿè¡¨ä¸­å­—æ®µæœªå»ºç«‹ç´¢å¼•, è€Œå®ä½“è¡¨ä¸­ä¸ºæ­¤å­—æ®µå»ºç«‹äº†ç´¢å¼•, æ­¤ç§æƒ…å†µä¸‹, æ€§èƒ½ä¹Ÿç›¸å½“å·®ã€‚ä½†æ˜¯å½“ç»™è™šæ‹Ÿè¡¨å»ºç«‹ç´¢å¼•å, æ€§èƒ½æ¢å¤æ­£å¸¸ã€‚</p></li><li><p>ç±»ä¼¼ <code>where name like &quot;str%&quot; limit 1</code> çš„æŸ¥è¯¢, å³ä½¿åœ¨ name åˆ—ä¸Šåˆ›å»ºäº†ç´¢å¼•, ä¹Ÿä¼šå¯¼è‡´æŸ¥è¯¢è¿‡æ…¢, æ˜¯å› ä¸ºfederatedå¼•æ“ä¼šå°†æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„è®°å½•è¯»å–åˆ°æœ¬åœ°, å†è¿›è¡Œ limit å¤„ç†ã€‚</p></li></ol><h3 id="mergeå­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#mergeå­˜å‚¨å¼•æ“" aria-hidden="true">#</a> MERGEå­˜å‚¨å¼•æ“</h3><p>MERGEå­˜å‚¨å¼•æ“æ˜¯ä¸€ç»„MyISAMè¡¨çš„ç»„åˆ, è¿™äº›MyISAMè¡¨ç»“æ„å¿…é¡»å®Œå…¨ç›¸åŒ, å°½ç®¡å…¶ä½¿ç”¨ä¸å¦‚å…¶å®ƒå¼•æ“çªå‡º, ä½†æ˜¯åœ¨æŸäº›æƒ…å†µä¸‹éå¸¸æœ‰ç”¨ã€‚</p><p>åœºæ™¯: å¯¹äºæœåŠ¡å™¨æ—¥å¿—è¿™ç§ä¿¡æ¯, ä¸€èˆ¬å¸¸ç”¨çš„å­˜å‚¨ç­–ç•¥æ˜¯å°†æ•°æ®åˆ†æˆå¾ˆå¤šè¡¨, æ¯ä¸ªåç§°ä¸ç‰¹å®šçš„æ—¶é—´ç«¯ç›¸å…³ã€‚ä¾‹å¦‚: å¯ä»¥ç”¨12ä¸ªç›¸åŒçš„è¡¨æ¥å­˜å‚¨æœåŠ¡å™¨æ—¥å¿—æ•°æ®, æ¯ä¸ªè¡¨ç”¨å¯¹åº”å„ä¸ªæœˆä»½çš„åå­—æ¥å‘½åã€‚å½“æœ‰å¿…è¦åŸºäºæ‰€æœ‰12ä¸ªæ—¥å¿—è¡¨çš„æ•°æ®æ¥ç”ŸæˆæŠ¥è¡¨, è¿™æ„å‘³ç€éœ€è¦ç¼–å†™å¹¶æ›´æ–°å¤šè¡¨æŸ¥è¯¢, ä»¥åæ˜ è¿™äº›è¡¨ä¸­çš„ä¿¡æ¯ã€‚ä¸å…¶ç¼–å†™è¿™äº›å¯èƒ½å‡ºç°é”™è¯¯çš„æŸ¥è¯¢, ä¸å¦‚å°†è¿™äº›è¡¨åˆå¹¶èµ·æ¥ä½¿ç”¨ä¸€æ¡æŸ¥è¯¢, ä¹‹åå†åˆ é™¤Mergeè¡¨, è€Œä¸å½±å“åŸæ¥çš„æ•°æ®, åˆ é™¤Mergeè¡¨åªæ˜¯åˆ é™¤Mergeè¡¨çš„å®šä¹‰, å¯¹å†…éƒ¨çš„è¡¨æ²¡æœ‰ä»»ä½•å½±å“ã€‚</p><h2 id="é¢è¯•é¢˜-mysql-ä¸­-myisam-å’Œ-innodb-çš„åŒºåˆ«æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é¢˜-mysql-ä¸­-myisam-å’Œ-innodb-çš„åŒºåˆ«æœ‰å“ªäº›" aria-hidden="true">#</a> é¢è¯•é¢˜: Mysql ä¸­ MyISAM å’Œ InnoDB çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h2><blockquote><ul><li><strong>InnoDB æ”¯æŒäº‹åŠ¡, MyISAM ä¸æ”¯æŒäº‹åŠ¡</strong>ã€‚ <ul><li>è¿™æ˜¯ MySQL å°†é»˜è®¤å­˜å‚¨å¼•æ“ä» MyISAM å˜æˆ InnoDB çš„é‡è¦åŸå› ä¹‹ä¸€ã€‚</li><li>å¯¹äº InnoDB æ¯ä¸€æ¡ SQL è¯­å¥éƒ½é»˜è®¤å°è£…æˆäº‹åŠ¡è¿›è¡Œæäº¤, è¿™æ ·å°±ä¼šå½±å“é€Ÿåº¦, ä¼˜åŒ–é€Ÿåº¦çš„æ–¹å¼æ˜¯å°†å¤šæ¡ SQL è¯­å¥æ”¾åœ¨ begin å’Œ commit ä¹‹é—´, ç»„æˆä¸€ä¸ªäº‹åŠ¡ã€‚</li></ul></li><li><strong>InnoDB æ”¯æŒå¤–é”®, è€Œ MyISAM ä¸æ”¯æŒ</strong>ã€‚ <ul><li>å¯¹ä¸€ä¸ªåŒ…å«å¤–é”®çš„ InnoDB è¡¨è½¬ä¸º MYISAM ä¼šå¤±è´¥ã€‚</li></ul></li><li><strong>InnoDB ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•, éä¸»é”®ç´¢å¼•æ˜¯éèšé›†ç´¢å¼•ï¼›MyISAM éƒ½æ˜¯æ˜¯éèšé›†ç´¢å¼•</strong>ã€‚ <ul><li>èšç°‡ç´¢å¼•çš„æ–‡ä»¶å­˜æ”¾åœ¨ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Š, å› æ­¤ InnoDB å¿…é¡»è¦æœ‰ä¸»é”®, é€šè¿‡ä¸»é”®ç´¢å¼•æ•ˆç‡å¾ˆé«˜ã€‚ä½†æ˜¯è¾…åŠ©ç´¢å¼•éœ€è¦ä¸¤æ¬¡æŸ¥è¯¢, å…ˆæŸ¥è¯¢åˆ°ä¸»é”®, ç„¶åå†é€šè¿‡ä¸»é”®æŸ¥è¯¢åˆ°æ•°æ®ã€‚å› æ­¤, ä¸»é”®ä¸åº”è¯¥è¿‡å¤§, å› ä¸ºä¸»é”®å¤ªå¤§, å…¶ä»–ç´¢å¼•ä¹Ÿéƒ½ä¼šå¾ˆå¤§ã€‚</li><li>MyISAM æ˜¯éèšé›†ç´¢å¼•, æ•°æ®æ–‡ä»¶æ˜¯åˆ†ç¦»çš„, ç´¢å¼•ä¿å­˜çš„æ˜¯æ•°æ®æ–‡ä»¶çš„æŒ‡é’ˆã€‚ä¸»é”®ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•æ˜¯ç‹¬ç«‹çš„ã€‚</li></ul></li><li><strong>InnoDB ä¸ä¿å­˜è¡¨çš„å…·ä½“è¡Œæ•°</strong>, æ‰§è¡Œ <code>select count(*) from table</code> æ—¶éœ€è¦å…¨è¡¨æ‰«æã€‚è€Œ<strong>MyISAM ç”¨ä¸€ä¸ªå˜é‡ä¿å­˜äº†æ•´ä¸ªè¡¨çš„è¡Œæ•°</strong>, æ‰§è¡Œä¸Šè¿°è¯­å¥æ—¶åªéœ€è¦è¯»å‡ºè¯¥å˜é‡å³å¯, é€Ÿåº¦å¾ˆå¿«ã€‚</li><li><strong>InnoDB æœ€å°çš„é”ç²’åº¦æ˜¯è¡Œé”, MyISAM æœ€å°çš„é”ç²’åº¦æ˜¯è¡¨é”</strong>ã€‚ <ul><li>MyISAM ä¸€ä¸ªæ›´æ–°è¯­å¥ä¼šé”ä½æ•´å¼ è¡¨, å¯¼è‡´å…¶ä»–æŸ¥è¯¢å’Œæ›´æ–°éƒ½ä¼šè¢«é˜»å¡, å› æ­¤å¹¶å‘è®¿é—®å—é™ã€‚è¿™ä¹Ÿæ˜¯ MySQL å°†é»˜è®¤å­˜å‚¨å¼•æ“ä» MyISAM å˜æˆ InnoDB çš„é‡è¦åŸå› ä¹‹ä¸€ï¼›</li></ul></li><li><strong>å­˜å‚¨ç»“æ„ä¸åŒ</strong>ã€‚ <ul><li>MyISAMåœ¨ç£ç›˜ä¸Šå­˜å‚¨æˆä¸‰ä¸ªæ–‡ä»¶, æ•°æ®å’Œç´¢å¼•åˆ†ç¦»ã€‚</li><li>InnoDBåœ¨ç£ç›˜ä¸Šå­˜å‚¨æˆä¸¤ä¸ªæ–‡ä»¶, æ•°æ®å’Œç´¢å¼•å­˜å‚¨åœ¨ä¸€ä¸ªæ–‡ä»¶ã€‚</li></ul></li><li><strong>è¡¨çš„ä¸»é”®ç­–ç•¥ä¸åŒ</strong>ã€‚ <ul><li>MyISAM: å…è®¸æ²¡æœ‰ä»»ä½•ç´¢å¼•å’Œä¸»é”®çš„è¡¨å­˜åœ¨, ç´¢å¼•éƒ½æ˜¯ä¿å­˜è¡Œçš„åœ°å€ã€‚</li><li>InnoDB: å¦‚æœæ²¡æœ‰è®¾å®šä¸»é”®æˆ–è€…éç©ºå”¯ä¸€ç´¢å¼•, <strong>å°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª6å­—èŠ‚çš„ä¸»é”®(ç”¨æˆ·ä¸å¯è§)</strong>, æ•°æ®æ˜¯ä¸»ç´¢å¼•çš„ä¸€éƒ¨åˆ†, é™„åŠ ç´¢å¼•ä¿å­˜çš„æ˜¯ä¸»ç´¢å¼•çš„å€¼ã€‚</li></ul></li></ul></blockquote><h2 id="é¢è¯•é¢˜-mysqlå„ç§å­˜å‚¨å¼•æ“çš„ä½¿ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#é¢è¯•é¢˜-mysqlå„ç§å­˜å‚¨å¼•æ“çš„ä½¿ç”¨åœºæ™¯" aria-hidden="true">#</a> é¢è¯•é¢˜: MySQLå„ç§å­˜å‚¨å¼•æ“çš„ä½¿ç”¨åœºæ™¯ï¼Ÿ</h2><blockquote><p>mysqlé»˜è®¤æä¾›9ä¸­å­˜å‚¨å¼•æ“:</p><p><strong>InnoDB</strong></p><p>æ”¯æŒäº‹åŠ¡å¤„ç†, æ”¯æŒå¤–é”®, æ”¯æŒå´©æºƒä¿®å¤èƒ½åŠ›å’Œå¹¶å‘æ§åˆ¶ã€‚</p><ul><li>å¦‚æœéœ€è¦å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§è¦æ±‚æ¯”è¾ƒé«˜(æ¯”å¦‚é“¶è¡Œ), è¦æ±‚å®ç°å¹¶å‘æ§åˆ¶(æ¯”å¦‚å”®ç¥¨), é‚£é€‰æ‹©InnoDBæœ‰å¾ˆå¤§çš„ä¼˜åŠ¿ã€‚</li><li>å¦‚æœéœ€è¦é¢‘ç¹çš„æ›´æ–°ã€åˆ é™¤æ“ä½œçš„æ•°æ®åº“, ä¹Ÿå¯ä»¥é€‰æ‹©InnoDB, å› ä¸ºæ”¯æŒäº‹åŠ¡çš„æäº¤(commit)å’Œå›æ»š(rollback)ã€‚</li></ul><p><strong>MyISAM</strong></p><p>æ’å…¥æ•°æ®å¿«, ç©ºé—´å’Œå†…å­˜ä½¿ç”¨æ¯”è¾ƒä½ã€‚å¦‚æœæ•°æ®è¡¨ä¸»è¦ç”¨æ¥æ’å…¥å’ŒæŸ¥è¯¢è®°å½•, åˆ™MyISAMå¼•æ“èƒ½æä¾›è¾ƒé«˜çš„å¤„ç†æ•ˆç‡ã€‚</p><ul><li>è¡¨ä¸­ç»å¤§å¤šæ•°éƒ½åªæ˜¯è¯»æŸ¥è¯¢(ä¸€èˆ¬R/W &gt; 100:1ä¸”updateç›¸å¯¹è¾ƒå°‘), å¯ä»¥è€ƒè™‘ MyISAMã€‚</li><li>å¦‚æœå¯¹åº”ç”¨çš„å®Œæ•´æ€§ã€å¹¶å‘æ€§è¦æ±‚æ¯”è¾ƒä½, ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚</li></ul><p><strong>MEMORY</strong></p><p>æ‰€æœ‰çš„æ•°æ®éƒ½åœ¨å†…å­˜ä¸­, æ•°æ®çš„å¤„ç†é€Ÿåº¦å¿«, ä½†æ˜¯å®‰å…¨æ€§ä¸é«˜ï¼›å®ƒå¯¹è¡¨çš„å¤§å°æœ‰è¦æ±‚, ä¸èƒ½å»ºç«‹å¤ªå¤§çš„è¡¨, æ‰€ä»¥è¿™ç±»æ•°æ®åº“åªé€‚ç”¨åœ¨ç›¸å¯¹è¾ƒå°çš„æ•°æ®åº“è¡¨ã€‚</p><ul><li>å¦‚æœéœ€è¦<strong>å¾ˆå¿«çš„è¯»å†™é€Ÿåº¦, å¯¹æ•°æ®çš„å®‰å…¨æ€§è¦æ±‚è¾ƒä½, å¯ä»¥é€‰æ‹©MEMOEY</strong>ã€‚</li><li>å¦‚æœåªæ˜¯ä¸´æ—¶å­˜æ”¾æ•°æ®, æ•°æ®é‡ä¸å¤§, å¹¶ä¸”ä¸éœ€è¦è¾ƒé«˜çš„æ•°æ®å®‰å…¨æ€§, å¯ä»¥é€‰æ‹©å°†æ•°æ®ä¿å­˜åœ¨å†…å­˜ä¸­çš„Memoryå¼•æ“,</li></ul><p>ä¾‹å¦‚åœ¨MySQLä¸­ä½¿ç”¨è¯¥å¼•æ“ä½œä¸ºä¸´æ—¶è¡¨, å­˜æ”¾æŸ¥è¯¢çš„ä¸­é—´ç»“æœã€‚</p><p><strong>ARCHIVE</strong></p><ul><li><strong>éå¸¸é€‚åˆå­˜å‚¨å¤§é‡ç‹¬ç«‹çš„ã€ä½œä¸ºå†å²è®°å½•çš„æ•°æ®</strong>ã€‚Archiveéå¸¸é€‚åˆå­˜å‚¨å½’æ¡£æ•°æ®ã€‚ä¾‹å¦‚: éå¸¸é€‚åˆä½œä¸ºæ—¥å¿—è¡¨çš„å­˜å‚¨å¼•æ“, ä½†æ˜¯å‰ææ˜¯ä¸ç»å¸¸å¯¹è¯¥è¡¨è¿›è¡ŒæŸ¥è¯¢æ“ä½œã€‚</li><li>å¦‚æœåªæœ‰INSERTå’ŒSELECTæ“ä½œ, å¯¹æ•°æ®çš„å®‰å…¨æ€§è¦æ±‚è¾ƒä½, å¯ä»¥é€‰æ‹©Archive, Archiveæ”¯æŒé«˜å¹¶å‘çš„æ’å…¥æ“ä½œã€‚</li></ul><p><strong>CSV</strong></p><p>ä½¿ç”¨è¯¥å¼•æ“çš„MySQLæ•°æ®åº“è¡¨ä¼šåœ¨MySQLå®‰è£…ç›®å½•dataæ–‡ä»¶å¤¹ä¸­çš„å’Œè¯¥è¡¨æ‰€åœ¨æ•°æ®åº“åç›¸åŒçš„ç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ª.CSVæ–‡ä»¶(æ‰€ä»¥, å®ƒå¯ä»¥<strong>å°†CSVç±»å‹çš„æ–‡ä»¶å½“åšè¡¨è¿›è¡Œå¤„ç†</strong>)ã€‚</p><ul><li>åœ¨å®ç°æŸç§ç±»å‹çš„æ—¥å¿—è®°å½•æ—¶, CSVè¡¨ä½œä¸ºä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ã€‚</li></ul><p><strong>BLACKHOLEå­˜å‚¨å¼•æ“(é»‘æ´å¼•æ“)</strong></p><p>æ”¯æŒäº‹åŠ¡, è€Œä¸”æ”¯æŒMVCCçš„è¡Œçº§é”, <strong>å†™å…¥è¿™ç§å¼•æ“è¡¨ä¸­çš„ä»»ä½•æ•°æ®éƒ½ä¼šæ¶ˆå¤±</strong>, ä¸»è¦ç”¨äº<strong>ä¸€ä¸»å¤šä»çš„æ—¥å¿—è®°å½•æˆ–åŒæ­¥å½’æ¡£çš„ä¸­ç»§å­˜å‚¨</strong>ã€‚</p><p><strong>PERFORMANCE_SCHEMAå­˜å‚¨å¼•æ“</strong></p><p><strong>æ”¶é›†æ•°æ®åº“æœåŠ¡å™¨æ€§èƒ½å‚æ•°</strong>ã€‚åˆ†ææ€§èƒ½é™ä½å¯èƒ½æ˜¯ç”±äºå“ªäº›ç“¶é¢ˆã€‚</p><p>æ³¨æ„, <strong>åŒä¸€ä¸ªæ•°æ®åº“ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šç§å­˜å‚¨å¼•æ“çš„è¡¨</strong>ã€‚å¦‚æœä¸€ä¸ªè¡¨è¦æ±‚æ¯”è¾ƒé«˜çš„äº‹åŠ¡å¤„ç†, å¯ä»¥é€‰æ‹©InnoDBã€‚è¿™ä¸ªæ•°æ®åº“ä¸­å¯ä»¥å°†æŸ¥è¯¢è¦æ±‚æ¯”è¾ƒé«˜çš„è¡¨é€‰æ‹©MyISAMå­˜å‚¨ã€‚å¦‚æœè¯¥æ•°æ®åº“éœ€è¦ä¸€ä¸ªç”¨äºæŸ¥è¯¢çš„ä¸´æ—¶è¡¨, å¯ä»¥é€‰æ‹©MEMORYå­˜å‚¨å¼•æ“ã€‚</p></blockquote><h2 id="å‚çœ‹-1" tabindex="-1"><a class="header-anchor" href="#å‚çœ‹-1" aria-hidden="true">#</a> å‚çœ‹</h2><ul><li><p><a href="https://blog.csdn.net/yjclsx/article/details/81911027" target="_blank" rel="noopener noreferrer">mysqlå­˜å‚¨å¼•æ“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (æ¯”è¾ƒå…¨é¢)</p></li><li><p><a href="https://zhuanlan.zhihu.com/p/50564425" target="_blank" rel="noopener noreferrer">MySQLä¸­å¸¸ç”¨å­˜å‚¨å¼•æ“æœ‰å“ªäº›ï¼Ÿå®ƒä»¬ç›¸äº’ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="http://www.djjwz.com/news/news3520.html" target="_blank" rel="noopener noreferrer">BLACKHOLEå­˜å‚¨å¼•æ“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (ä»‹ç»äº†BLACKHOLE<strong>å­˜å‚¨å¼•æ“</strong>(é»‘æ´å¼•æ“)çš„ä½¿ç”¨åœºæ™¯)</p></li></ul><h1 id="mysqlçš„æ…¢æŸ¥è¯¢å’Œæ•°æ®åº“ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#mysqlçš„æ…¢æŸ¥è¯¢å’Œæ•°æ®åº“ä¼˜åŒ–" aria-hidden="true">#</a> MySQLçš„æ…¢æŸ¥è¯¢å’Œæ•°æ®åº“ä¼˜åŒ–</h1><h2 id="æ•°æ®åº“ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“ä¼˜åŒ–" aria-hidden="true">#</a> æ•°æ®åº“ä¼˜åŒ–</h2><p><a href="https://www.zhihu.com/question/19719997/answer/81930332" target="_blank" rel="noopener noreferrer">MySQL å¯¹äºåƒä¸‡çº§çš„å¤§è¡¨è¦æ€ä¹ˆä¼˜åŒ–ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="mysql-å•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢-å“ªä¸ªæ•ˆç‡é«˜" tabindex="-1"><a class="header-anchor" href="#mysql-å•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢-å“ªä¸ªæ•ˆç‡é«˜" aria-hidden="true">#</a> mysql å•è¡¨å¤šæ¬¡æŸ¥è¯¢å’Œå¤šè¡¨è”åˆæŸ¥è¯¢ï¼Œå“ªä¸ªæ•ˆç‡é«˜?</h3><figure><img src="/assets/20210726210911-0f9ecb6b.png" alt="image-20210726210904393" tabindex="0" loading="lazy"><figcaption>image-20210726210904393</figcaption></figure><p>å•è¡¨æŸ¥è¯¢æœ‰åˆ©äºåæœŸæ•°æ®é‡å¤§äº†åˆ†åº“åˆ†è¡¨ï¼Œå¦‚æœè”åˆæŸ¥è¯¢çš„è¯ï¼Œä¸€æ—¦åˆ†åº“ï¼ŒåŸæ¥çš„sqléƒ½éœ€è¦æ”¹åŠ¨</p><h2 id="æ…¢æŸ¥è¯¢ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ…¢æŸ¥è¯¢ä¼˜åŒ–" aria-hidden="true">#</a> æ…¢æŸ¥è¯¢ä¼˜åŒ–</h2><p>é¦–å…ˆå¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œè®°å½•æ…¢æŸ¥è¯¢è¯­å¥ï¼Œç„¶ååˆ†æSQLè¯­å¥ï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯æŸ¥è¯¢äº†å¤šä½™çš„è¡Œï¼Œç„¶ååˆ†æè¯­å¥æ‰§è¡Œè®¡åˆ’æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œä¹‹åä¿®æ”¹è¯­å¥æˆ–è€…ä¿®æ”¹ç´¢å¼•ï¼Œä½¿è¯­å¥å°½å¯èƒ½å‘½ä¸­ç´¢å¼•ï¼Œå¦‚æœå¯¹è¯­å¥çš„ä¼˜åŒ–å·²ç»æ— æ³•è¿›è¡Œï¼Œå¯ä»¥è€ƒè™‘è¡¨ä¸­çš„æ•°æ®é‡æ˜¯å¦å¤ªå¤§ï¼Œå¦‚æœæ˜¯çš„è¯å¯ä»¥è¿›è¡Œåˆ†è¡¨ã€‚</p><p>é€šè¿‡explainæŸ¥çœ‹sqlè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œé€šè¿‡æ‰§è¡Œè®¡åˆ’æ¥åˆ†æç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œåªéœ€è¦å°†explainæ·»åŠ åœ¨sqlè¯­å¥ä¹‹å‰å³å¯ã€‚</p><p>è¡¨ä¸­çš„ç´¢å¼•ï¼š</p><figure><img src="/assets/20210626214501-bf03e376.png" alt="è¡¨ä¸­çš„ç´¢å¼•" tabindex="0" loading="lazy"><figcaption>è¡¨ä¸­çš„ç´¢å¼•</figcaption></figure><p>é€šè¿‡explainæŸ¥çœ‹sqlæ˜¯å¦ç”¨åˆ°ç´¢å¼•ï¼š</p><figure><img src="/assets/20210626214556-570837f8.png" alt="explainæŸ¥çœ‹sqlçš„ç»“æœ" tabindex="0" loading="lazy"><figcaption>explainæŸ¥çœ‹sqlçš„ç»“æœ</figcaption></figure><ul><li><p><strong>type</strong> çš„ä¿¡æ¯å¾ˆæ˜æ˜¾çš„ä½“ç°æ˜¯å¦ç”¨åˆ°ç´¢å¼•ï¼Œå®ƒæä¾›äº†åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦é«˜æ•ˆçš„é‡è¦ä¾æ®ä¾æ®ï¼Œå¦‚const(ä¸»é”®ç´¢å¼•æˆ–è€…å”¯ä¸€äºŒçº§ç´¢å¼•è¿›è¡Œç­‰å€¼åŒ¹é…çš„æƒ…å†µä¸‹)ï¼Œref(æ™®é€šçš„â¼†çº§ç´¢å¼•åˆ—ä¸å¸¸é‡è¿›â¾ç­‰å€¼åŒ¹é…)ï¼Œindex(æ‰«æå…¨è¡¨ç´¢å¼•çš„è¦†ç›–ç´¢å¼•) ã€‚æ€§èƒ½å¦‚ä¸‹ï¼š<code>ALL &lt; index &lt; range ~ index_merge &lt; ref &lt; eq_ref &lt; const &lt; system</code>ã€‚ <code>ALL</code> ç±»å‹å› ä¸ºæ˜¯å…¨è¡¨æ‰«æ, å› æ­¤åœ¨ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶ä¸‹, å®ƒæ˜¯é€Ÿåº¦æœ€æ…¢çš„. è€Œ <code>index</code> ç±»å‹çš„æŸ¥è¯¢è™½ç„¶ä¸æ˜¯å…¨è¡¨æ‰«æ, ä½†æ˜¯å®ƒæ‰«æäº†æ‰€æœ‰çš„ç´¢å¼•, å› æ­¤æ¯” ALL ç±»å‹çš„ç¨å¿«ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¾—ä¿è¯æŸ¥è¯¢è‡³å°‘è¾¾åˆ°rangeçº§åˆ«ï¼Œæœ€å¥½èƒ½è¾¾åˆ°ref</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--all:å…¨è¡¨æ‰«æï¼Œä¸€èˆ¬æƒ…å†µä¸‹å‡ºç°è¿™æ ·çš„sqlè¯­å¥è€Œä¸”æ•°æ®é‡æ¯”è¾ƒå¤§çš„è¯é‚£ä¹ˆå°±éœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--indexï¼šå…¨ç´¢å¼•æ‰«æè¿™ä¸ªæ¯”allçš„æ•ˆç‡è¦å¥½ï¼Œä¸»è¦æœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å½“å‰çš„æŸ¥è¯¢æ—¶è¦†ç›–ç´¢å¼•ï¼Œå³æˆ‘ä»¬éœ€è¦çš„æ•°æ®åœ¨ç´¢å¼•ä¸­å°±å¯ä»¥ç´¢å–ï¼Œæˆ–è€…æ˜¯ä½¿ç”¨äº†ç´¢å¼•è¿›è¡Œæ’åºï¼Œè¿™æ ·å°±é¿å…æ•°æ®çš„é‡æ’åº</span>
<span class="token keyword">explain</span>  <span class="token keyword">select</span> empno <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--rangeï¼šè¡¨ç¤ºåˆ©ç”¨ç´¢å¼•æŸ¥è¯¢çš„æ—¶å€™é™åˆ¶äº†èŒƒå›´ï¼Œåœ¨æŒ‡å®šèŒƒå›´å†…è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿™æ ·é¿å…äº†indexçš„å…¨ç´¢å¼•æ‰«æï¼Œé€‚ç”¨çš„æ“ä½œç¬¦ï¼š =, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, BETWEEN, LIKE, or IN() </span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> empno <span class="token operator">between</span> <span class="token number">7000</span> <span class="token operator">and</span> <span class="token number">7500</span><span class="token punctuation">;</span>

<span class="token comment">--index_subqueryï¼šåˆ©ç”¨ç´¢å¼•æ¥å…³è”å­æŸ¥è¯¢ï¼Œä¸å†æ‰«æå…¨è¡¨</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> emp<span class="token punctuation">.</span>job <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> job <span class="token keyword">from</span> t_job<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--unique_subquery:è¯¥è¿æ¥ç±»å‹ç±»ä¼¼ä¸index_subquery,ä½¿ç”¨çš„æ˜¯å”¯ä¸€ç´¢å¼•</span>
 <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">--index_mergeï¼šåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­éœ€è¦å¤šä¸ªç´¢å¼•ç»„åˆä½¿ç”¨ï¼Œæ²¡æœ‰æ¨¡æ‹Ÿå‡ºæ¥</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> rental <span class="token keyword">where</span> rental_date <span class="token operator">like</span> <span class="token string">&#39;2005-05-26 07:12:2%&#39;</span> <span class="token operator">and</span> inventory_id<span class="token operator">=</span><span class="token number">3926</span> <span class="token operator">and</span> customer_id<span class="token operator">=</span><span class="token number">321</span>\G

<span class="token comment">--ref_or_nullï¼šå¯¹äºæŸä¸ªå­—æ®µå³éœ€è¦å…³è”æ¡ä»¶ï¼Œä¹Ÿéœ€è¦nullå€¼çš„æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©è¿™ç§è®¿é—®æ–¹å¼</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span>  e<span class="token punctuation">.</span>mgr <span class="token operator">is</span> <span class="token boolean">null</span> <span class="token operator">or</span> e<span class="token punctuation">.</span>mgr<span class="token operator">=</span><span class="token number">7369</span><span class="token punctuation">;</span>

<span class="token comment">--refï¼šä½¿ç”¨äº†éå”¯ä¸€æ€§ç´¢å¼•è¿›è¡Œæ•°æ®çš„æŸ¥æ‰¾</span>
 <span class="token keyword">create</span> <span class="token keyword">index</span> idx_3 <span class="token keyword">on</span> emp<span class="token punctuation">(</span>deptno<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e<span class="token punctuation">,</span>dept d <span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">=</span>d<span class="token punctuation">.</span>deptno<span class="token punctuation">;</span>

<span class="token comment">--eq_ref ï¼šä½¿ç”¨å”¯ä¸€æ€§ç´¢å¼•è¿›è¡Œæ•°æ®æŸ¥æ‰¾</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">,</span>emp2 <span class="token keyword">where</span> emp<span class="token punctuation">.</span>empno <span class="token operator">=</span> emp2<span class="token punctuation">.</span>empno<span class="token punctuation">;</span>

<span class="token comment">--constï¼šè¿™ä¸ªè¡¨è‡³å¤šæœ‰ä¸€ä¸ªåŒ¹é…è¡Œï¼Œ</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> empno <span class="token operator">=</span> <span class="token number">7369</span><span class="token punctuation">;</span>
 
<span class="token comment">--systemï¼šè¡¨åªæœ‰ä¸€è¡Œè®°å½•(ç­‰äºç³»ç»Ÿè¡¨)ï¼Œè¿™æ˜¯constç±»å‹çš„ç‰¹ä¾‹ï¼Œå¹³æ—¶ä¸ä¼šå‡ºç°</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>**select_typeï¼š**ä¸»è¦ç”¨æ¥åˆ†è¾¨æŸ¥è¯¢çš„ç±»å‹ï¼Œæ˜¯æ™®é€šæŸ¥è¯¢è¿˜æ˜¯è”åˆæŸ¥è¯¢è¿˜æ˜¯å­æŸ¥è¯¢</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">--sample:ç®€å•çš„æŸ¥è¯¢ï¼Œä¸åŒ…å«å­æŸ¥è¯¢å’Œunion</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp<span class="token punctuation">;</span>

<span class="token comment">--primary:æŸ¥è¯¢ä¸­è‹¥åŒ…å«ä»»ä½•å¤æ‚çš„å­æŸ¥è¯¢ï¼Œæœ€å¤–å±‚æŸ¥è¯¢åˆ™è¢«æ ‡è®°ä¸ºPrimary</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> staname<span class="token punctuation">,</span>ename supname <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> ename staname<span class="token punctuation">,</span>mgr <span class="token keyword">from</span> emp<span class="token punctuation">)</span> t <span class="token keyword">join</span> emp <span class="token keyword">on</span> t<span class="token punctuation">.</span>mgr<span class="token operator">=</span>emp<span class="token punctuation">.</span>empno <span class="token punctuation">;</span>

<span class="token comment">--union:è‹¥ç¬¬äºŒä¸ªselectå‡ºç°åœ¨unionä¹‹åï¼Œåˆ™è¢«æ ‡è®°ä¸ºunion</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&gt;</span><span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">--dependent union:è·Ÿunionç±»ä¼¼ï¼Œæ­¤å¤„çš„depententè¡¨ç¤ºunionæˆ–union allè”åˆè€Œæˆçš„ç»“æœä¼šå—å¤–éƒ¨è¡¨å½±å“</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> e<span class="token punctuation">.</span>empno  <span class="token operator">in</span> <span class="token punctuation">(</span> <span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token keyword">union</span> <span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&gt;</span><span class="token number">2000</span><span class="token punctuation">)</span>

<span class="token comment">--union result:ä»unionè¡¨è·å–ç»“æœçš„select</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno <span class="token operator">=</span> <span class="token number">10</span> <span class="token keyword">union</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&gt;</span><span class="token number">2000</span><span class="token punctuation">;</span>

<span class="token comment">--subquery:åœ¨selectæˆ–è€…whereåˆ—è¡¨ä¸­åŒ…å«å­æŸ¥è¯¢</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> sal <span class="token operator">&gt;</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token function">avg</span><span class="token punctuation">(</span>sal<span class="token punctuation">)</span> <span class="token keyword">from</span> emp<span class="token punctuation">)</span> <span class="token punctuation">;</span>

<span class="token comment">--dependent subquery:subqueryçš„å­æŸ¥è¯¢è¦å—åˆ°å¤–éƒ¨è¡¨æŸ¥è¯¢çš„å½±å“</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp e <span class="token keyword">where</span> e<span class="token punctuation">.</span>deptno <span class="token operator">in</span> <span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token keyword">distinct</span> deptno <span class="token keyword">from</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">--DERIVED: fromå­å¥ä¸­å‡ºç°çš„å­æŸ¥è¯¢ï¼Œä¹Ÿå«åšæ´¾ç”Ÿç±»ï¼Œ</span>
<span class="token keyword">explain</span> <span class="token keyword">select</span> staname<span class="token punctuation">,</span>ename supname <span class="token keyword">from</span> <span class="token punctuation">(</span><span class="token keyword">select</span> ename staname<span class="token punctuation">,</span>mgr <span class="token keyword">from</span> emp<span class="token punctuation">)</span> t <span class="token keyword">join</span> emp <span class="token keyword">on</span> t<span class="token punctuation">.</span>mgr<span class="token operator">=</span>emp<span class="token punctuation">.</span>empno <span class="token punctuation">;</span>

<span class="token comment">--UNCACHEABLE SUBQUERYï¼šè¡¨ç¤ºä½¿ç”¨å­æŸ¥è¯¢çš„ç»“æœä¸èƒ½è¢«ç¼“å­˜</span>
 <span class="token keyword">explain</span> <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> emp <span class="token keyword">where</span> empno <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">select</span> empno <span class="token keyword">from</span> emp <span class="token keyword">where</span> deptno<span class="token operator">=</span>@<span class="token variable">@sort_buffer_size</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
<span class="token comment">--uncacheable union:è¡¨ç¤ºunionçš„æŸ¥è¯¢ç»“æœä¸èƒ½è¢«ç¼“å­˜ï¼šsqlè¯­å¥æœªéªŒè¯</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>tableï¼šæ¯ä¸ªæŸ¥è¯¢å¯¹åº”çš„è¡¨å ã€‚</p><p>1ã€å¯¹åº”è¡Œæ­£åœ¨è®¿é—®å“ªä¸€ä¸ªè¡¨ï¼Œè¡¨åæˆ–è€…åˆ«åï¼Œå¯èƒ½æ˜¯ä¸´æ—¶è¡¨æˆ–è€…unionåˆå¹¶ç»“æœé›† 1ã€å¦‚æœæ˜¯å…·ä½“çš„è¡¨åï¼Œåˆ™è¡¨æ˜ä»å®é™…çš„ç‰©ç†è¡¨ä¸­è·å–æ•°æ®ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯è¡¨çš„åˆ«å</p><p>2ã€è¡¨åæ˜¯derivedNçš„å½¢å¼ï¼Œè¡¨ç¤ºä½¿ç”¨äº†idä¸ºNçš„æŸ¥è¯¢äº§ç”Ÿçš„è¡ç”Ÿè¡¨</p><p>3ã€å½“æœ‰union resultçš„æ—¶å€™ï¼Œè¡¨åæ˜¯union n1,n2ç­‰çš„å½¢å¼ï¼Œn1,n2è¡¨ç¤ºå‚ä¸unionçš„id</p></li><li><p>**possible_keyï¼š**æŸ¥è¯¢ä¸­å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•ï¼Œä¸€ä¸ªæˆ–å¤šä¸ªï¼ŒæŸ¥è¯¢æ¶‰åŠåˆ°çš„å­—æ®µä¸Šè‹¥å­˜åœ¨ç´¢å¼•</p></li><li><p>**keyï¼š**æ­¤å­—æ®µæ˜¯ MySQL åœ¨å½“å‰æŸ¥è¯¢æ—¶æ‰€çœŸæ­£ä½¿ç”¨åˆ°çš„ç´¢å¼•ã€‚</p></li><li><p>key_lenï¼šè¡¨ç¤ºç´¢å¼•ä¸­ä½¿ç”¨çš„å­—èŠ‚æ•°ï¼Œå¯ä»¥é€šè¿‡key_lenè®¡ç®—æŸ¥è¯¢ä¸­ä½¿ç”¨çš„ç´¢å¼•é•¿åº¦ï¼Œåœ¨ä¸æŸå¤±ç²¾åº¦çš„æƒ…å†µä¸‹é•¿åº¦è¶ŠçŸ­è¶Šå¥½ã€‚</p></li><li><p>filteredï¼šæŸ¥è¯¢å™¨é¢„æµ‹æ»¡è¶³ä¸‹ä¸€æ¬¡æŸ¥è¯¢æ¡ä»¶çš„ç™¾åˆ†æ¯” ã€‚</p></li><li><p><strong>rows:</strong> æ˜¾ç¤ºMySQLè®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¿™ä¸ªå€¼éå¸¸ç›´è§‚æ˜¾ç¤º SQL çš„æ•ˆç‡å¥½å, åŸåˆ™ä¸Š rows è¶Šå°‘è¶Šå¥½ã€‚</p></li><li><p>refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†ï¼Œå¦‚æœå¯èƒ½çš„è¯ï¼Œæ˜¯ä¸€ä¸ªå¸¸æ•°</p></li><li><p>extraï¼šè¡¨ç¤ºé¢å¤–ä¿¡æ¯ã€‚</p></li></ul><h1 id="mysqlçš„äº‹åŠ¡-éš”ç¦»çº§åˆ«å’ŒmvccåŸç†" tabindex="-1"><a class="header-anchor" href="#mysqlçš„äº‹åŠ¡-éš”ç¦»çº§åˆ«å’ŒmvccåŸç†" aria-hidden="true">#</a> MySQLçš„äº‹åŠ¡|éš”ç¦»çº§åˆ«å’ŒMVCCåŸç†</h1><h2 id="äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡" aria-hidden="true">#</a> äº‹åŠ¡</h2><h3 id="ä»€ä¹ˆæ˜¯äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯äº‹åŠ¡" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ</h3><blockquote><p>æ•°æ®åº“äº‹åŠ¡æŒ‡çš„æ˜¯ä¸€ç»„sqlè¯­å¥ç»„æˆçš„æ•°æ®åº“é€»è¾‘å¤„ç†å•å…ƒï¼Œåœ¨è¿™ç»„çš„sqlæ“ä½œä¸­ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡ŒæˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¤±è´¥ã€‚</p></blockquote><p>ä¾‹å­ï¼šè½¬è´¦ã€‚ç”¨æˆ·Aè¦è½¬è´¦ç»™ç”¨æˆ·Bï¼Œè¦ç»å†å¦‚ä¸‹è¿‡ç¨‹ï¼šç”¨æˆ·Aè½¬è´¦æ‰£é’±-&gt;ç”¨æˆ·Bæ”¶è´¦åŠ é’±ï¼Œä¸ºäº†<strong>ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§</strong>ï¼Œè¦é‡‡ç”¨äº‹åŠ¡ã€‚ä¸¤æ­¥æ“ä½œéƒ½è¦æˆåŠŸæ‰èƒ½æˆåŠŸï¼Œåªè¦æœ‰ä¸€æ­¥å‡ºé”™ï¼Œå…¨éƒ½æ‰§è¡Œå¤±è´¥ï¼Œå³å›æ»šã€‚</p><h3 id="äº‹åŠ¡çš„ç‰¹æ€§-acid" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡çš„ç‰¹æ€§-acid" aria-hidden="true">#</a> äº‹åŠ¡çš„ç‰¹æ€§(ACID)</h3><ul><li>åŸå­æ€§(Atomicity)ï¼šäº‹åŠ¡çš„åŸå­æ€§æ“ä½œï¼Œæ•°æ®æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚ <ul><li>åŸºäºæ—¥å¿—çš„<code>Redo/Undo</code>æœºåˆ¶</li></ul></li><li>ä¸€è‡´æ€§(Consistent)ï¼šäº‹åŠ¡æ‰§è¡Œå‰åçš„çŠ¶æ€è¦ä¸€è‡´ï¼Œå¯ç†è§£ä¸ºæ•°æ®ä¸€è‡´æ€§ã€‚</li><li>éš”ç¦»æ€§(Isalotion)ï¼šäº‹åŠ¡ä¹‹å‰ç›¸äº’éš”ç¦»ï¼Œä¸å—å½±å“ï¼Œä¸äº‹åŠ¡çš„éš”ç¦»çº§åˆ«å¯†åˆ‡ç›¸å…³ã€‚ <ul><li>æ•°æ®åº“ç³»ç»Ÿæä¾›-å®šçš„éš”ç¦»æœºåˆ¶ï¼Œäº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­çš„ä¸­é—´çŠ¶æ€å¯¹å¤–éƒ¨æ˜¯ä¸å¯è§çš„ï¼Œä¿è¯äº‹åŠ¡åœ¨ä¸å—å¤–éƒ¨å¹¶å‘æ“ä½œå½±å“çš„â€œç‹¬ç«‹â€ç¯å¢ƒæ‰§è¡Œã€‚</li></ul></li><li>æŒä¹…æ€§(Durable)ï¼šäº‹åŠ¡å®Œæˆä¹‹åï¼Œå®ƒå¯¹äºæ•°æ®çš„ä¿®æ”¹æ˜¯æ°¸ä¹…æ€§çš„(æŒä¹…åŒ–åˆ°æ•°æ®åº“)ï¼Œå³ä½¿å‡ºç°ç³»ç»Ÿæ•…éšœä¹Ÿèƒ½å¤Ÿä¿æŒã€‚</li></ul><p>åŸå­æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§éƒ½æ˜¯ä¸ºäº†ä¿éšœä¸€è‡´æ€§è€Œå­˜åœ¨çš„ï¼Œä¸€è‡´æ€§ä¹Ÿæ˜¯æœ€ç»ˆçš„ç›®çš„ã€‚</p><h3 id="ä»€ä¹ˆæ˜¯redo-undoæœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯redo-undoæœºåˆ¶" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯<code>Redo/Undo</code>æœºåˆ¶ï¼Ÿ</h3><p>Redo logç”¨æ¥è®°å½•æŸæ•°æ®å—è¢«ä¿®æ”¹åçš„å€¼ï¼Œå¯ä»¥ç”¨æ¥æ¢å¤äº‹åŠ¡å·²æäº¤ä½†è¿˜æœªæŒä¹…åŒ–åˆ°æ•°æ®åº“çš„æ•°æ®ï¼›Undo logæ˜¯ç”¨æ¥è®°å½•æ•°æ®æ›´æ–°å‰çš„å€¼ï¼Œä¿è¯æ•°æ®æ›´æ–°å¤±è´¥èƒ½å¤Ÿå›æ»šã€‚</p><p>åœºæ™¯ï¼šå‡å¦‚æŸä¸ªæ—¶åˆ»æ•°æ®åº“å´©æºƒï¼Œåœ¨å´©æºƒä¹‹å‰æœ‰äº‹åŠ¡Aå’Œäº‹åŠ¡Båœ¨æ‰§è¡Œï¼Œäº‹åŠ¡Aå·²ç»æäº¤ï¼Œè€Œäº‹åŠ¡Bè¿˜æœªæäº¤ã€‚å½“æ•°æ®åº“é‡å¯è¿›è¡Œ crash-recovery æ—¶ï¼Œå°±ä¼šé€šè¿‡Redo logå°†å·²ç»æäº¤äº‹åŠ¡çš„æ›´æ”¹å†™åˆ°æ•°æ®æ–‡ä»¶ï¼Œè€Œè¿˜æ²¡æœ‰æäº¤çš„å°±é€šè¿‡Undo logè¿›è¡Œroll backã€‚</p><h3 id="ä»€ä¹ˆæ˜¯è„è¯»-å¹»è¯»-ä¸å¯é‡å¤è¯»-äº‹åŠ¡å¯èƒ½å¯¼è‡´çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è„è¯»-å¹»è¯»-ä¸å¯é‡å¤è¯»-äº‹åŠ¡å¯èƒ½å¯¼è‡´çš„é—®é¢˜" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯è„è¯»ï¼Ÿå¹»è¯»ï¼Ÿä¸å¯é‡å¤è¯»ï¼Ÿ(äº‹åŠ¡å¯èƒ½å¯¼è‡´çš„é—®é¢˜)</h3><h4 id="è„è¯»" tabindex="-1"><a class="header-anchor" href="#è„è¯»" aria-hidden="true">#</a> è„è¯»</h4><p>è„è¯»æŒ‡çš„æ˜¯è¯»åˆ°äº†å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œæœªæäº¤æ„å‘³ç€è¿™äº›æ•°æ®å¯èƒ½ä¼šå›æ»šï¼Œä¹Ÿå°±æ˜¯å¯èƒ½æœ€ç»ˆä¸ä¼šå­˜åˆ°æ•°æ®åº“ä¸­ï¼Œä¹Ÿå°±æ˜¯ä¸å­˜åœ¨çš„æ•°æ®ã€‚è¯»åˆ°äº†å¹¶ä¸€å®šæœ€ç»ˆå­˜åœ¨çš„æ•°æ®ï¼Œè¿™å°±æ˜¯è„è¯»ã€‚</p><p><strong>ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®</strong>ã€‚ å›æ»šé€ æˆçš„å½±å“ã€‚</p><h4 id="ä¸å¯é‡å¤è¯»" tabindex="-1"><a class="header-anchor" href="#ä¸å¯é‡å¤è¯»" aria-hidden="true">#</a> ä¸å¯é‡å¤è¯»</h4><p>å¯¹æ¯”å¯é‡å¤è¯»ï¼Œä¸å¯é‡å¤è¯»æŒ‡çš„æ˜¯åœ¨åŒä¸€äº‹åŠ¡å†…ï¼Œä¸åŒçš„æ—¶åˆ»è¯»åˆ°çš„åŒä¸€æ‰¹æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œå¯èƒ½ä¼šå—åˆ°å…¶ä»–äº‹åŠ¡çš„å½±å“ï¼Œæ¯”å¦‚å…¶ä»–äº‹åŠ¡æ”¹äº†è¿™æ‰¹æ•°æ®å¹¶æäº¤äº†ã€‚é€šå¸¸é’ˆå¯¹æ•°æ®**æ›´æ–°(<code>UPDATE</code>)**æ“ä½œã€‚</p><p><strong>ä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†å¦ä¸€ä¸ªæœªæäº¤äº‹åŠ¡è¯»å–çš„æ•°æ®</strong>ã€‚ å†æ¬¡è¯»å–æ•°æ®å‘ç”Ÿå˜æ›´ã€‚</p><h4 id="å¹»è¯»" tabindex="-1"><a class="header-anchor" href="#å¹»è¯»" aria-hidden="true">#</a> å¹»è¯»</h4><p>å¹»è¯»æ˜¯é’ˆå¯¹æ•°æ®<strong>æ’å…¥(<code>INSERT</code>)</strong> æ“ä½œæ¥è¯´çš„ã€‚å‡è®¾äº‹åŠ¡Aä¿®æ”¹äº†æŸäº›è¡Œçš„æ•°æ®ï¼Œä½†æœªæäº¤ï¼Œæ­¤æ—¶äº‹åŠ¡Bæ’å…¥äº†ä¸äº‹åŠ¡Aæ›´æ”¹å‰è®°å½•ç›¸åŒçš„è®°å½•è¡Œï¼Œå¹¶å…ˆäºäº‹åŠ¡Aæäº¤ã€‚é‚£ä¹ˆåœ¨äº‹åŠ¡AæŸ¥è¯¢æ—¶ï¼Œä¼šå‘ç°å¥½åƒåˆšæ‰æ›´æ”¹å¯¹æŸäº›æ•°æ®æœªèµ·ä½œç”¨ï¼Œä½†å…¶å®æ˜¯äº‹åŠ¡Båˆšåˆšæ’å…¥è¿›æ¥çš„ï¼Œæ„Ÿè§‰é™¤äº†å¹»è§‰ï¼Œç§°ä¹‹ä¸ºå¹»è¯»ã€‚</p><p><strong>ä¸€ä¸ªäº‹åŠ¡æ ¹æ®æœç´¢æ¡ä»¶è¯»å‡ºäº†ä¸€æ‰¹æ•°æ®ï¼Œè¯¥äº‹åŠ¡æœªæäº¤ï¼Œä½†æ˜¯å¦ä¸€ä¸ªäº‹åŠ¡å†™å…¥äº†(å¢åˆ æ”¹)ç¬¦åˆæ¡ä»¶çš„è®°å½•ï¼Œå†æ¬¡è¯»å–å‘ç°æ•°æ®å‘ç”Ÿå˜æ›´</strong>ã€‚</p><h4 id="å¯é‡å¤è¯»-æ­£å¸¸æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#å¯é‡å¤è¯»-æ­£å¸¸æƒ…å†µ" aria-hidden="true">#</a> å¯é‡å¤è¯»(æ­£å¸¸æƒ…å†µ)</h4><p>å¯é‡å¤è¯»æŒ‡çš„æ˜¯åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…ï¼Œæœ€å¼€å§‹è¯»åˆ°çš„æ•°æ®å’Œäº‹åŠ¡ç»“æŸå‰çš„ä»»ä½•æ—¶åˆ»è¯»åˆ°çš„åŒä¸€æ‰¹æ•°æ®éƒ½æ˜¯ä¸€è‡´çš„ã€‚é€šå¸¸é’ˆå¯¹æ•°æ®**æ›´æ–°(<code>UPDATE</code>)**æ“ä½œã€‚</p><h3 id="äº‹åŠ¡éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> äº‹åŠ¡éš”ç¦»çº§åˆ«</h3><h4 id="éš”ç¦»çº§åˆ«è§£å†³çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#éš”ç¦»çº§åˆ«è§£å†³çš„é—®é¢˜" aria-hidden="true">#</a> éš”ç¦»çº§åˆ«è§£å†³çš„é—®é¢˜</h4><p>äº‹åŠ¡éš”ç¦»å…¶å®å°±æ˜¯ä¸ºäº†è§£å†³ä¸Šé¢æåˆ°çš„è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™å‡ ä¸ªé—®é¢˜ã€‚</p><table><thead><tr><th>éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»</th><th>å¹»è¯»</th></tr></thead><tbody><tr><td>è¯»æœªæäº¤(READ UNCOMMITTED)</td><td>å¯èƒ½</td><td>å¯èƒ½</td><td>å¯èƒ½</td></tr><tr><td>è¯»æäº¤ (READ COMMITTED)</td><td>ä¸å¯èƒ½</td><td>å¯èƒ½</td><td>å¯èƒ½</td></tr><tr><td>å¯é‡å¤è¯» (REPEATABLE READ)</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td>å¯èƒ½</td></tr><tr><td>ä¸²è¡ŒåŒ– (SERIALIZABLE)</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td></tr></tbody></table><p>ä»ä¸Šå¾€ä¸‹ï¼Œéš”ç¦»å¼ºåº¦é€æ¸å¢å¼ºï¼Œæ€§èƒ½é€æ¸å˜å·®ã€‚é‡‡ç”¨å“ªç§éš”ç¦»çº§åˆ«è¦æ ¹æ®ç³»ç»Ÿéœ€æ±‚æƒè¡¡å†³å®šï¼Œå…¶ä¸­ï¼Œ<strong>å¯é‡å¤è¯»</strong>æ˜¯ MySQL çš„é»˜è®¤çº§åˆ«ã€‚</p><h4 id="å¦‚ä½•è®¾ç½®éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#å¦‚ä½•è®¾ç½®éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> å¦‚ä½•è®¾ç½®éš”ç¦»çº§åˆ«</h4><ul><li><strong>æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„éš”ç¦»çº§åˆ«</strong>ï¼š</li></ul><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">#</span>
æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ« <span class="token number">5.7</span><span class="token number">.20</span> ä¹‹å
<span class="token keyword">show</span> variables <span class="token operator">like</span> <span class="token string">&#39;transaction_isolation&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">SELECT</span> @<span class="token variable">@transaction_isolation</span><span class="token punctuation">;</span>

<span class="token comment">#</span>
<span class="token number">5.7</span><span class="token number">.20</span> ä¹‹å‰
<span class="token keyword">SELECT</span> @<span class="token variable">@tx_isolation</span><span class="token punctuation">;</span>
<span class="token keyword">show</span>
variables <span class="token operator">like</span> <span class="token string">&#39;tx_isolation&#39;</span><span class="token punctuation">;</span>

<span class="token comment">#ç»“æœ</span>
ï¼š
<span class="token operator">+</span><span class="token comment">---------------+-----------------+</span>
<span class="token operator">|</span> Variable_name <span class="token operator">|</span> <span class="token keyword">Value</span>           <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-----------------+</span>
<span class="token operator">|</span> tx_isolation  <span class="token operator">|</span> <span class="token keyword">REPEATABLE</span><span class="token operator">-</span><span class="token keyword">READ</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token comment">---------------+-----------------+</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>æŸ¥è¯¢å½“å‰æœ‰å¤šå°‘äº‹åŠ¡æ­£åœ¨è¿è¡Œ</strong>ï¼š</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>select *
from information_schema.innodb_trx;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ä¿®æ”¹æ•°æ®åº“çš„éš”ç¦»çº§åˆ«</strong>ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">set</span>
<span class="token punctuation">[</span>ä½œç”¨åŸŸ<span class="token punctuation">]</span> <span class="token keyword">transaction</span> <span class="token keyword">isolation</span> <span class="token keyword">level</span> <span class="token punctuation">[</span>äº‹åŠ¡éš”ç¦»çº§åˆ«<span class="token punctuation">]</span>
ï¼Œ
<span class="token keyword">SET</span> <span class="token punctuation">[</span><span class="token keyword">SESSION</span> <span class="token operator">|</span> <span class="token keyword">GLOBAL</span><span class="token punctuation">]</span> <span class="token keyword">TRANSACTION</span> <span class="token keyword">ISOLATION</span> <span class="token keyword">LEVEL</span> {<span class="token keyword">READ</span> <span class="token keyword">UNCOMMITTED</span> <span class="token operator">|</span> <span class="token keyword">READ</span> <span class="token keyword">COMMITTED</span> <span class="token operator">|</span> <span class="token keyword">REPEATABLE</span> <span class="token keyword">READ</span> <span class="token operator">|</span> <span class="token keyword">SERIALIZABLE</span>}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>ä½œç”¨åŸŸä¸­GLOBAL æ˜¯å…¨å±€çš„ï¼Œè€Œ SESSION åªé’ˆå¯¹å½“å‰å›è¯çª—å£ã€‚</li><li>éš”ç¦»çº§åˆ«æ˜¯ {READ UNCOMMITTED | READ COMMITTED | REPEATABLE READ | SERIALIZABLE} è¿™å››ç§ï¼Œä¸åŒºåˆ†å¤§å°å†™ã€‚</li></ul><p>ä¾‹å­ï¼šæ¯”å¦‚ä¸‹é¢è¿™ä¸ªè¯­å¥çš„æ„æ€æ˜¯è®¾ç½®å…¨å±€éš”ç¦»çº§åˆ«ä¸ºè¯»æäº¤çº§åˆ«ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set global transaction isolation level read committed;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="éš”ç¦»çº§åˆ«åˆ†æ" tabindex="-1"><a class="header-anchor" href="#éš”ç¦»çº§åˆ«åˆ†æ" aria-hidden="true">#</a> éš”ç¦»çº§åˆ«åˆ†æ</h4><p>å»ºç«‹ä¸€å¼ è¡¨ç”¨æ¥æµ‹è¯•</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>CREATE TABLE `user`
(
    `id`   int(11) NOT NULL AUTO_INCREMENT,
    `name` varchar(30) DEFAULT NULL,
    `age`  tinyint(4)  DEFAULT NULL,
    PRIMARY KEY (`id`)
) ENGINE = InnoDB
  AUTO_INCREMENT = 2
  DEFAULT CHARSET = utf8mb4
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆå§‹åªæœ‰ä¸€æ¡è®°å½•ï¼š</p><figure><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfMAAAB7CAYAAABgm2lKAAAH/0lEQVR4nO3dW46jOBQA0NSoPrOoLD0L6D3VfIyYogl+AAZ84RxpNBWMwXZHXGwc8/V8Pn8eBe/3+/F4PB6v16u0a5XheC2PCQB39VUTzAGAfv1zdgEAgG0EcwAI7vvsAoy93+/ZZ+ip7UuPPfV6vWa3D2nTfKmy5fKvPX/qfK0tqf9c+txxxmnT7eZLALTXRTDPBbTH4zcIrL34z+UdT+pLpb9er+K5S/lL5x+OMZdnqTVttLb+ufqNP6duWARygHa6GGYfgkZpnzUBbqmtM/eX5s/dJJxhafnnAv1R/1YA/KeLYF6rZZA4Klimesstf+Y3bZO5bQBc13fpmW1qODi3bZo2KA1t11iTtybP1uB3VvCctv/adi2Vf5p+5M3Q9Hy5bWO59NR3OfdMv8XcDYA9fE8D3dzf04tYLs9grre45Xnw2JaAPvw9l76lbK3qdpbaCW9HB7S50ZjpttL3rzQnYPhc+o4K5ECvqobZay6ec3lS+7eYmb62V3+157nTIDTUr7c6bp3EuOZ8W/II3EAkTWazp3pPe2gREHKBpcWxj9S6DrUTEXsKdjXfv95ubgBaqg7mtcPUgz0u+FueBy/Nt7X8S37axXal9tXWwJU1mc1e+zvx2v1T5+jpgrylp7dXXY4cwp5OZhzb+99q7nxbjwEQ2defP3/+f9FK6iJdmvxUO1koNZu9Ziby1l5y6vg1E75Scs/fc8O8pTY88qZlbbnmvhul/cYTKlPnqy1n7mZi7tg1s9lTecfH6OmGEmCw6K1pLS9mLoxE4zsL9KpqmH06Y3qr8W+iAYBtvM8cAIILtZwrAPBJMAeA4ARzAAhOMAeA4D6Cee8zzHsv39mu3j5Xrx/AGnrmABCcYA4AwX09n8+frUuWnpXee/nOTh/26bV8reoHcHcfi8b0vmRl7+U729Xb5+r1A1jDMDsABCeYA0Bw1mYHgOD0zAEgOMEcAIITzAEgOMu5XszV2+fq9QNYQ88cAIITzAEguGbB/P1+GwIFgBOc0jMX+AGgnWbB/PV6Va+ZbW1tAGjHM3MACO67xUHGQ+apXvdZw+rDeaevAp2WM5VW+/rN6X7RRh9K/4Zz7XCl+gNE1iSYl947PffayqOC+xDEp2UYf86lDfnn9h3+TtUvSkDL1X/N59Q2APZxm2H2XGCp7Ylf1d3rDxBdk575FaSG45fmjypX/9IjinF+AI4nmD/aDAlHHlIu1b+mfSLXHyC6035n3qtWZeu5jjmpiW7DvIPaNQKi1h8goq/n8/kz3rCml1qa6TzdZzxsu+ZcS/LMDQ/ntk3Llit3aWj6DGtHGVL1Sh1zbhLc2F71N7EO4FOTYH6k3st3tj3ap6fZ6v79AT55Zk5RTyMPAHz66JkDALHc5nfmAHBVgjkABCeYA0BwgjkABPcRzHtf7KP38p3t6u1z9foBrKFnDgDBCeYAENzX8/n8yQ1d5t4iVnqP+d7pvZfv7PRhn17L16p+AHdnOdeLuXr7XL1+AGsYZgeA4ARzAAjO2uwAEJyeOQAEJ5gDQHCCOQAEZznXi7l6+1y9fgBr6JkDQHCCOQAE9330Ce+6gtcwPHzVuk+Hv6f1LKUDsN5hwbynZ51LAuvVg3ALczdo422ldAC2OWyY/fV6dXPxXlKOJfuWXgjSS/0BuBbPzNmdmxiAfR3+zPwsqV7z3DB6bmh9fJy5V3Tmjpc6Zqp8UYLg0nIaYgdo6xbBPPXM9vGYf9937h3gQ/rc51SQKr2Xe5overBLld/8A4B9GGZfIHqQPUKujYZ5Az1NhgS4glv0zFvYMwBNA1zUG4bam52hvlHrCdAbwbxSaSh9iysEtlwdrlA/gJ7dcpi91MsuPS+v6aUv6ckPxxz/F0luTgIA+/t6Pp8/4w179aJazdZeW77pMPZ0MlYqfaxmOLw0m30ub8tFVc7oBacCd64N1pZRLx/g02HD7GdfgFMz0Gs/l7bn0s+u+95qn5MDsA/PzDuQ+nkcANT4GGYHAGK55QQ4ALgSwRwAghPMASA4wRwAgvsI5r0v9tF7+c529fa5ev0A1tAzB4DgBHMACO7r+Xz+rF2LvPSe7r3Tey/f2enDPr2Wr1X9AO7usLXZW+m9fGe7evtcvX4AaxhmB4DgBHMACM7a7AAQnJ45AAQnmANAcII5AAQnmANAcIJ5UNYo/6UtgLsTzAOycMrfcqvcAdxBuLempbzf77BlXyIXyLe2QSl/z20soAN39j384UIY2zjIr+m5l/JvPT4A+wm3NntkW9s2lb8UfNccd0lw70mv5QLYk2fmABDcd3mXvPHw/PS55biHNB3Gn77ecpx3+vfSMsyl5cpWY+4xRE39pmlL6nUlW9pvbp+7tR9AzuZgPg7K06HZQWmYdvz/VPCtLcNc2rRsqTKlpMpfSp/W765DwFvbr+YzwJ01HWYfX1xrL7SpoN36Yt36wi+QbLOk/ea+C9of4NfmnnlLvc6on7vhyPU0+Zv2A9hXV8H88fi98PfW8yoNAx9R3l7bpsYR7Re1bQC26mI2e+9Bak2vsZSnZU902vOde76cO18pfym9ZGv7zfXs9eQBfv3/O/PSbOOU2nw1w6xrJ4rlyjA3A3rprOiaOtbMxh7vt9fvzXNlK52ztN/asrdqv9KvFnq9GQTY28eiMcQgeP3SFsDdCeYAEFwXz8wBgPUEcwAITjAHgOAEcwAITjAHgOAEcwAITjAHgOAEcwAITjAHgOAEcwAI7l+Tj1YPjZpKagAAAABJRU5ErkJggg==" alt="åˆå§‹userè¡¨æ•°æ®" tabindex="0" loading="lazy"><figcaption>åˆå§‹userè¡¨æ•°æ®</figcaption></figure><h5 id="è¯»æœªæäº¤" tabindex="-1"><a class="header-anchor" href="#è¯»æœªæäº¤" aria-hidden="true">#</a> è¯»æœªæäº¤</h5><p>MySQL äº‹åŠ¡éš”ç¦»å…¶å®æ˜¯ä¾é é”æ¥å®ç°çš„ï¼ŒåŠ é”è‡ªç„¶ä¼šå¸¦æ¥æ€§èƒ½çš„æŸå¤±ã€‚è€Œè¯»æœªæäº¤éš”ç¦»çº§åˆ«æ˜¯ä¸åŠ é”çš„ï¼Œæ‰€ä»¥å®ƒçš„æ€§èƒ½æ˜¯æœ€å¥½çš„ï¼Œæ²¡æœ‰åŠ é”ã€è§£é”å¸¦æ¥çš„æ€§èƒ½å¼€é”€ã€‚ä½†æœ‰åˆ©å°±æœ‰å¼Šï¼Œè¿™åŸºæœ¬ä¸Šå°±ç›¸å½“äºè£¸å¥”å•Šï¼Œæ‰€ä»¥å®ƒè¿è„è¯»çš„é—®é¢˜éƒ½æ²¡åŠæ³•è§£å†³ã€‚</p><p>ä»»ä½•äº‹åŠ¡å¯¹æ•°æ®çš„ä¿®æ”¹éƒ½ä¼šç¬¬ä¸€æ—¶é—´æš´éœ²ç»™å…¶ä»–äº‹åŠ¡ï¼Œå³ä½¿äº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ã€‚</p><p>åšä¸€ä¸ªå®éªŒï¼Œå…ˆå°†å…¨å±€éš”ç¦»çº§åˆ«è®¾ç½®ä¸º<strong>è¯»æœªæäº¤</strong>ï¼š</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set global transaction isolation level read uncommitted;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>è®¾ç½®å®Œæˆåï¼Œåªå¯¹ä¹‹åæ–°èµ·çš„ session æ‰èµ·ä½œç”¨ï¼Œå¯¹å·²ç»å¯åŠ¨ session æ— æ•ˆã€‚å¦‚æœç”¨ shell å®¢æˆ·ç«¯é‚£å°±è¦é‡æ–°è¿æ¥ MySQLï¼Œå¦‚æœç”¨ Navicat é‚£å°±è¦åˆ›å»ºæ–°çš„æŸ¥è¯¢çª—å£ã€‚è¿™æ—¶å€™å†é‡æ–°å¯åŠ¨ä¸¤ä¸ªé»‘çª—å£è¿›è¡Œæ¨¡æ‹Ÿã€‚</p><p>Mysqlä¸­å¼€å¯äº‹åŠ¡æœ‰ä¸¤ç§æ–¹å¼<code>begin/start transaction</code>ï¼Œæœ€åæäº¤äº‹åŠ¡æ‰§è¡Œcommitï¼Œæˆ–è€…å›æ»šäº‹åŠ¡rollbackã€‚åœ¨æ‰§è¡Œ<code>begin/start transaction</code> å‘½ä»¤ï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ä¸€ä¸ªäº‹åŠ¡çš„èµ·ç‚¹ï¼Œåœ¨æ‰§è¡Œå®Œå®ƒä»¬åçš„ç¬¬ä¸€ä¸ªsqlè¯­å¥ï¼Œæ‰è¡¨ç¤ºäº‹åŠ¡çœŸæ­£çš„å¯åŠ¨</p><p><strong>åˆ†ææ‰§è¡Œæµç¨‹</strong>ï¼š</p><p>1ã€åœ¨ç¬¬ä¸€ä¸ªé»‘çª—å£(äº‹åŠ¡A)ä¸­ï¼Œæ‰§è¡Œ<code>beginï¼›</code>åï¼›å°†<code>id=1</code>çš„æ•°æ®è¡Œæ”¹ä¸º<code>name=&#39;duktig666&#39;</code>ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>begin;
UPDATE user
SET name=&#39;duktig666&#39;
WHERE id = 2;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€åœ¨ç¬¬äºŒä¸ªé»‘çª—å£(äº‹åŠ¡B)ä¸­ï¼Œæ‰§è¡Œæ‰§è¡Œ<code>beginï¼›</code>åï¼›æ‰§è¡ŒæŸ¥è¯¢ï¼Œè§‚å¯Ÿæ•°æ®ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>begin;
SELECT * FROM user;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€åœ¨ç¬¬ä¸€ä¸ªé»‘çª—å£(äº‹åŠ¡A)ä¸­å°†äº‹åŠ¡å›æ»šï¼Œåœ¨ç¬¬äºŒä¸ªé»‘çª—å£(äº‹åŠ¡B)ä¸­å†æ¬¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œè§‚å¯Ÿæ•°æ®ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>rollback;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT * FROM user;commit;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="/assets/20210627180646-5f2e04c9.png" alt="è¯»æœªæäº¤åˆ†æ" tabindex="0" loading="lazy"><figcaption>è¯»æœªæäº¤åˆ†æ</figcaption></figure><p><strong>æ€»ç»“</strong>ï¼š</p><p><strong>è¯»æœªæäº¤ï¼Œå…¶å®å°±æ˜¯å¯ä»¥è¯»åˆ°å…¶ä»–äº‹åŠ¡æœªæäº¤çš„æ•°æ®ï¼Œä½†æ²¡æœ‰åŠæ³•ä¿è¯ä½ è¯»åˆ°çš„æ•°æ®æœ€ç»ˆä¸€å®šæ˜¯æäº¤åçš„æ•°æ®ï¼Œå¦‚æœä¸­é—´å‘ç”Ÿå›æ»šï¼Œé‚£å°±ä¼šå‡ºç°è„æ•°æ®é—®é¢˜ï¼Œè¯»æœªæäº¤æ²¡åŠæ³•è§£å†³è„æ•°æ®é—®é¢˜ã€‚æ›´åˆ«æå¯é‡å¤è¯»å’Œå¹»è¯»äº†ï¼Œæƒ³éƒ½ä¸è¦æƒ³ã€‚</strong></p><h5 id="è¯»æäº¤" tabindex="-1"><a class="header-anchor" href="#è¯»æäº¤" aria-hidden="true">#</a> è¯»æäº¤</h5><p>æ—¢ç„¶è¯»æœªæäº¤æ²¡åŠæ³•è§£å†³è„æ•°æ®é—®é¢˜ï¼Œé‚£ä¹ˆå°±æœ‰äº†è¯»æäº¤ã€‚</p><p><strong>è¯»æäº¤å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡åªèƒ½è¯»åˆ°å…¶ä»–äº‹åŠ¡å·²ç»æäº¤è¿‡çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å…¶ä»–äº‹åŠ¡è°ƒç”¨ commit å‘½ä»¤ä¹‹åçš„æ•°æ®</strong>ã€‚é‚£è„æ•°æ®é—®é¢˜è¿åˆƒè€Œè§£äº†ã€‚</p><p>è¯»æäº¤äº‹åŠ¡éš”ç¦»çº§åˆ«æ˜¯å¤§å¤šæ•°æµè¡Œæ•°æ®åº“çš„é»˜è®¤äº‹åŠ¡éš”ç¦»ç•Œåˆ«ï¼Œæ¯”å¦‚ Oracleï¼Œä½†æ˜¯ä¸æ˜¯ MySQL çš„é»˜è®¤éš”ç¦»ç•Œåˆ«ã€‚</p><p>ç»§ç»­éªŒè¯ï¼Œå°†äº‹åŠ¡éš”ç¦»çº§åˆ«è®¾ç½®ä¸º<strong>è¯»æäº¤</strong>ï¼Œç„¶åé‡æ–°æ‰“å¼€ä¸¤ä¸ªmysqlé»‘çª—å£ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set global transaction isolation level read committed;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>åˆ†ææ‰§è¡Œæµç¨‹</strong>ï¼š</p><p>1ã€äº‹åŠ¡Aå¼€å¯äº‹åŠ¡ï¼Œæ‰§è¡Œä¿®æ”¹æ“ä½œä¿®æ”¹id=2çš„nameï¼šduktig-&gt;duktig666ã€‚</p><p>2ã€æ­¤æ—¶äº‹åŠ¡Aæœªæäº¤ï¼Œäº‹åŠ¡Bå¼€å¯äº‹åŠ¡ï¼Œæ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œæ•°æ®ä¸ºduktigã€‚</p><p>3ã€äº‹åŠ¡Aæäº¤ï¼Œäº‹åŠ¡Bå†æ¬¡æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œæ•°æ®ä¸ºduktig666ã€‚</p><p>å…·ä½“ä»£ç å‚çœ‹â€œè¯»æœªæäº¤éƒ½å·®ä¸å¤šâ€ã€‚</p><figure><img src="/assets/20210627184016-bb545c54.png" alt="è¯»æäº¤åˆ†æ" tabindex="0" loading="lazy"><figcaption>è¯»æäº¤åˆ†æ</figcaption></figure><p>åœ¨ä¸åŒçš„æ—¶åˆ»ï¼ŒæŸ¥è¯¢å‡ºæ¥çš„æ•°æ®å¯èƒ½æ˜¯ä¸ä¸€è‡´çš„ï¼Œå¯èƒ½ä¼šå—åˆ°å…¶ä»–äº‹åŠ¡çš„å½±å“ã€‚</p><p><strong>æ€»ç»“</strong>ï¼š</p><p>è¯»æäº¤è§£å†³äº†è„è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯æ— æ³•åšåˆ°å¯é‡å¤è¯»ï¼Œä¹Ÿæ²¡åŠæ³•è§£å†³å¹»è¯»ã€‚</p><h5 id="å¯é‡å¤è¯»" tabindex="-1"><a class="header-anchor" href="#å¯é‡å¤è¯»" aria-hidden="true">#</a> å¯é‡å¤è¯»</h5><p>å¯é‡å¤æ˜¯å¯¹æ¯”ä¸å¯é‡å¤è€Œè¨€çš„ï¼Œä¸Šé¢è¯´ä¸å¯é‡å¤è¯»æ˜¯æŒ‡åŒä¸€äº‹åŠ¡ä¸åŒæ—¶åˆ»è¯»åˆ°çš„æ•°æ®å€¼å¯èƒ½ä¸ä¸€è‡´ã€‚</p><p><strong>å¯é‡å¤è¯»æ˜¯æŒ‡ï¼Œäº‹åŠ¡ä¸ä¼šè¯»åˆ°å…¶ä»–äº‹åŠ¡å¯¹å·²æœ‰æ•°æ®çš„ä¿®æ”¹ï¼Œå³ä½¿å…¶ä»–äº‹åŠ¡å·²æäº¤ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œäº‹åŠ¡å¼€å§‹æ—¶è¯»åˆ°çš„å·²æœ‰æ•°æ®æ˜¯ä»€ä¹ˆï¼Œåœ¨äº‹åŠ¡æäº¤å‰çš„ä»»æ„æ—¶åˆ»ï¼Œè¿™äº›æ•°æ®çš„å€¼éƒ½æ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œå¯¹äºå…¶ä»–äº‹åŠ¡æ–°æ’å…¥çš„æ•°æ®æ˜¯å¯ä»¥è¯»åˆ°çš„ï¼Œè¿™ä¹Ÿå°±å¼•å‘äº†å¹»è¯»é—®é¢˜</strong>ã€‚</p><p>ç»§ç»­éªŒè¯ï¼Œéœ€æ”¹å…¨å±€éš”ç¦»çº§åˆ«ä¸ºå¯é‡å¤è¯»çº§åˆ«ï¼Œ<strong>å°†nameé‡ç½®ä¸ºduktig</strong>ï¼Œå¹¶é‡æ–°æ‰“å¼€ä¸¤ä¸ªé»‘çª—å£ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>set global transaction isolation level repeatable read;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¯å¯¹è¯»æäº¤çš„æµç¨‹å†æ‰§è¡Œä¸€æ¬¡ï¼Œå‘ç°ä¿®æ”¹æ“ä½œä¸ä¼šå‡ºç°å¯é‡å¤è¯»ï¼Œå³è§£å†³äº†å¯é‡å¤è¯»(ä¸Šè¿°æ“ä½œä¸åœ¨é‡å¤éªŒè¯)ã€‚ä½†æ˜¯æ›´æ–°æ“ä½œåˆå¼•èµ·äº†æ•°æ®ä¸ä¸€è‡´(å¹»è¯»)ã€‚</p><p><strong>åˆ†æéªŒè¯æµç¨‹</strong>ï¼š</p><p>1ã€å¼€å¯äº‹åŠ¡Aï¼Œæ‰§è¡Œä¿®æ”¹æ“ä½œä¿®æ”¹id=2çš„nameï¼šduktig-&gt;duktig666ã€‚</p><p>2ã€å¼€å¯äº‹åŠ¡Bï¼Œåœ¨äº‹åŠ¡Aæ‰§è¡Œå®Œupdateåï¼Œæ‰§è¡Œinsertæ“ä½œï¼Œæ’å…¥è®°å½•â€œ<code>name=&#39;duktig&#39; age=23</code>â€(è¿™æ¡æ•°æ®å’Œäº‹åŠ¡Aä¿®æ”¹å‰çš„nameå’Œageçš„å€¼ç›¸åŒ)ã€‚</p><div class="language-mysql line-numbers-mode" data-ext="mysql"><pre class="language-mysql"><code>INSERT INTO user (name, age)
VALUES (&#39;duktig&#39;, 23);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>3ã€äº‹åŠ¡Bæäº¤åï¼Œäº‹åŠ¡Aæ‰§è¡Œselectæ“ä½œï¼ŒæŸ¥è¯¢<code>age=23</code>çš„æ•°æ®ï¼Œè¿™æ—¶å‡ºç°äº†å¤šä¸€è¡Œçš„æ•°æ®ï¼Œè¿™æ˜¯äº‹åŠ¡Båˆšåˆšæ’å…¥çš„ï¼Œå³å¹»è¯»ã€‚</p><figure><img src="/assets/20210627190808-1269aeda.png" alt="å¯é‡å¤è¯»åˆ†æ" tabindex="0" loading="lazy"><figcaption>å¯é‡å¤è¯»åˆ†æ</figcaption></figure><p>çœ‹åˆ°æœ‰æ–‡ç« æåˆ°ï¼Œåœ¨Mysqlä¸­ï¼Œé»˜è®¤çš„ä¸å¯é‡å¤è¯»ä¸ªéš”ç¦»çº§åˆ«ä¹Ÿè§£å†³äº†å¹»è¯»çš„é—®é¢˜ã€‚ä½†æ˜¯æˆ‘è¿™ç¡®å®å‡ºç°äº†å¹»è¯»é—®é¢˜ï¼Œè¿™éœ€è¦å†åˆ†æåˆ†æã€‚</p><h5 id="ä¸²è¡ŒåŒ–" tabindex="-1"><a class="header-anchor" href="#ä¸²è¡ŒåŒ–" aria-hidden="true">#</a> ä¸²è¡ŒåŒ–</h5><p>ä¸²è¡ŒåŒ–æ˜¯4ç§äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸­éš”ç¦»æ•ˆæœæœ€å¥½çš„ï¼Œè§£å†³äº†è„è¯»ã€å¯é‡å¤è¯»ã€å¹»è¯»çš„é—®é¢˜ï¼Œä½†æ˜¯æ•ˆæœæœ€å·®ï¼Œå®ƒå°†äº‹åŠ¡çš„æ‰§è¡Œå˜ä¸ºé¡ºåºæ‰§è¡Œï¼Œä¸å…¶ä»–ä¸‰ä¸ªéš”ç¦»çº§åˆ«ç›¸æ¯”ï¼Œå®ƒå°±ç›¸å½“äºå•çº¿ç¨‹ï¼Œåä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œå¿…é¡»ç­‰å¾…å‰ä¸€ä¸ªäº‹åŠ¡ç»“æŸã€‚</p><h3 id="mvccåŸç†" tabindex="-1"><a class="header-anchor" href="#mvccåŸç†" aria-hidden="true">#</a> MVCCåŸç†</h3><h4 id="ç‰ˆæœ¬é“¾" tabindex="-1"><a class="header-anchor" href="#ç‰ˆæœ¬é“¾" aria-hidden="true">#</a> ç‰ˆæœ¬é“¾</h4><p>InnoDBèšç°‡ç´¢å¼•çš„ä¸¤ä¸ªå¿…è¦éšè—åˆ—ï¼š</p><ol><li><code>trx_id</code>ï¼šä¸€ä¸ªäº‹åŠ¡æ¯æ¬¡å¯¹æŸæ¡èšç°‡ç´¢å¼•æ”¹åŠ¨æ—¶ï¼Œä¼šæŠŠæ”¹äº‹åŠ¡çš„idèµ‹å€¼ç»™<code>trx_id</code>ã€‚</li><li><code>roll_pointer</code>ï¼šæ¯æ¬¡å¯¹æŸæ¡èšç°‡ç´¢å¼•æ”¹åŠ¨æ—¶ï¼Œä¼šå°†æ—§ç‰ˆæœ¬å†™åˆ°undoæ—¥å¿—ä¸­ã€‚è¿™ä¸ªéšè—åˆ—ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡å®ƒæ‰¾åˆ°è¯¥è®°å½•ä¿®æ”¹å‰çš„ä¿¡æ¯ã€‚(Insertæ“ä½œçš„undoæ—¥å¿—æ²¡æœ‰è¯¥å±æ€§ï¼Œinsert undoåªåœ¨äº‹åŠ¡å›æ»šæ—¶å‘æŒ¥ä½œç”¨ï¼Œäº‹åŠ¡æäº¤åå°±æ²¡ç”¨äº†ã€‚</li></ol><p>ç‰ˆæœ¬é“¾ï¼šæ¯æ¬¡æ›´æ–°è®°å½•ï¼Œæ—§å€¼æ”¾åˆ°undoæ—¥å¿—ï¼Œæ ¹æ®<code>roll_pointer</code>è¿æˆä¸€æ¡ç‰ˆæœ¬é“¾ï¼Œå¤´èŠ‚ç‚¹æ˜¯å½“å‰è®°å½•çš„æœ€æ–°å€¼ã€‚å¦å¤–è¿˜åŒ…å«æ¯ä¸ªç‰ˆæœ¬å¯¹åº”çš„äº‹åŠ¡idã€‚</p><p><strong>é€šè¿‡ç‰ˆæœ¬é“¾æ¥æ§åˆ¶å¹¶å‘äº‹åŠ¡è®¿é—®ç›¸åŒè®°å½•æ—¶çš„è¡Œä¸º</strong>ï¼Œç§°è¿™ç§æœºåˆ¶ä¸ºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ã€‚</p><h4 id="readview" tabindex="-1"><a class="header-anchor" href="#readview" aria-hidden="true">#</a> ReadView</h4><p>è¯»æœªæäº¤ç›´æ¥è¯»æœ€æ–°çš„ç‰ˆæœ¬å°±å¥½äº†ï¼Œä½†æ˜¯<strong>è¯»æäº¤å’Œå¯é‡å¤è¯»éƒ½å¿…é¡»ä¿è¯è¯»åˆ°å·²æäº¤çš„äº‹åŠ¡ä¿®æ”¹è¿‡çš„è®°å½•</strong>ï¼Œå³å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»ä¿®æ”¹äº†è®°å½•ä½†æ˜¯æœªæäº¤ï¼Œåˆ™ä¸èƒ½è¯»å–æœ€æ–°ç‰ˆçš„è®°å½•ã€‚</p><p><strong>æ ¸å¿ƒé—®é¢˜ï¼šéœ€è¦åˆ¤æ–­ç‰ˆæœ¬é“¾ä¸­çš„å“ªä¸ªç‰ˆæœ¬æ˜¯å½“å‰äº‹åŠ¡å¯è§çš„</strong>ã€‚</p><p>ReadViewçš„å››ä¸ªé‡è¦å†…å®¹ï¼š</p><ol><li><code>m_ids</code>ï¼šåœ¨ç”ŸæˆReadViewæ—¶ï¼Œå½“å‰ç³»ç»Ÿæ´»è·ƒè¯»å†™äº‹åŠ¡çš„äº‹åŠ¡idåˆ—è¡¨ã€‚</li><li><code>min_trx_id</code>ï¼šåœ¨ç”ŸæˆReadViewæ—¶ï¼Œå½“å‰ç³»ç»Ÿæ´»è·ƒè¯»å†™äº‹åŠ¡çš„æœ€å°äº‹åŠ¡idï¼›ä¹Ÿå°±æ˜¯<code>m_ids</code>ä¸­çš„æœ€å°å€¼ã€‚</li><li><code>max_trx_id</code>ï¼šåœ¨ç”ŸæˆReadViewæ—¶ï¼Œç³»ç»Ÿåº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„idå€¼ã€‚</li><li><code>creator_trx_id</code>ï¼šç”Ÿæˆè¯¥ReadViewçš„äº‹åŠ¡çš„äº‹åŠ¡idã€‚åªæœ‰æ‰§è¡Œinsertã€updateã€deleteæ“ä½œæ—¶æ‰ä¼šåˆ†é…äº‹åŠ¡idï¼Œå¦åˆ™è¯¥å€¼é»˜è®¤ä¸º0ã€‚</li></ol><p><strong>å¦‚ä½•åˆ¤æ–­ç‰ˆæœ¬å¯è§ï¼Ÿ</strong></p><ol><li>è®¿é—®ç‰ˆæœ¬çš„trx_idä¸creator_trx_idç›¸åŒ(äº‹åŠ¡è®¿é—®è‡ªå·±çš„ç‰ˆæœ¬)ï¼Œå¯ä»¥è®¿é—®è¯¥ç‰ˆæœ¬ã€‚</li><li>è®¿é—®ç‰ˆæœ¬çš„trx_idå°äºmin_trx_idï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”ŸæˆReadViewä¹‹å‰å·²æäº¤ï¼Œå¯ä»¥è®¿é—®ã€‚</li><li>è®¿é—®ç‰ˆæœ¬çš„trx_idå¤§äºmax_trx_idï¼Œä¸å¯è®¿é—®ã€‚</li><li>trx_idåœ¨min_trx_idå’Œmax_trx_idä¹‹é—´ï¼Œéœ€è¦åˆ¤æ–­trx_idæ˜¯å¦åœ¨m_idsä¸­ï¼Œç”¨ä»¥ç¡®å®šæ˜¯å¦è®¿é—®ã€‚åœ¨ï¼Œåˆ™ä¸èƒ½è®¿é—®ã€‚</li></ol><p><strong>è¯»æäº¤å’Œå¯é‡å¤è¯»ç”ŸæˆReadViewçš„æ—¶æœºï¼š</strong></p><ul><li>è¯»æäº¤ï¼šæ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ªReadViewã€‚</li><li>å¯é‡å¤è¯»ï¼šåœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”ŸæˆReadViewã€‚</li></ul><h4 id="äºŒæ¬¡ç´¢å¼•ä¸mvcc" tabindex="-1"><a class="header-anchor" href="#äºŒæ¬¡ç´¢å¼•ä¸mvcc" aria-hidden="true">#</a> äºŒæ¬¡ç´¢å¼•ä¸MVCC</h4><p>åªæœ‰åœ¨èšç°‡ç´¢å¼•ä¸­æ‰æœ‰ <code>trx_id</code> å’Œ <code>roll_pointer</code> éšè—åˆ—ï¼Œé‚£ä¹ˆ<strong>äºŒçº§ç´¢å¼•(éèšç°‡ç´¢å¼•)å¦‚ä½•åˆ¤æ–­å¯è§æ€§å‘¢</strong>ï¼Ÿ</p><ol><li>äºŒçº§ç´¢å¼•é¡µé¢çš„Page Headeréƒ¨åˆ†ï¼Œæœ‰ä¸€ä¸ªå±æ€§ <code>PAGE_MAX_TRX_ID</code>ï¼Œæ‰§è¡Œå¢åˆ æ”¹æŸ¥æ—¶ï¼Œå¦‚æœæ‰§è¡Œæ“ä½œçš„äº‹åŠ¡idå¤§äº<code>PAGE_MAX_TRX_ID</code> çš„å€¼ï¼Œåˆ™å°†å…¶å€¼è®¾ç½®ä¸ºæ‰§è¡Œæ“ä½œçš„äº‹åŠ¡idã€‚å³ <strong><code>PAGE_MAX_TRX_ID</code> ä»£è¡¨ä¿®æ”¹è¯¥äºŒçº§ç´¢å¼•é¡µé¢æœ€å¤§çš„äº‹åŠ¡id</strong>ã€‚</li><li>æ‰§è¡Œselectæ—¶ï¼Œå¦‚æœReadViewçš„ <code>min_trx_id</code> å¤§äº <code>PAGE_MAX_TRX_ID</code>ï¼Œåˆ™è¯´æ˜è¯¥é¡µé¢çš„å€¼å¯¹ReadViewå¯è§ï¼›å¦‚æœå°äºï¼Œåˆ™éœ€è¦å›è¡¨è¿›è¡Œåˆ¤æ–­ã€‚</li><li>åˆ©ç”¨äºŒçº§ç´¢å¼•ä¸­çš„ä¸»é”®è¿›è¡Œå›è¡¨æ“ä½œï¼Œå¾—åˆ°èšç°‡ç´¢å¼•çš„è®°å½•åï¼Œå†æŒ‰ç…§èšç°‡ç´¢å¼•çš„æ–¹å¼ä»ç¬¬ä¸€ä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œä¾æ¬¡åˆ¤æ–­å¯è§æ€§ã€‚</li></ol><h4 id="å¯é‡å¤è¯»æ˜¯å¦èƒ½è§£å†³å¹»è¯»é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¯é‡å¤è¯»æ˜¯å¦èƒ½è§£å†³å¹»è¯»é—®é¢˜" aria-hidden="true">#</a> å¯é‡å¤è¯»æ˜¯å¦èƒ½è§£å†³å¹»è¯»é—®é¢˜ï¼Ÿ</h4><p>mysqlçš„å¯é‡å¤è¯»åœ¨MVCCå’Œé”æœºåˆ¶ä¸‹å°½å¯èƒ½ä¿è¯å¹»è¯»é—®é¢˜ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å®Œå…¨ç¦æ­¢å¹»è¯»ã€‚</p><p>ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä»ç„¶å¯èƒ½å‡ºç°å¹»è¯»é—®é¢˜ï¼š</p><ul><li>T1æ‰§è¡ŒSELECTç”ŸæˆReadView</li><li>T2æ–°æ’å…¥ä¸€æ¡è®°å½•ï¼Œå¹¶ä¸”æäº¤ã€‚</li><li><strong>ReadViewä¸èƒ½é˜»æ­¢T1æ‰§è¡ŒUPDATEæˆ–è€…DELETEè¯­å¥æ¥æ”¹åŠ¨è¿™æ¡æ–°æ’å…¥çš„è®°å½•</strong>ã€‚(ç”±äºT2æäº¤ï¼Œæ”¹åŠ¨è¿™æ¡è®°å½•å¹¶ä¸èƒ½é€ æˆé˜»å¡)</li><li>T1ä¿®æ”¹è¿™æ¡è®°å½•ï¼Œè¿™æ¡è®°å½•çš„trx_idå˜æˆäº†T1çš„idã€‚</li><li>ä¹‹åT1å†æ¬¡æŸ¥è¯¢æ—¶ï¼Œåœ¨æŸ¥è¯¢ç»“æœä¸­å°±å¯ä»¥å‘ç°è¿™æ¡è®°å½•äº†ã€‚</li></ul><p>å‚è€ƒï¼š</p><ul><li><a href="https://zhuanlan.zhihu.com/p/148035779" target="_blank" rel="noopener noreferrer">æˆ‘ä»¥ä¸ºæˆ‘å¯¹Mysqläº‹åŠ¡å¾ˆç†Ÿï¼Œç›´åˆ°æˆ‘é‡åˆ°äº†é˜¿é‡Œé¢è¯•å®˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/117476959" target="_blank" rel="noopener noreferrer">MySQLäº‹åŠ¡éš”ç¦»çº§åˆ«å’Œå®ç°åŸç†(çœ‹è¿™ä¸€ç¯‡æ–‡ç« å°±å¤Ÿäº†ï¼)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/166158027" target="_blank" rel="noopener noreferrer">é¢è¯•å®˜:è°ˆè°ˆä½ å¯¹mysqläº‹åŠ¡çš„è®¤è¯†?<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li>[MySQL èŠèŠMySQLé”æœºåˆ¶åŠäº‹åŠ¡](</li></ul><h1 id="mysqlé”æœºåˆ¶" tabindex="-1"><a class="header-anchor" href="#mysqlé”æœºåˆ¶" aria-hidden="true">#</a> MySQLé”æœºåˆ¶</h1><p>æœ¬ç¯‡æ–‡ç« æåˆ°çš„é”ï¼Œå¦‚æœæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œé»˜è®¤æŒ‡InnoDBçš„é”ã€‚</p><h2 id="mysqlåŠ é”çš„ç›®çš„æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#mysqlåŠ é”çš„ç›®çš„æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> MySQLåŠ é”çš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æ•°æ®åº“çš„é”æ˜¯ä¸ºäº†è§£å†³äº‹åŠ¡çš„éš”ç¦»æ€§é—®é¢˜ï¼Œä¸ºäº†è®©äº‹åŠ¡ä¹‹é—´ç›¸äº’ä¸å½±å“ï¼Œæ¯ä¸ªäº‹åŠ¡è¿›è¡Œæ“ä½œçš„æ—¶å€™éƒ½ä¼šå¯¹æ•°æ®åŠ ä¸Šä¸€æŠŠç‰¹æœ‰çš„é”ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡åŒæ—¶æ“ä½œæ•°æ®ã€‚</p><h2 id="mysqlçš„é”æ˜¯åŸºäºä»€ä¹ˆå®ç°çš„" tabindex="-1"><a class="header-anchor" href="#mysqlçš„é”æ˜¯åŸºäºä»€ä¹ˆå®ç°çš„" aria-hidden="true">#</a> MySQLçš„é”æ˜¯åŸºäºä»€ä¹ˆå®ç°çš„ï¼Ÿ</h2><p>æ•°æ®åº“é‡Œé¢çš„é”æ˜¯åŸºäºç´¢å¼•å®ç°çš„ï¼Œåœ¨Innodbä¸­æˆ‘ä»¬çš„é”éƒ½æ˜¯ä½œç”¨åœ¨ç´¢å¼•ä¸Šé¢çš„ï¼Œå½“æˆ‘ä»¬çš„SQLå‘½ä¸­ç´¢å¼•æ—¶ï¼Œé‚£ä¹ˆé”ä½çš„å°±æ˜¯å‘½ä¸­æ¡ä»¶å†…çš„ç´¢å¼•èŠ‚ç‚¹(è¡Œé”)ï¼Œå¦‚æœæ²¡æœ‰å‘½ä¸­ç´¢å¼•çš„è¯ï¼Œé‚£æˆ‘ä»¬é”çš„å°±æ˜¯æ•´ä¸ªç´¢å¼•æ ‘(è¡¨é”)ã€‚</p><h2 id="è§£å†³å¹¶å‘äº‹åŠ¡é—®é¢˜çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#è§£å†³å¹¶å‘äº‹åŠ¡é—®é¢˜çš„æ–¹å¼" aria-hidden="true">#</a> è§£å†³å¹¶å‘äº‹åŠ¡é—®é¢˜çš„æ–¹å¼</h2><h3 id="å†™å†™æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#å†™å†™æƒ…å†µ" aria-hidden="true">#</a> å†™å†™æƒ…å†µ</h3><p>ä»»ä½•ä¸€ç§éš”ç¦»çº§åˆ«éƒ½ä¸å…è®¸å‡ºç°è„å†™ç°è±¡ï¼Œæ˜¯é€šè¿‡åŠ é”æ¥å®ç°çš„ã€‚é”ç»“æ„ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„å±æ€§ï¼š</p><ul><li>trxä¿¡æ¯ï¼šè¡¨ç¤ºé”ç»“æ„ä¸å“ªä¸ªäº‹åŠ¡æœ‰å…³ã€‚</li><li>is_waitingï¼šè¡¨ç¤ºå½“å‰äº‹åŠ¡æ˜¯å¦åœ¨ç­‰å¾…ã€‚</li></ul><p>é”è·å–çš„çŠ¶æ€ï¼š</p><ul><li>è·å–é”æˆåŠŸï¼šå†…å­˜ä¸­ç”Ÿæˆäº†å¯¹åº”çš„é”ç»“æ„ï¼Œè€Œä¸”is_waitingçš„å€¼ä¸ºfalseã€‚(é™¤äº†éšå¼é”)</li><li>è·å–é”å¤±è´¥ï¼šå†…å­˜ä¸­ç”Ÿæˆäº†å¯¹åº”çš„é”ç»“æ„ï¼Œè€Œä¸”is_waitingçš„å€¼ä¸ºtrueï¼Œäº‹åŠ¡éœ€è¦ç­‰å¾…ã€‚</li><li>ä¸åŠ é”ï¼šå†…å­˜ä¸­æ²¡æœ‰ç”Ÿæˆé”ç»“æ„ï¼Œå¯ä»¥ç›´æ¥æ“ä½œã€‚(ä¸åŒ…æ‹¬éšå¼é”)</li></ul><p>é‡Šæ”¾é”ï¼šé‡Šæ”¾é”ï¼Œå‘ç°è¿˜æœ‰äº‹åŠ¡ç­‰å¾…é”ï¼Œä¿®æ”¹å¯¹åº”é”ç»“æ„is_waitingçš„å€¼ä¸ºtrueã€‚</p><h3 id="è¯»å†™æˆ–å†™è¯»æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#è¯»å†™æˆ–å†™è¯»æƒ…å†µ" aria-hidden="true">#</a> è¯»å†™æˆ–å†™è¯»æƒ…å†µ</h3><p><strong>æ–¹æ¡ˆ1ï¼šè¯»æ“ä½œä½¿ç”¨MVCCï¼Œå†™æ“ä½œåŠ é”</strong></p><p>MVCCé€šè¿‡ReadViewæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„è®°å½•ç‰ˆæœ¬ï¼Œ<strong>æŸ¥è¯¢è¯­å¥åªèƒ½è¯»åˆ°åœ¨ç”ŸæˆReadViewä¹‹å‰å·²ç»æäº¤çš„äº‹åŠ¡æ‰€åšçš„æ›´æ”¹</strong>ï¼Œåœ¨ç”ŸæˆReadViewä¹‹å‰æœªæäº¤æˆ–è€…ä¹‹åæ‰å¼€å¯çš„äº‹åŠ¡æ‰€åšçš„ä¿®æ”¹æ“ä½œæ˜¯çœ‹ä¸åˆ°çš„ã€‚</p><p>å†™æ“ä½œé’ˆå¯¹æœ€æ–°ç‰ˆæœ¬çš„è®°å½•ï¼Œè¯»è®°å½•çš„å†å²ç‰ˆæœ¬å’Œæ”¹åŠ¨è®°å½•çš„æœ€æ–°ç‰ˆæœ¬æ˜¯ä¸å†²çªçš„ã€‚</p><p>æ–¹æ¡ˆ2ï¼šè¯»å†™æ“ä½œéƒ½åŠ é”</p><h3 id="ä¸€è‡´æ€§è¯»" tabindex="-1"><a class="header-anchor" href="#ä¸€è‡´æ€§è¯»" aria-hidden="true">#</a> ä¸€è‡´æ€§è¯»</h3><p>äº‹åŠ¡åˆ©ç”¨MVCCæ–¹å¼ï¼Œè¯»å†™æ“ä½œä¸å†²çªç§°ä¹‹ä¸ºä¸€è‡´æ€§è¯»ã€‚</p><p>ä¸€è‡´æ€§è¯»å¹¶ä¸ä¼šå¯¹è¡¨ä¸­çš„ä»»ä½•è®°å½•è¿›è¡ŒåŠ é”ï¼Œå…¶ä»–äº‹åŠ¡å¯ä»¥è‡ªç”±å¯¹è¡¨ä¸­çš„è®°å½•è¿›è¡Œæ”¹åŠ¨ã€‚</p><h3 id="é”å®šè¯»" tabindex="-1"><a class="header-anchor" href="#é”å®šè¯»" aria-hidden="true">#</a> é”å®šè¯»</h3><p>å¯¹è®°å½•åŠ Sé”ï¼š<code>SELECT â€¦â€¦ LOCK IN SHARE MODE</code></p><p>å¯¹è®°å½•åŠ Xé”ï¼š<code>SELECT â€¦â€¦ FOR UPDATE</code></p><h3 id="å†™æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#å†™æ“ä½œ" aria-hidden="true">#</a> å†™æ“ä½œ</h3><h4 id="delete" tabindex="-1"><a class="header-anchor" href="#delete" aria-hidden="true">#</a> DELETE</h4><ol><li>å…ˆåœ¨B+æ ‘ä¸­å®šä½åˆ°è®°å½•ï¼Œç„¶åè·å–Xé”ï¼Œæœ€åæ‰§è¡Œ delete mark æ“ä½œ(æ·»åŠ åˆ é™¤æ ‡è®°)</li></ol><h4 id="update" tabindex="-1"><a class="header-anchor" href="#update" aria-hidden="true">#</a> UPDATE</h4><ul><li><strong>æœªä¿®æ”¹ä¸»é”®å€¼ï¼Œå¹¶ä¸”è¢«æ›´æ–°çš„åˆ—æ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´æœªæ”¹å˜</strong>ï¼šå®šä½åˆ°B+æ ‘çš„è®°å½•ä½ç½®ï¼Œè·å–Xé”ï¼Œä¿®æ”¹å€¼ã€‚</li><li><strong>æœªä¿®æ”¹ä¸»é”®å€¼ï¼Œå¹¶ä¸”è¢«æ›´æ–°çš„åˆ—è‡³å°‘æœ‰ä¸€ä¸ªæ‰€å ç”¨çš„å­˜å‚¨ç©ºé—´æ”¹å˜</strong>ï¼šå®šä½åˆ°B+æ ‘çš„è®°å½•ä½ç½®ï¼Œè·å–Xé”ï¼Œå½»åº•åˆ é™¤è®°å½•(è€Œä¸æ˜¯delete mark)ï¼Œç„¶åå†æ–°å¢è®°å½•ã€‚</li><li><strong>ä¿®æ”¹è®°å½•çš„é”®å€¼</strong>ï¼šå®šä½åˆ°B+æ ‘çš„è®°å½•ä½ç½®ï¼Œè·å–Xé”ï¼Œæ‰§è¡ŒDELETEæ“ä½œï¼Œç„¶åå†æ‰§è¡ŒINSERTæ“ä½œã€‚</li></ul><h4 id="insert" tabindex="-1"><a class="header-anchor" href="#insert" aria-hidden="true">#</a> INSERT</h4><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ–°æ’å…¥è®°å½•å—éšå¼é”ä¿æŠ¤ï¼Œä¸ç”Ÿæˆå¯¹åº”çš„é”ç»“æ„ã€‚</p><h2 id="é”çš„å†…å­˜ç»“æ„" tabindex="-1"><a class="header-anchor" href="#é”çš„å†…å­˜ç»“æ„" aria-hidden="true">#</a> é”çš„å†…å­˜ç»“æ„</h2><h3 id="åŸºæœ¬ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬ä»‹ç»" aria-hidden="true">#</a> åŸºæœ¬ä»‹ç»</h3><p>â€œé”â€æœ¬è´¨ä¸Šæ˜¯å†…å­˜ä¸­çš„ç»“æ„ï¼Œåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰æ˜¯æ²¡æœ‰é”çš„(ä¹Ÿå°±æ˜¯è¯´ä¸€å¼€å§‹æ˜¯æ²¡æœ‰é”ç»“æ„ä¸è®°å½•è¿›è¡Œå…³è”çš„)ã€‚</p><p>å½“ä¸€ä¸ªäº‹åŠ¡ç›¸å¯¹è¿™æ¡è®°å½•è¿›è¡Œæ”¹åŠ¨æ—¶ï¼Œé¦–å…ˆä¼šçœ‹å†…å­˜ä¸­æœ‰æ²¡æœ‰ä¸è¿™æ¡è®°å½•ç›¸å…³è”çš„é”ç»“æ„ï¼›å¦‚æœæ²¡æœ‰ï¼Œå°±åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªé”ç»“æ„ä¸è®°å½•ç›¸å…³è”ã€‚</p><p>é”ç»“æ„æœ‰å¾ˆå¤šä¿¡æ¯ï¼Œ<strong>æ¯”è¾ƒé‡è¦çš„å±æ€§å¦‚ä¸‹</strong>ï¼š</p><ul><li><code>trx</code>ä¿¡æ¯ï¼šè¡¨ç¤ºè¿™ä¸ªé”ç»“æ„ä¸å“ªä¸ªäº‹åŠ¡ç›¸å…³è”ã€‚</li><li><code>is_waiting</code>ï¼šè¡¨ç¤ºå½“å‰äº‹åŠ¡æ˜¯å¦åœ¨ç­‰å¾…ã€‚</li><li><code>type</code>ï¼šè¡¨ç¤ºé”çš„ç±»å‹ã€‚</li></ul><h3 id="é”ç»“æ„çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#é”ç»“æ„çš„å˜åŒ–" aria-hidden="true">#</a> <strong>é”ç»“æ„çš„å˜åŒ–ï¼š</strong></h3><ol><li>äº‹åŠ¡T1ä¿®æ”¹è®°å½•å‰ï¼Œç”Ÿæˆé”ç»“æ„(å› ä¸ºä¹‹å‰æ²¡æœ‰åˆ«çš„äº‹åŠ¡ä¸ºè¿™æ¡è®°å½•åŠ é”)ï¼š<code>trx:T1 is_waiting:false</code>ã€‚ç§°è¿™ä¸ªæ“ä½œä¸ºåŠ é”æˆåŠŸã€‚</li><li>äº‹åŠ¡T1æäº¤å‰ï¼Œäº‹åŠ¡T2ä¹Ÿæƒ³ä¿®æ”¹è¿™æ¡è®°å½•ã€‚åœ¨å†…å­˜ä¸­å‘ç°æœ‰ä¸€ä¸ªé”è®°å½•ï¼ŒT2ä¹Ÿç”Ÿæˆä¸€ä¸ªæ‰€è®°å½•<code>trx:T2 is_waiting:true</code>ï¼Œè¡¨ç¤ºéœ€è¦ç­‰å¾…ï¼Œç§°ä¸ºåŠ é”å¤±è´¥ã€‚</li><li>äº‹åŠ¡T1æäº¤åï¼Œå°±ä¼šæŠŠå®ƒç”Ÿæˆçš„é”æœºæ„é‡Šæ”¾æ‰ï¼Œç„¶åæ£€æµ‹ä¸€æ¬¡æ˜¯å¦è¿˜æœ‰ä¸è¿™æ¡è®°å½•ç›¸å…³è”çš„é”ç»“æ„ã€‚å‘ç°äº‹åŠ¡T2åœ¨ç­‰å¾…è·å–é”ï¼Œæ‰€ä»¥æŠŠäº‹åŠ¡T2çš„ <code>is_waiting:true</code> æ”¹ä¸º <code>false</code> ï¼Œç„¶åæŠŠè¯¥äº‹ç‰©å¯¹åº”çš„çº¿ç¨‹å”¤é†’ï¼Œè®©T2ç»§ç»­æ‰§è¡Œã€‚æ­¤æ—¶T2å°±è·å–åˆ°é”äº†ã€‚</li></ol><h3 id="å“ªäº›è®°å½•å¯ä»¥æ”¾åœ¨ä¸€ä¸ªé”ç»“æ„ä¸­" tabindex="-1"><a class="header-anchor" href="#å“ªäº›è®°å½•å¯ä»¥æ”¾åœ¨ä¸€ä¸ªé”ç»“æ„ä¸­" aria-hidden="true">#</a> å“ªäº›è®°å½•å¯ä»¥æ”¾åœ¨ä¸€ä¸ªé”ç»“æ„ä¸­ï¼Ÿ</h3><p>ä¸Šæ–‡æåˆ°ï¼šå¯¹ä¸€æ¡è®°å½•åŠ é”çš„æœ¬è´¨æ˜¯åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªé”ç»“æ„ä¸ä¹‹å…³è”(éšå¼é”é™¤å¤–)ã€‚</p><p>ä½†æ˜¯ä¸€ä¸ªäº‹åŠ¡å¯¹å¤šæ¡è®°å½•åŠ é”ï¼Œæ˜¯ä¸æ˜¯è¦åˆ›å»ºå¤šä¸ªé”ç»“æ„ï¼Ÿå¦‚æœåŠ é”è®°å½•å¤ªå¤šï¼Œå²‚ä¸æ˜¯é€ æˆäº†å†…å­˜å ç”¨å¤ªå¤§ã€‚</p><p>æ‰€ä»¥ï¼Œå¦‚æœç¬¦åˆä»¥ä¸‹æ¡ä»¶ï¼Œè¿™äº›è®°å½•çš„é”å¯ä»¥æ”¾åˆ°ä¸€ä¸ªé”ç»“æ„ä¸­ï¼š</p><ol><li>åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­è¿›è¡ŒåŠ é”æ“ä½œ</li><li>è¢«åŠ é”çš„è®°å½•åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­</li><li>åŠ é”çš„ç±»å‹æ˜¯ä¸€æ ·çš„</li><li>ç­‰å¾…çŠ¶æ€æ˜¯ä¸€æ ·çš„</li></ol><h3 id="é”ç»“æ„è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#é”ç»“æ„è¯¦è§£" aria-hidden="true">#</a> é”ç»“æ„è¯¦è§£</h3><img src="/assets/202203022325296-6760ef84.jpg" alt="271a340123d72197fd99faa32c1190b" style="zoom:67%;"><ul><li>é”æ‰€åœ¨äº‹åŠ¡ä¿¡æ¯å’Œç´¢å¼•ä¿¡æ¯ åœ¨å†…å­˜ç»“æ„ä¸­æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸ä¼šå ç”¨å¤ªå¤§ç©ºé—´</li><li>è¡¨é”/è¡Œé”ä¿¡æ¯ï¼š <ul><li>è¡¨é”è®°è½½ç€è¿™æ˜¯å¯¹å“ªä¸ªè¡¨åŠ çš„é”</li><li>è¡Œé”è®°è½½ä¸‹é¢3ä¸ªé‡è¦ä¿¡æ¯ï¼š <ul><li>Space IDï¼šè®°å½•æ‰€åœ¨çš„è¡¨ç©ºé—´</li><li>Page Numberï¼šè®°å½•æ‰€åœ¨çš„é¡µå·</li><li>n_bitsï¼šå¯¹äºè¡Œé”æ¥è¯´ï¼Œä¸€æ¡è®°å½•å¯¹ç”¨ä¸€ä¸ªæ¯”ç‰¹ã€‚ç”¨ä»¥åŒºåˆ†å“ªäº›è®°å½•è¢«åŠ äº†è¡Œé”ï¼Œn_bitsä¸ºäº†è®©é¡µé¢æ’å…¥æ–°è®°å½•æ—¶ä¸è‡³äºé‡æ–°åˆ†é…é”ç»“æ„ï¼Œä¸€èˆ¬æ¥è¯´ä¼šæ¯”é¡µé¢è®°å½•å¤šä¸€äº›ã€‚</li></ul></li></ul></li><li>type_modeï¼šæ˜¯ä¸€ä¸ª32æ¯”ç‰¹çš„æ•°ï¼Œåˆ†ä¸º lock_modeã€lock_typeã€rec_lock_type ä¸‰éƒ¨åˆ†ã€‚<img src="/assets/202203022332392-fc7c6bbd.jpg" alt="91bb6399110c93e44260472028a69fc" loading="lazy"><ul><li>lock_mode(é”æ¨¡å¼)å ç”¨4æ¯”ç‰¹ï¼Œå…·ä½“å¦‚ä¸‹ï¼š <ul><li>LOCK_IS(åè¿›åˆ¶0)</li><li>LOCK_IX(åè¿›åˆ¶1)</li><li>LOCK_S(åè¿›åˆ¶2)</li><li>LOCK_X(åè¿›åˆ¶3)</li><li>LOCK_AUTO_INC(åè¿›åˆ¶4)</li></ul></li><li>lock_type(é”ç±»å‹)å 5~8ä½ï¼Œç°é˜¶æ®µåªç”¨äº†ç¬¬5ä½å’Œç¬¬6ä½ <ul><li>LOCK_TABLE(åè¿›åˆ¶16)ï¼šç¬¬5ä½ä¸º1ï¼Œè¡¨çº§é”</li><li>LOCK_REC(åè¿›åˆ¶32)ï¼šç¬¬6ä½ä¸º1ï¼Œè¡Œçº§é”</li></ul></li><li>rec_lock_type(è¡Œé”çš„å…·ä½“ç±»å‹)ï¼Œåªæœ‰åœ¨lock_typeå€¼ä¸ºLOCK_RECæ—¶ï¼Œæ‰ä¼šç»†åˆ†æ›´å¤šçš„ç±»å‹ <ul><li>LOCK_ORDINARY(åè¿›åˆ¶0)ï¼šè¡¨ç¤ºnext-keyé”(ä¸´é”®é”)</li><li>LOCK_GAP(åè¿›åˆ¶512)ï¼šç¬¬10æ¯”ç‰¹ä½ä¸º1ï¼Œè¡¨ç¤ºgap(é—´éš™)é”</li><li>LOCK_REC_NOT_GAP(åè¿›åˆ¶1024)ï¼šç¬¬11æ¯”ç‰¹ä½ä¸º1ï¼Œè¡¨ç¤ºè®°å½•é”</li><li>LOCK_INSERT_INTENTION(åè¿›åˆ¶2048)ï¼šç¬¬12æ¯”ç‰¹ä½ä¸º1ï¼Œè¡¨ç¤ºæ’å…¥æ„å‘é”</li><li>å…¶ä»–ç±»å‹</li><li>LOCK_WAIT(åè¿›åˆ¶256)ï¼šç¬¬9æ¯”ç‰¹ä½ä¸º1ï¼Œis_waitingè¡¨ç¤ºä¸ºtrueã€‚</li></ul></li><li>ä¸€å †æ¯”ç‰¹ä½ï¼šæ¯ä¸ªæ¯”ç‰¹ä½ï¼Œè¡¨ç¤ºé”ç»“æ„å¯¹åº”ä¸€æ¡è®°å½•ã€‚</li></ul></li></ul><h2 id="é”çš„åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#é”çš„åˆ†ç±»" aria-hidden="true">#</a> é”çš„åˆ†ç±»</h2><p>åŸºäºé”çš„å±æ€§åˆ†ç±»ï¼šå…±äº«é”ã€æ’ä»–é”ã€‚</p><p>åŸºäºé”çš„ç²’åº¦åˆ†ç±»ï¼šè¡¨é”ã€è¡Œé”ã€è®°å½•é”ã€é—´éš™é”ã€ä¸´é”®é”ã€è‡ªå¢é”ã€‚</p><p>åŸºäºé”çš„çŠ¶æ€åˆ†ç±»ï¼šæ„å‘å…±äº«é”ã€æ„å‘æ’å®ƒé”ã€‚</p><p>åŸºäºåŠ é”çš„æ€åº¦åˆ†ç±»ï¼šæ‚²è§‚é”ã€ä¹è§‚é”ã€‚</p><h2 id="å…±äº«é”å’Œæ’å®ƒé”-è¯»å†™é”" tabindex="-1"><a class="header-anchor" href="#å…±äº«é”å’Œæ’å®ƒé”-è¯»å†™é”" aria-hidden="true">#</a> å…±äº«é”å’Œæ’å®ƒé”(è¯»å†™é”)</h2><h3 id="å…±äº«é”" tabindex="-1"><a class="header-anchor" href="#å…±äº«é”" aria-hidden="true">#</a> å…±äº«é”</h3><p><strong>å…±äº«é”</strong>åˆç§°è¯»é”ï¼Œç®€ç§°Sé”ï¼›å½“ä¸€ä¸ªäº‹åŠ¡ä¸ºæ•°æ®åŠ ä¸Šè¯»é”ä¹‹åï¼Œ<strong>å…¶ä»–äº‹åŠ¡åªèƒ½å¯¹è¯¥æ•°æ®åŠ è¯»é”ï¼Œè€Œä¸èƒ½å¯¹æ•°æ®åŠ å†™é”</strong>ï¼Œç›´åˆ°æ‰€æœ‰çš„è¯»é”é‡Šæ”¾ä¹‹åå…¶ä»–äº‹åŠ¡æ‰èƒ½å¯¹å…¶è¿›è¡ŒåŠ æŒå†™é”ã€‚</p><p>å…±äº«é”çš„ç‰¹æ€§ä¸»è¦æ˜¯ä¸ºäº†æ”¯æŒå¹¶å‘çš„è¯»å–æ•°æ®ï¼Œè¯»å–æ•°æ®çš„æ—¶å€™ä¸æ”¯æŒä¿®æ”¹ï¼Œé¿å…å‡ºç°é‡å¤è¯»çš„é—®é¢˜ã€‚</p><figure><img src="/assets/202111051714836-8fd770c1.png" alt="å…±äº«é”" tabindex="0" loading="lazy"><figcaption>å…±äº«é”</figcaption></figure><h3 id="æ’å®ƒé”" tabindex="-1"><a class="header-anchor" href="#æ’å®ƒé”" aria-hidden="true">#</a> æ’å®ƒé”</h3><p>æ’ä»–é”åˆç§°å†™é”ï¼Œç®€ç§°Xé”ï¼›å½“ä¸€ä¸ªäº‹åŠ¡ä¸ºæ•°æ®åŠ ä¸Šå†™é”æ—¶ï¼Œå…¶ä»–è¯·æ±‚å°†ä¸èƒ½å†ä¸ºæ•°æ®åŠ ä»»ä½•é”ï¼Œç›´åˆ°è¯¥é”é‡Šæ”¾ä¹‹åï¼Œå…¶ä»–äº‹åŠ¡æ‰èƒ½å¯¹æ•°æ®è¿›è¡ŒåŠ é”ã€‚</p><p>æ’ä»–é”çš„ç›®çš„æ˜¯åœ¨æ•°æ®ä¿®æ”¹æ—¶å€™ï¼Œä¸å…è®¸å…¶ä»–äººåŒæ—¶ä¿®æ”¹ï¼Œä¹Ÿä¸å…è®¸å…¶ä»–äººè¯»å–ã€‚é¿å…äº†å‡ºç°è„æ•°æ®å’Œè„è¯»çš„é—®é¢˜ã€‚</p><figure><img src="/assets/202111051729003-89d74efb.png" alt="æ’å®ƒé”" tabindex="0" loading="lazy"><figcaption>æ’å®ƒé”</figcaption></figure><h2 id="è¯»å†™æ„å‘é”" tabindex="-1"><a class="header-anchor" href="#è¯»å†™æ„å‘é”" aria-hidden="true">#</a> è¯»å†™æ„å‘é”</h2><p>æ„å‘é”ä¹Ÿæ˜¯è¡¨çº§é”ï¼Œä¹Ÿå¯åˆ†ä¸ºè¯»æ„å‘é”(IS é”)å’Œå†™æ„å‘é”(IX é”)ã€‚åˆ†ä¸ºå¦‚ä¸‹æƒ…å†µï¼š</p><ul><li>æŸæ¡è®°å½•åŠ Sé”æ—¶ï¼Œéœ€è¦å…ˆåœ¨è¡¨çº§åˆ«åŠ ISé”ã€‚</li><li>æŸæ¡è®°å½•åŠ Xé”æ—¶ï¼Œéœ€è¦å…ˆåœ¨è¡¨çº§åˆ«åŠ IXé”ã€‚</li><li>åŠ è¡¨çº§åˆ«Sé”æ—¶ï¼Œæ­¤è¡¨ä¸èƒ½åŠ æœ‰IXé”ã€‚</li><li>åŠ è¡¨çº§åˆ«Xé”æ—¶ï¼Œæ­¤è¡¨ä¸èƒ½åŠ æœ‰ISã€IXé”ã€‚</li></ul><p>æ„å‘é”æ˜¯ä¸ºäº†ï¼Œåœ¨åŠ è¡¨çº§åˆ«Sã€Xé”æ—¶ï¼Œå¿«é€Ÿåˆ¤æ–­è¡¨ä¸­è®°å½•æ˜¯å¦è¢«ä¸Šé”ï¼Œé¿å…éå†è¯¥è¡¨çš„æ‰€æœ‰è®°å½•ã€‚</p><h2 id="è¡¨é”" tabindex="-1"><a class="header-anchor" href="#è¡¨é”" aria-hidden="true">#</a> è¡¨é”</h2><h3 id="ä»€ä¹ˆæ˜¯è¡¨é”" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è¡¨é”" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯è¡¨é”ï¼Ÿ</h3><p><strong>è¡¨é”</strong>æ˜¯æŒ‡ä¸Šé”çš„æ—¶å€™é”ä½çš„æ˜¯æ•´ä¸ªè¡¨ï¼Œå½“ä¸‹ä¸€ä¸ªäº‹åŠ¡è®¿é—®è¯¥è¡¨çš„æ—¶å€™ï¼Œå¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡é‡Šæ”¾äº†é”æ‰èƒ½è¿›è¡Œå¯¹è¡¨è¿›è¡Œè®¿é—®ï¼›</p><p>è¡¨é”ç”± MySQL Server å®ç°ï¼Œä¸€èˆ¬åœ¨æ‰§è¡Œ DDL è¯­å¥æ—¶ä¼šå¯¹æ•´ä¸ªè¡¨è¿›è¡ŒåŠ é”ï¼Œæ¯”å¦‚è¯´ ALTER TABLE ç­‰æ“ä½œã€‚</p><p>è¡¨é”çš„ç‰¹ç‚¹ï¼š <strong>ç²’åº¦å¤§ï¼ŒåŠ é”ç®€å•ï¼Œå®¹æ˜“å†²çª</strong>ã€‚</p><h3 id="æ˜¾å¼åŠ è¡¨é”" tabindex="-1"><a class="header-anchor" href="#æ˜¾å¼åŠ è¡¨é”" aria-hidden="true">#</a> æ˜¾å¼åŠ è¡¨é”</h3><p>åœ¨æ‰§è¡Œ SQL è¯­å¥æ—¶ï¼Œä¹Ÿå¯ä»¥æ˜ç¡®æŒ‡å®šå¯¹æŸä¸ªè¡¨è¿›è¡ŒåŠ é”ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">#</span>
åˆ†ä¸ºè¯»é”å’Œå†™é”
<span class="token keyword">lock</span> <span class="token keyword">table</span> <span class="token keyword">user</span> <span class="token keyword">read</span><span class="token punctuation">(</span><span class="token keyword">write</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">#</span>
æˆåŠŸ
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token keyword">user</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">#</span>
å¤±è´¥
ï¼Œæœªæå‰è·å–è¯¥ roleçš„è¯»è¡¨é”
<span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> role
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">#</span>
å¤±è´¥
ï¼Œæœªæå‰è·å¾—<span class="token keyword">user</span>çš„å†™è¡¨é”
<span class="token keyword">update</span> <span class="token keyword">user</span>
<span class="token keyword">set</span> name <span class="token operator">=</span> <span class="token string">&#39;Tom&#39;</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
<span class="token comment">#</span>
æ˜¾ç¤ºé‡Šæ”¾è¡¨é”
<span class="token keyword">unlock</span> <span class="token keyword">tables</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¡¨é”ä½¿ç”¨çš„æ˜¯ä¸€æ¬¡æ€§é”æŠ€æœ¯ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¼šè¯å¼€å§‹çš„åœ°æ–¹ä½¿ç”¨ lock å‘½ä»¤å°†åç»­éœ€è¦ç”¨åˆ°çš„è¡¨éƒ½åŠ ä¸Šé”ï¼Œåœ¨è¡¨é‡Šæ”¾å‰ï¼Œåªèƒ½è®¿é—®è¿™äº›åŠ é”çš„è¡¨ï¼Œä¸èƒ½è®¿é—®å…¶ä»–è¡¨ï¼Œç›´åˆ°æœ€åé€šè¿‡ unlock tables é‡Šæ”¾æ‰€æœ‰è¡¨é”ã€‚</p><h3 id="ä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¡¨é”" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¡¨é”" aria-hidden="true">#</a> <strong>ä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¡¨é”</strong>ï¼Ÿ</h3><ul><li>ä½¿ç”¨ <code>unlock tables</code> æ˜¾ç¤ºé‡Šæ”¾é”</li><li>ä¼šè¯æŒæœ‰å…¶ä»–è¡¨é”æ—¶æ‰§è¡Œ <code>lock table</code> è¯­å¥ä¼šé‡Šæ”¾ä¼šè¯ä¹‹å‰æŒæœ‰çš„é”</li><li>ä¼šè¯æŒæœ‰å…¶ä»–è¡¨é”æ—¶æ‰§è¡Œ <code>start transaction</code> æˆ–è€… <code>begin</code> å¼€å¯äº‹åŠ¡æ—¶ï¼Œä¹Ÿä¼šé‡Šæ”¾ä¹‹å‰æŒæœ‰çš„é”ã€‚</li></ul><h3 id="è¡¨çº§åˆ«çš„sé”ã€xé”" tabindex="-1"><a class="header-anchor" href="#è¡¨çº§åˆ«çš„sé”ã€xé”" aria-hidden="true">#</a> è¡¨çº§åˆ«çš„Sé”ã€Xé”</h3><p>è¡¨çº§åˆ«çš„é”ä¸€èˆ¬ç”¨åœ¨æ‰§è¡Œ <code>ALTER TABLE</code> æˆ– <code>DROP TABLE</code>çš„DDLè¯­å¥æ—¶ï¼Œç„¶åå†æ‰§è¡Œå¢åˆ æ”¹æŸ¥æ—¶ä¼šé˜»å¡ã€‚</p><h3 id="è¡¨çº§åˆ«çš„isé”ã€ixé”" tabindex="-1"><a class="header-anchor" href="#è¡¨çº§åˆ«çš„isé”ã€ixé”" aria-hidden="true">#</a> è¡¨çº§åˆ«çš„ISé”ã€IXé”</h3><p>å‚çœ‹ä¸Šè¿°çš„è¯»å†™æ„å‘é”</p><h3 id="è¡¨çº§åˆ«çš„auto-incé”" tabindex="-1"><a class="header-anchor" href="#è¡¨çº§åˆ«çš„auto-incé”" aria-hidden="true">#</a> è¡¨çº§åˆ«çš„AUTO-INCé”</h3><p>AUTO-INC é”åˆå«è‡ªå¢é”(ä¸€èˆ¬ç®€å†™æˆ AI é”)ï¼Œæ˜¯ä¸€ç§è¡¨é”ï¼Œå½“è¡¨ä¸­æœ‰è‡ªå¢åˆ—(AUTO_INCREMENT)æ—¶å‡ºç°ã€‚</p><p>ä¸»è¦å®ç°æ–¹å¼æœ‰ä¸¤ç§ï¼š</p><ol><li><strong>é‡‡ç”¨AUTO-INCé”</strong>ã€‚æ‰§è¡Œæ’å…¥è¯­å¥æ—¶ï¼ŒåŠ ä¸€ä¸ªè¡¨çº§åˆ«çš„AUTO-INCé”ï¼Œç„¶åä¸ºæ¯æ¡å¾…æ’å…¥è®°å½•çš„AUTO_INCREMENTåˆ—åˆ†é…é€’å¢çš„å€¼ï¼Œæ’å…¥æ‰§è¡Œå®Œæ¯•ï¼Œé”é‡Šæ”¾ã€‚</li><li><strong>é‡‡ç”¨ä¸€ç§è½»é‡çº§çš„é”</strong>(mutexï¼ŒMySQL ä» 5.1.22 ç‰ˆæœ¬å¼€å§‹å¼•å…¥)ã€‚ç”Ÿæˆè‡ªå¢å€¼åé‡Šæ”¾ï¼Œè€Œä¸æ˜¯è¦ç­‰æ’å…¥å®Œæˆæ‰é‡Šæ”¾é”ã€‚</li></ol><p><code>innodb_autoinc_lock_mode</code>æ¥æ§åˆ¶ä½¿ç”¨å“ªç§é”ï¼š</p><ul><li>å€¼ä¸º0ï¼Œä¸€å¾‹ä½¿ç”¨AUTO-INCé”</li><li>å€¼ä¸º1ï¼Œæ’å…¥æ•°é‡ç¡®å®šä½¿ç”¨è½»é‡çº§é”ï¼Œä¸ç¡®å®šä½¿ç”¨AUTO-INCé”</li><li>å€¼ä¸º2ï¼Œä¸€å¾‹ä½¿ç”¨è½»é‡çº§é”(ä¸åŒäº‹åŠ¡è‡ªå¢åˆ—å€¼äº¤å‰ï¼Œä¸»ä»å¤åˆ¶ä¸å®‰å…¨)</li></ul><p><strong>æ³¨æ„äº‹é¡¹ï¼š</strong></p><p>å½“æ’å…¥è¡¨ä¸­æœ‰è‡ªå¢åˆ—æ—¶ï¼Œæ•°æ®åº“éœ€è¦è‡ªåŠ¨ç”Ÿæˆè‡ªå¢å€¼ï¼Œå®ƒä¼š<strong>å…ˆä¸ºè¯¥è¡¨åŠ  AUTOINC è¡¨é”ï¼Œé˜»å¡å…¶ä»–äº‹åŠ¡çš„æ’å…¥æ“ä½œï¼Œè¿™æ ·ä¿è¯ç”Ÿæˆçš„è‡ªå¢å€¼è‚¯å®šæ˜¯å”¯ä¸€çš„</strong>ã€‚</p><p>AUTOINC é”å…·æœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</p><ul><li>AUTO_INC é”äº’ä¸å…¼å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´åŒä¸€å¼ è¡¨åŒæ—¶åªå…è®¸æœ‰ä¸€ä¸ªè‡ªå¢é”ï¼›</li><li>è‡ªå¢å€¼ä¸€æ—¦åˆ†é…äº†å°±ä¼š +1ï¼Œå¦‚æœ<strong>äº‹åŠ¡å›æ»šï¼Œè‡ªå¢å€¼ä¹Ÿä¸ä¼šå‡å›å»</strong>ï¼Œæ‰€ä»¥è‡ªå¢å€¼å¯èƒ½ä¼šå‡ºç°ä¸­æ–­çš„æƒ…å†µã€‚</li></ul><h2 id="è¡Œé”" tabindex="-1"><a class="header-anchor" href="#è¡Œé”" aria-hidden="true">#</a> è¡Œé”</h2><h3 id="ä»€ä¹ˆæ˜¯è¡Œé”" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯è¡Œé”" aria-hidden="true">#</a> ä»€ä¹ˆæ˜¯è¡Œé”ï¼Ÿ</h3><p>è¡Œé”æ˜¯æŒ‡ä¸Šé”çš„æ—¶å€™é”ä½çš„æ˜¯è¡¨çš„æŸä¸€è¡Œæˆ–å¤šè¡Œè®°å½•ï¼Œå…¶ä»–äº‹åŠ¡è®¿é—®åŒä¸€å¼ è¡¨æ—¶ï¼Œåªæœ‰è¢«é”ä½çš„è®°å½•ä¸èƒ½è®¿é—®ï¼Œå…¶ä»–çš„è®°å½•å¯æ­£å¸¸è®¿é—®ï¼›</p><p>ä¸åŒå­˜å‚¨å¼•æ“çš„è¡Œé”å®ç°ä¸åŒã€‚</p><p>ç‰¹ç‚¹ï¼š<strong>ç²’åº¦å°ï¼ŒåŠ é”æ¯”è¡¨é”éº»çƒ¦ï¼Œä¸å®¹æ˜“å†²çªï¼Œç›¸æ¯”è¡¨é”æ”¯æŒçš„å¹¶å‘è¦é«˜</strong>ï¼›</p><h3 id="è¡Œé”çš„åŸç†" tabindex="-1"><a class="header-anchor" href="#è¡Œé”çš„åŸç†" aria-hidden="true">#</a> è¡Œé”çš„åŸç†</h3><p>è¡Œé”çš„åŸç†å’Œç´¢å¼•æœ‰å…³ã€‚</p><p>InnoDB æ˜¯èšç°‡ç´¢å¼•ï¼Œä¹Ÿå°±æ˜¯ B+æ ‘çš„å¶èŠ‚ç‚¹æ—¢å­˜å‚¨äº†ä¸»é”®ç´¢å¼•ä¹Ÿå­˜å‚¨äº†æ•°æ®è¡Œã€‚è€Œ InnoDB çš„äºŒçº§ç´¢å¼•çš„å¶èŠ‚ç‚¹å­˜å‚¨çš„åˆ™æ˜¯ä¸»é”®å€¼ï¼Œæ‰€ä»¥é€šè¿‡äºŒçº§ç´¢å¼•æŸ¥è¯¢æ•°æ®æ—¶ï¼Œè¿˜éœ€è¦æ‹¿å¯¹åº”çš„ä¸»é”®å»èšç°‡ç´¢å¼•ä¸­å†æ¬¡è¿›è¡ŒæŸ¥è¯¢ã€‚</p><p><strong>å•è¡Œè®°å½•è¡Œé”åŸç†</strong></p><p>ä¸‹é¢ä»¥ä¸¤æ¡ SQL çš„æ‰§è¡Œä¸ºä¾‹ï¼Œè®²è§£ä¸€ä¸‹ InnoDB å¯¹äºå•è¡Œæ•°æ®çš„åŠ é”åŸç†ã€‚</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token comment">#</span>
èšç°‡ç´¢å¼•æ‰§è¡Œä¿®æ”¹
<span class="token keyword">update</span> <span class="token keyword">user</span>
<span class="token keyword">set</span> age <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">49</span><span class="token punctuation">;</span>
<span class="token comment">#</span>
äºŒçº§ç´¢å¼•æ‰§è¡Œä¿®æ”¹
<span class="token keyword">update</span> <span class="token keyword">user</span>
<span class="token keyword">set</span> age <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">where</span> name <span class="token operator">=</span> <span class="token string">&#39;Tom&#39;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç¬¬ä¸€æ¡ SQL ä½¿ç”¨ä¸»é”®ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œåˆ™åªéœ€è¦åœ¨ id = 49 è¿™ä¸ªä¸»é”®ç´¢å¼•ä¸ŠåŠ ä¸Šå†™é”ï¼›</p><p>ç¬¬äºŒæ¡ SQL åˆ™ä½¿ç”¨äºŒçº§ç´¢å¼•æ¥æŸ¥è¯¢ï¼Œåˆ™é¦–å…ˆåœ¨ name = Tom è¿™ä¸ªç´¢å¼•ä¸ŠåŠ å†™é”ï¼Œç„¶åç”±äºä½¿ç”¨ InnoDB äºŒçº§ç´¢å¼•è¿˜éœ€å†æ¬¡æ ¹æ®ä¸»é”®ç´¢å¼•æŸ¥è¯¢ï¼Œæ‰€ä»¥è¿˜éœ€è¦åœ¨ id = 49 è¿™ä¸ªä¸»é”®ç´¢å¼•ä¸ŠåŠ å†™é”ã€‚</p><p><strong>å¤šè¡Œè®°å½•è¡Œé”åŸç†</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">update</span> <span class="token keyword">user</span>
<span class="token keyword">set</span> age <span class="token operator">=</span> <span class="token number">10</span>
<span class="token keyword">where</span> id <span class="token operator">&gt;</span> <span class="token number">49</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>MySQL Server ä¼šæ ¹æ® WHERE æ¡ä»¶è¯»å–ç¬¬ä¸€æ¡æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œç„¶å InnoDB å¼•æ“ä¼šå°†ç¬¬ä¸€æ¡è®°å½•è¿”å›å¹¶åŠ é”ï¼Œæ¥ç€ MySQL Server å‘èµ·æ›´æ–°æ”¹è¡Œè®°å½•çš„ UPDATE è¯·æ±‚ï¼Œæ›´æ–°è¿™æ¡è®°å½•ã€‚ä¸€æ¡è®°å½•æ“ä½œå®Œæˆï¼Œå†è¯»å–ä¸‹ä¸€æ¡è®°å½•ï¼Œç›´è‡³æ²¡æœ‰åŒ¹é…çš„è®°å½•ä¸ºæ­¢ã€‚</p><p>å½“ç„¶è¿™ä¸­é—´è¿˜æœ‰å¾ˆå¤šçš„ä¼˜åŒ–ï¼Œå°±ä¸ç»†ç»†é˜è¿°äº†ã€‚</p><h3 id="è¡Œé”çš„ç±»å‹" tabindex="-1"><a class="header-anchor" href="#è¡Œé”çš„ç±»å‹" aria-hidden="true">#</a> è¡Œé”çš„ç±»å‹</h3><p>æ ¹æ®é”çš„ç²’åº¦å¯ä»¥æŠŠé”ç»†åˆ†ä¸ºè¡¨é”å’Œè¡Œé”ï¼Œè¡Œé”æ ¹æ®åœºæ™¯çš„ä¸åŒåˆå¯ä»¥è¿›ä¸€æ­¥ç»†åˆ†ï¼Œä¾æ¬¡ä¸º Next-Key Lockï¼ŒGap Lock é—´éš™é”ï¼ŒRecord Lock è®°å½•é”å’Œæ’å…¥æ„å‘ GAP é”ã€‚</p><p>ä¸åŒçš„é”é”å®šçš„ä½ç½®æ˜¯ä¸åŒçš„ï¼Œæ¯”å¦‚è¯´è®°å½•é”åªé”ä½å¯¹åº”çš„è®°å½•ï¼Œè€Œé—´éš™é”é”ä½è®°å½•å’Œè®°å½•ä¹‹é—´çš„é—´éš”ï¼ŒNext-Key Lock åˆ™æ‰€å±è®°å½•å’Œè®°å½•ä¹‹å‰çš„é—´éš™ã€‚</p><figure><img src="/assets/202111051714635-0b5b1d26.png" alt="è¡Œé”çš„èŒƒå›´" tabindex="0" loading="lazy"><figcaption>è¡Œé”çš„èŒƒå›´</figcaption></figure><h3 id="è®°å½•é”-record-lock" tabindex="-1"><a class="header-anchor" href="#è®°å½•é”-record-lock" aria-hidden="true">#</a> è®°å½•é”(Record Lock)</h3><p><strong>è®°å½•é”</strong>ï¼šäº‹åŠ¡åœ¨åŠ é”åé”ä½çš„åªæ˜¯è¡¨çš„æŸä¸€æ¡è®°å½•ã€‚(å®˜æ–¹å‘½åLOCK_REC_NOT_GAP)</p><p><strong>å¤§è‡´è§¦å‘æ¡ä»¶ï¼š</strong></p><ul><li>ç²¾å‡†æ¡ä»¶å‘½ä¸­ï¼Œå¹¶ä¸”å‘½ä¸­çš„æ¡ä»¶å­—æ®µæ˜¯å”¯ä¸€ç´¢å¼•ã€‚ <ul><li><strong>ä¾‹å¦‚ï¼š</strong><code>update user_info set name=â€™å¼ ä¸‰â€™ where id=1</code> ï¼Œè¿™é‡Œçš„idæ˜¯å”¯ä¸€ç´¢å¼•ã€‚</li></ul></li><li>å½“ SQL è¯­å¥æ— æ³•ä½¿ç”¨ç´¢å¼•æ—¶ï¼Œä¼šè¿›è¡Œå…¨è¡¨æ‰«æï¼Œè¿™ä¸ªæ—¶å€™ MySQL ä¼šç»™æ•´å¼ è¡¨çš„æ‰€æœ‰æ•°æ®è¡ŒåŠ è®°å½•é”ï¼Œå†ç”± MySQL Server å±‚è¿›è¡Œè¿‡æ»¤ã€‚ä½†æ˜¯ï¼Œåœ¨ MySQL Server å±‚è¿›è¡Œè¿‡æ»¤çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°ä¸æ»¡è¶³ WHERE æ¡ä»¶ï¼Œä¼šé‡Šæ”¾å¯¹åº”è®°å½•çš„é”ã€‚è¿™æ ·åšï¼Œä¿è¯äº†æœ€ååªä¼šæŒæœ‰æ»¡è¶³æ¡ä»¶è®°å½•ä¸Šçš„é”ï¼Œä½†æ˜¯æ¯æ¡è®°å½•çš„åŠ é”æ“ä½œè¿˜æ˜¯ä¸èƒ½çœç•¥çš„ã€‚</li></ul><p>æ‰€ä»¥æ›´æ–°æ“ä½œå¿…é¡»è¦æ ¹æ®ç´¢å¼•è¿›è¡Œæ“ä½œï¼Œæ²¡æœ‰ç´¢å¼•æ—¶ï¼Œä¸ä»…ä¼šæ¶ˆè€—å¤§é‡çš„é”èµ„æºï¼Œå¢åŠ æ•°æ®åº“çš„å¼€é”€ï¼Œè¿˜ä¼šæå¤§çš„é™ä½äº†æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚</p><p><strong>è®°å½•é”çš„ä½œç”¨ï¼š<strong>åŠ äº†è®°å½•é”ä¹‹åæ•°æ®å¯ä»¥</strong>é¿å…æ•°æ®åœ¨æŸ¥è¯¢çš„æ—¶å€™è¢«ä¿®æ”¹çš„é‡å¤è¯»é—®é¢˜</strong>ï¼Œ<strong>ä¹Ÿé¿å…äº†åœ¨ä¿®æ”¹çš„äº‹åŠ¡æœªæäº¤å‰è¢«å…¶ä»–äº‹åŠ¡è¯»å–çš„è„è¯»é—®é¢˜</strong>ã€‚</p><h3 id="é—´éš™é”-gap-lock" tabindex="-1"><a class="header-anchor" href="#é—´éš™é”-gap-lock" aria-hidden="true">#</a> <strong>é—´éš™é”(Gap Lock)</strong></h3><p><strong>é—´éš™é”</strong>ï¼šåœ¨äº‹åŠ¡åŠ é”åå…¶é”ä½çš„æ˜¯è¡¨è®°å½•çš„æŸä¸€ä¸ªåŒºé—´ï¼Œå½“è¡¨çš„ç›¸é‚»IDä¹‹é—´å‡ºç°ç©ºéš™åˆ™ä¼šå½¢æˆä¸€ä¸ªåŒºé—´ï¼Œéµå¾ª<strong>å·¦å¼€å³é—­</strong>åŸåˆ™ã€‚</p><p>æ¯”å¦‚ä¸‹é¢çš„è¡¨é‡Œé¢çš„æ•°æ®ID ä¸º 1,4,5,7,10 ,é‚£ä¹ˆä¼šå½¢æˆä»¥ä¸‹å‡ ä¸ªé—´éš™åŒºé—´ï¼Œ-n-1åŒºé—´ï¼Œ1-4åŒºé—´ï¼Œ7-10åŒºé—´ï¼Œ10-nåŒºé—´ (-nä»£è¡¨è´Ÿæ— ç©·å¤§ï¼Œnä»£è¡¨æ­£æ— ç©·å¤§)</p><figure><img src="/assets/202111051721479-20824a09.png" alt="é—´éš™é”" tabindex="0" loading="lazy"><figcaption>é—´éš™é”</figcaption></figure><p>**å¤§è‡´è§¦å‘æ¡ä»¶ï¼š**èŒƒå›´æŸ¥è¯¢å¹¶ä¸”æŸ¥è¯¢æœªå‘½ä¸­è®°å½•ï¼ŒæŸ¥è¯¢æ¡ä»¶å¿…é¡»å‘½ä¸­ç´¢å¼•ã€é—´éš™é”åªä¼šå‡ºç°åœ¨REPEATABLE_READ(é‡å¤è¯»)çš„äº‹åŠ¡çº§åˆ«ä¸­ã€‚</p><p><strong>ä¾‹å¦‚</strong>ï¼šå¯¹åº”ä¸Šå›¾çš„è¡¨æ‰§è¡Œ <code>select * from user_info where id&gt;1 and id&lt;4</code> (è¿™é‡Œçš„idæ˜¯å”¯ä¸€ç´¢å¼•) ï¼Œè¿™ä¸ªSQLæŸ¥è¯¢ä¸åˆ°å¯¹åº”çš„è®°å½•ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šä½¿ç”¨é—´éš™é”ã€‚</p><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><code>Infimum</code>ï¼šè¡¨ç¤ºé¡µé¢æœ€å°è®°å½•</li><li><code>Supremum</code>ï¼šè¡¨ç¤ºé¡µé¢æœ€å¤§è®°å½•</li></ul><p><strong>é—´éš™é”ä½œç”¨</strong>ï¼š<strong>é˜²æ­¢å¹»è¯»é—®é¢˜</strong>ã€‚</p><h3 id="ä¸´é”®é”-next-key-lock" tabindex="-1"><a class="header-anchor" href="#ä¸´é”®é”-next-key-lock" aria-hidden="true">#</a> <strong>ä¸´é”®é”(Next-Key Lock)</strong></h3><p>ä¸´é”®é”ï¼š<strong>æ˜¯INNODBçš„è¡Œé”é»˜è®¤ç®—æ³•</strong>ï¼Œæ€»ç»“æ¥è¯´å®ƒå°±æ˜¯è®°å½•é”å’Œé—´éš™é”çš„ç»„åˆï¼Œ<strong>ä¸´é”®é”ä¼šæŠŠæŸ¥è¯¢å‡ºæ¥çš„è®°å½•é”ä½ï¼ŒåŒæ—¶ä¹Ÿä¼šæŠŠè¯¥èŒƒå›´æŸ¥è¯¢å†…çš„æ‰€æœ‰é—´éš™ç©ºé—´ä¹Ÿä¼šé”ä½ï¼Œå†ä¹‹å®ƒä¼šæŠŠç›¸é‚»çš„ä¸‹ä¸€ä¸ªåŒºé—´ä¹Ÿä¼šé”ä½</strong>ã€‚</p><p>**ä¾‹å¦‚ï¼š**ä¸‹é¢è¡¨çš„æ•°æ®æ‰§è¡Œ <code>select * from user_info where id&gt;1 and id&lt;=13 for update ;</code></p><p>ä¼šé”ä½IDä¸º 1,5,10çš„è®°å½•ï¼›åŒæ—¶ä¼šé”ä½ï¼Œ1è‡³5,5è‡³10,10è‡³15çš„åŒºé—´ã€‚</p><figure><img src="/assets/v2-8c9555f753fbab98c71760ddba9e5068_720w-24af654f.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><p>**å¤§è‡´è§¦å‘æ¡ä»¶ï¼š**èŒƒå›´æŸ¥è¯¢å¹¶å‘½ä¸­ï¼ŒæŸ¥è¯¢å‘½ä¸­äº†ç´¢å¼•ã€‚</p><p>**ä¸´é”®é”çš„ä½œç”¨ï¼š**ç»“åˆè®°å½•é”å’Œé—´éš™é”çš„ç‰¹æ€§ï¼Œ<strong>ä¸´é”®é”é¿å…äº†åœ¨èŒƒå›´æŸ¥è¯¢æ—¶å‡ºç°è„è¯»ã€é‡å¤è¯»ã€å¹»è¯»é—®é¢˜</strong>ã€‚åŠ äº†ä¸´é”®é”ä¹‹åï¼Œåœ¨èŒƒå›´åŒºé—´å†…æ•°æ®ä¸å…è®¸è¢«ä¿®æ”¹å’Œæ’å…¥ã€‚</p><h3 id="æ’å…¥æ„å‘é”-lock-insert-intention" tabindex="-1"><a class="header-anchor" href="#æ’å…¥æ„å‘é”-lock-insert-intention" aria-hidden="true">#</a> æ’å…¥æ„å‘é”(LOCK_INSERT_INTENTION)</h3><p>æ’å…¥æ„å‘é”æ˜¯ä¸€ç§ç‰¹æ®Šçš„é—´éš™é”(Insert Intention Lock)è¡¨ç¤ºæ’å…¥çš„æ„å‘ï¼Œåªæœ‰åœ¨ INSERT çš„æ—¶å€™æ‰ä¼šæœ‰è¿™ä¸ªé”ã€‚</p><p>ä¸€ä¸ªäº‹åŠ¡æ’å…¥ä¸€æ¡è®°å½•ï¼Œéœ€è¦åˆ¤æ–­æ’å…¥ä½ç½®æ˜¯å¦è¢«åˆ«çš„äº‹åŠ¡åŠ äº†gapé”(åŒ…å«next-keyé”)ã€‚å¦‚æœæœ‰çš„è¯ï¼Œæ’å…¥æ“ä½œéœ€è¦ç­‰å¾…ï¼Œç›´åˆ°åŠ gapé”çš„äº‹åŠ¡æäº¤ã€‚</p><h3 id="éšå¼é”" tabindex="-1"><a class="header-anchor" href="#éšå¼é”" aria-hidden="true">#</a> éšå¼é”</h3><p>ä¸€èˆ¬æ‰§è¡ŒInsertä¸éœ€è¦åœ¨å†…å­˜ä¸­ç”Ÿæˆé”ç»“æ„(å½“ç„¶å¦‚æœæ’å…¥çš„é—´éš™è¢«å…¶ä»–äº‹åŠ¡åŠ äº†gapé”ï¼Œé‚£ä¹ˆæœ¬æ¬¡Insertæ“ä½œä¼šé˜»å¡ï¼Œå½“å‰äº‹åŠ¡ä¼šåœ¨é—´éš™æ’å…¥æ„å‘é”)ã€‚</p><p>ä½†è¿™æ ·å¯èƒ½ä¼šå‡ºç°é—®é¢˜ã€‚ä¸¾ä¾‹ï¼Œå…ˆæ’å…¥ä¸€æ¡è®°å½•(æ— å…³è”é”ç»“æ„)ï¼Œç„¶åå¦‚ä¸‹æƒ…å†µï¼š</p><ul><li>ç«‹å³ä½¿ç”¨<code>SELECT â€¦â€¦ LOCK IN SHARE MODE</code> æˆ– <code>SELECT â€¦â€¦ FOR UPDATE</code>ï¼Œè¿›è¡Œé”å®šè¯»ï¼Œè·å–é”ã€‚å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆå‡ºç°è„è¯»æ€ä¹ˆåŠï¼Ÿ</li><li>ç«‹å³ä¿®æ”¹è¿™æ¡è®°å½•(è·å–é”)ï¼Œæ€ä¹ˆåŠï¼Ÿ</li></ul><p>è¿™äº›æƒ…å†µä¸‹ï¼Œäº‹åŠ¡idè¦èµ·ä½œç”¨äº†</p><ul><li></li></ul><p>å¯¹äºèšç°‡ç´¢å¼•ï¼štrx_idæ˜¯ä¸€ä¸ªéšè—åˆ—ï¼Œè®°å½•æœ€åæ”¹åŠ¨çš„äº‹åŠ¡idã€‚æ–°æ’å…¥è®°å½•ï¼Œtrx_idä¸ºå½“å‰äº‹åŠ¡çš„idï¼Œå¦‚æœæƒ³åŠ é”ï¼Œä¼šçœ‹trx_idæ˜¯å¦æ˜¯æ´»è·ƒäº‹åŠ¡ã€‚å¦‚æœä¸æ˜¯ï¼Œæ­£å¸¸è·å–ï¼›å¦‚æœæ˜¯ï¼Œå¸®åŠ©å½“å‰äº‹åŠ¡å»ºç«‹Xé”çš„é”ç»“æ„ï¼Œis_writingä¸ºfalseã€‚ç„¶åè‡ªå·±ä¹Ÿåˆ›å»ºä¸€ä¸ªé”ç»“æ„ï¼Œis_writingä¸ºtrueï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</p><ul><li>å¯¹äºäºŒçº§ç´¢å¼•ï¼š äºŒçº§ç´¢å¼•é¡µé¢çš„Page Headerçš„PAGE_MAX_TRX_IDè®°å½•æ”¹åŠ¨æœ€å¤§çš„äº‹åŠ¡idã€‚å¦‚æœPAGE_MAX_TRX_IDå°äºå½“å‰æœ€å°æ´»è·ƒäº‹åŠ¡idï¼Œè¡¨æ˜å·²æäº¤ï¼Œå¦åˆ™éœ€è¦å®šä½çš„èšç°‡ç´¢å¼•ï¼Œç„¶åæ‰§è¡Œä¸Šè¿°çš„æ“ä½œã€‚</li></ul><p>æ‰€ä»¥ï¼Œä¸€ä¸ªäº‹åŠ¡æ–°æ’å…¥è®°å½•å¯ä»¥ä¸æ˜¾ç¤ºåŠ é”ï¼Œè¿™ä¸ªäº‹åŠ¡idç›¸å½“äºåŠ äº†ä¸€ä¸ªéšå¼é”ã€‚åˆ«çš„äº‹åŠ¡åŠ é”ï¼Œç”±äºéšå¼é”å­˜åœ¨ï¼Œä¼šç»™å½“å‰äº‹åŠ¡ç”Ÿæˆä¸€ä¸ªé”ç»“æ„ï¼Œç„¶åç»™è‡ªå·±ä¹Ÿç”Ÿæˆé”ç»“æ„ï¼Œå¹¶ä¸”è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</p><p><strong>éšå¼é”ä½œç”¨ï¼šå»¶è¿Ÿç”Ÿæˆé”ç»“æ„ã€‚å¦‚æœäº‹åŠ¡æ‰§è¡Œä¸éœ€è¦è·å–ä¸è¯¥éšå¼é”ç›¸å†²çªçš„é”ï¼Œå¯ä»¥é¿å…å»ºç«‹é”ç»“æ„ã€‚</strong></p><p>ç‰¹æ®Šæƒ…å†µï¼š</p><ol><li>æ’å…¥æ—¶é‡åˆ°é‡å¤é”®ä¼šæŠ¥é”™ï¼Œä½†åœ¨æŠ¥é”™å‰ä¼šåŠ é” <ol><li>ä¸»é”®(èšç°‡ç´¢å¼•)é‡å¤ï¼Œè¯»æäº¤ä¸‹åŠ è®°å½•é”ï¼Œå¯é‡å¤è¯»ä¸‹åŠ ä¸´é”®é”</li><li>äºŒçº§å”¯ä¸€ç´¢å¼•é‡å¤ï¼ŒåŠ ä¸´é”®é”ã€‚</li></ol></li><li>å¤–é”®æ£€æŸ¥ <ol><li>å¾…æŸ¥è®°å½•åœ¨å¤–é”®è¡¨ä¸­å¯ä»¥æ‰¾åˆ°ï¼Œçˆ¶è¡¨ç»™è¯¥è®°å½•åŠ è®°å½•é”</li><li>æ‰¾ä¸åˆ°æ—¶ï¼Œè¯»æäº¤ä¸åŠ é”ï¼Œå¯é‡å¤è¯»åŠ gapé”ã€‚</li></ol></li></ol><h2 id="åŠ é”è¯­å¥åˆ†æ" tabindex="-1"><a class="header-anchor" href="#åŠ é”è¯­å¥åˆ†æ" aria-hidden="true">#</a> åŠ é”è¯­å¥åˆ†æ</h2><h3 id="æ™®é€šselectè¯­å¥" tabindex="-1"><a class="header-anchor" href="#æ™®é€šselectè¯­å¥" aria-hidden="true">#</a> æ™®é€šSELECTè¯­å¥</h3><p>åœ¨ä¸åŒéš”ç¦»çº§åˆ«ä¸‹ï¼Œæ™®é€šçš„SELECTè¯­å¥å…·æœ‰ä¸åŒçš„è¡¨ç°ï¼š</p><ul><li>åœ¨ è¯»æœªæäº¤ éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸åŠ é”ï¼Œç›´æ¥è¯»å–è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼›å¯èƒ½å‡ºç°è„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç°è±¡ã€‚</li><li>åœ¨ è¯»å·²æäº¤ éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸åŠ é”ï¼›åœ¨æ¯æ¬¡æ‰§è¡Œæ™®é€šSELECTè¯­å¥çš„æ—¶å€™ä¼šç”Ÿæˆä¸€ä¸ªReadViewï¼›è¿™æ ·é¿å…äº†è„è¯»ç°è±¡ï¼Œä½†æ˜¯æ²¡æœ‰é¿å…ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ç°è±¡ã€‚</li><li>åœ¨ å¯é‡å¤è¯» éš”ç¦»çº§åˆ«ä¸‹ï¼Œä¸åŠ é”ï¼›åªåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œæ™®é€šSELECTè¯­å¥æ—¶ç”Ÿæˆä¸€ä¸ªReadViewï¼Œè¿™æ ·å¯ä»¥é¿å…è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä¸èƒ½å®Œå…¨é¿å…å¹»è¯»é—®é¢˜(å­˜åœ¨ç‰¹æ®Šæƒ…å†µï¼šäº‹åŠ¡T1æŸ¥è¯¢å‡º10æ¡è®°å½•ï¼Œäº‹åŠ¡æœªæäº¤ï¼›äº‹åŠ¡T2ï¼Œæ’å…¥ä¸€æ¡è®°å½•ï¼Œæäº¤ï¼›äº‹åŠ¡T1ä¿®æ”¹äº†åˆšåˆšäº‹åŠ¡T2æ’å…¥çš„è®°å½•ï¼Œé‚£ä¹ˆå†æ¬¡æŸ¥è¯¢æ—¶ï¼Œäº‹åŠ¡T1ä¼šæŸ¥è¯¢å‡º11æ¡æ•°æ®)ã€‚</li><li>åœ¨ ä¸²è¡ŒåŒ– éš”ç¦»çº§åˆ«ä¸‹ï¼Œåˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š <ul><li>ç³»ç»Ÿå˜é‡ <code>autocommit=0</code>æ—¶(ç¦ç”¨è‡ªåŠ¨æäº¤)ï¼Œæ™®é€šçš„SELECTæŸ¥è¯¢ä¼šè½¬æ¢ä¸º<code>SELECT â€¦â€¦ LOCK IN SHARE MODE</code> è¿™æ ·çš„è¯­å¥ã€‚ä¹Ÿå°±æ˜¯åœ¨è¯»è®°å½•å‰éœ€è¦å…ˆè·å–è®°å½•çš„Sé”ã€‚å…·ä½“åŠ é”æƒ…å†µä¸ å¯é‡å¤è¯» æƒ…å†µä¸‹ä¸€æ ·ã€‚</li><li>ç³»ç»Ÿå˜é‡<code>autocommit=1</code>æ—¶ï¼Œæ™®é€šSELECTè¯­å¥ä¸åŠ é”ï¼Œåªæ˜¯åˆ©ç”¨MVCCç”Ÿæˆä¸€ä¸ªReadViewè¯»å–è®°å½•ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå¯åŠ¨è‡ªåŠ¨æäº¤ï¼Œæ„å‘³ç€ä¸€ä¸ªäº‹åŠ¡åªåŒ…å«ä¸€æ¡è¯­å¥ï¼Œè€Œæ‰§è¡Œä¸€æ¡è¯­å¥ä¸ä¼šå‡ºç°ä¸å¯é‡å¤è¯»ã€å¹»è¯»è¿™æ ·çš„ç°è±¡ã€‚</li></ul></li></ul><h3 id="é”å®šè¯»çš„è¯­å¥" tabindex="-1"><a class="header-anchor" href="#é”å®šè¯»çš„è¯­å¥" aria-hidden="true">#</a> é”å®šè¯»çš„è¯­å¥</h3><h4 id="é”å®šè¯»çš„è¯­å¥-1" tabindex="-1"><a class="header-anchor" href="#é”å®šè¯»çš„è¯­å¥-1" aria-hidden="true">#</a> é”å®šè¯»çš„è¯­å¥</h4><ul><li>è¯­å¥1ï¼š<code>SELECT â€¦â€¦ LOCK IN SHARE MODE;</code></li><li>è¯­å¥2ï¼š<code>SELECT â€¦â€¦ FOR UPDATE;</code></li><li>è¯­å¥3ï¼š<code>UPDATE â€¦â€¦</code></li><li>è¯­å¥4ï¼š<code>DELETC â€¦â€¦</code></li></ul><p>è¯­å¥1å’Œ2æ˜¯MySQLä¸­è§„å®šçš„ä¸¤ç§é”å®šè¯»çš„è¯­æ³•æ ¼å¼ï¼Œè€Œè¯­å¥3å’Œ4åœ¨æ‰§è¡Œä¸­éœ€è¦å…ˆå®šä½åˆ°è¢«æ”¹åŠ¨çš„è®°å½•å¹¶ç»™è®°å½•åŠ é”ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä»»åŠ¡æ˜¯é”å®šè¯»ã€‚</p><p>åœ¨äº†è§£é”å®šè¯»è¯­å¥åŠ é”ä¹‹å‰ï¼Œå¼•å…¥ä¸¤ä¸ªæ¦‚å¿µï¼šåŒ¹é…æ¨¡å¼å’Œå”¯ä¸€æ€§æœç´¢ã€‚</p><h4 id="åŒ¹é…æ¨¡å¼" tabindex="-1"><a class="header-anchor" href="#åŒ¹é…æ¨¡å¼" aria-hidden="true">#</a> åŒ¹é…æ¨¡å¼</h4><p>ä½¿ç”¨ç´¢å¼•æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨é¦–å…ˆä¼šç”Ÿæˆè‹¥å¹²ä¸ªæ‰«æåŒºé—´ã€‚é’ˆå¯¹æ¯ä¸ªæ‰«æåŒºé—´ï¼Œå¯ä»¥å¿«é€Ÿå®šä½åˆ°ç¬¬ä¸€æ¡è®°å½•ï¼Œç„¶åæ²¿ç€è¿™æ¡è®°å½•æ‰€åœ¨çš„å•é“¾è¡¨å¯ä»¥æ‰«æè¿™ä¸ªåŒºé—´çš„å…¶ä»–è®°å½•ï¼Œç›´åˆ°æŸæ¡è®°å½•ä¸åœ¨è¿™ä¸ªåŒºé—´ä¸ºæ­¢ã€‚å¦‚æœè¢«æ‰«æçš„åŒºé—´æ˜¯ä¸€ä¸ªå•èŠ‚ç‚¹æ‰«æåŒºé—´ï¼Œå¯ä»¥è¯´æ­¤æ—¶çš„åŒ¹é…æ¨¡å¼æ˜¯ ** ç²¾ç¡®åŒ¹é…**ã€‚</p><p>ä¸¾ä¾‹ï¼šè”åˆç´¢å¼•idx_a_b(a,b)ï¼Œ</p><ul><li>è¾¹ç•Œæ¡ä»¶æ—¶ <code>a=1</code>ï¼Œæ‰«æåŒºé—´ä¸º[1,1]ï¼Œæ˜¯å•èŠ‚ç‚¹æ‰«æåŒºé—´ï¼Œå±äºç²¾ç¡®åŒ¹é…ã€‚</li><li>è¾¹ç•Œæ¡ä»¶æ—¶ <code>a=1 AND b=1</code>ï¼Œæ‰«æåŒºé—´ä¸º[(1,1),(1,1)]ï¼Œæ˜¯å•èŠ‚ç‚¹æ‰«æåŒºé—´ï¼Œå±äºç²¾ç¡®åŒ¹é…ã€‚</li><li>è¾¹ç•Œæ¡ä»¶æ—¶ <code>a=1 AND b&gt;=1</code>ï¼Œæ‰«æåŒºé—´ä¸º[(1,1),(1,+âˆ)]ï¼Œæ˜¯å•èŠ‚ç‚¹æ‰«æåŒºé—´ï¼Œå±äºç²¾ç¡®åŒ¹é…ã€‚</li></ul><h4 id="å”¯ä¸€æ€§æœç´¢" tabindex="-1"><a class="header-anchor" href="#å”¯ä¸€æ€§æœç´¢" aria-hidden="true">#</a> å”¯ä¸€æ€§æœç´¢</h4><p>å¦‚æœæ‰«æä¹‹å‰ï¼Œäº‹å…ˆçŸ¥é“æ‰«æåŒºé—´æœ€å¤šåŒ…å«ä¸€æ¡è®°å½•ï¼ŒæŠŠè¿™ç§æƒ…å†µç§°ä¸º <strong>å”¯ä¸€æ€§æœç´¢</strong>ã€‚</p><p>æ€ä¹ˆç¡®å®šæœ€å¤šåªåŒ…å«ä¸€æ¡è®°å½•ï¼š</p><ul><li>åŒ¹é…æ¨¡å¼ä¸ºç²¾ç¡®åŒ¹é…</li><li>ä½¿ç”¨çš„ç´¢å¼•æ˜¯ä¸»é”®æˆ–æ˜¯å”¯ä¸€äºŒçº§ç´¢å¼•ï¼›å¦‚æœä½¿ç”¨çš„æ˜¯å”¯ä¸€äºŒçº§ç´¢å¼•ï¼Œæœç´¢æ¡ä»¶ä¸èƒ½æ˜¯<code>ç´¢å¼•åˆ— IS NULL</code>çš„å½¢å¼(å› ä¸ºå¯¹ä¸€å”¯ä¸€äºŒçº§ç´¢å¼•åˆ—æ¥è¯´ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªå€¼ä¸ºNULLçš„è®°å½•)</li><li>å¦‚æœç´¢å¼•ä¸­åŒ…å«å¤šä¸ªåˆ—ï¼Œé‚£ä¹ˆåœ¨ç”Ÿæˆæ‰«æåŒºé—´æ—¶ï¼Œæ¯ä¸€ä¸ªéƒ½å¾—è¢«ç”¨åˆ°</li></ul><h4 id="å½±å“è¯­å¥åŠ é”çš„å› ç´ " tabindex="-1"><a class="header-anchor" href="#å½±å“è¯­å¥åŠ é”çš„å› ç´ " aria-hidden="true">#</a> å½±å“è¯­å¥åŠ é”çš„å› ç´ </h4><ul><li>äº‹åŠ¡çš„éš”ç¦»çº§åˆ«</li><li>è¯­å¥æ‰§è¡Œæ—¶ä½¿ç”¨çš„ç´¢å¼•ç±»å‹</li><li>æ˜¯å¦æ˜¯ç²¾ç¡®åŒ¹é…</li><li>æ˜¯å¦æ˜¯å”¯ä¸€æ€§æœç´¢</li><li>å…·ä½“çš„è¯­å¥ç±»å‹(SELECTã€UPDATEã€INSERTã€FELETE)</li></ul><h4 id="è¯»å–æŸä¸ªæ‰«æåŒºé—´ä¸­è®°å½•çš„åŠ é”è¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#è¯»å–æŸä¸ªæ‰«æåŒºé—´ä¸­è®°å½•çš„åŠ é”è¿‡ç¨‹" aria-hidden="true">#</a> è¯»å–æŸä¸ªæ‰«æåŒºé—´ä¸­è®°å½•çš„åŠ é”è¿‡ç¨‹</h4><p><strong>è¯»å–æŸä¸ªæ‰«æåŒºé—´çš„è®°å½•åŠ é”æƒ…å†µå¦‚ä¸‹ï¼š</strong></p><p>æ­¥éª¤1ï¼šé¦–å…ˆå¿«é€Ÿåœ°åœ¨B+æ ‘å¶å­èŠ‚ç‚¹ä¸­å®šä½åˆ°è¯¥æ‰«æåŒºé—´ä¸­çš„ç¬¬ä¸€æ¡è®°å½•ï¼ŒæŠŠè¯¥è®°å½•ä½œä¸ºå½“å‰è®°å½•ã€‚</p><p>æ­¥éª¤2ï¼šä¸ºå½“å‰è®°å½•åŠ é”ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¯¹äºé”å®šè¯»çš„è¯­å¥ï¼Œåœ¨éš”ç¦»çº§åˆ«ä¸å¤§äº <strong>è¯»æäº¤</strong> æ—¶ï¼Œä¼šä¸ºå½“å‰è®°å½•åŠ è®°å½•é”ã€‚åœ¨éš”ç¦»çº§åˆ«ä¸å°äº <strong>å¯é‡å¤è¯»</strong> æ—¶ï¼Œä¼šä¸ºè®°å½•åŠ ä¸´é”®é”ã€‚</p><p>æ­¥éª¤3ï¼šåˆ¤æ–­ç´¢å¼•ä¸‹æ¨çš„æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚</p><p><strong>ç´¢å¼•ä¸‹æ¨ï¼Œæ˜¯æ¥æŠŠæŸ¥è¯¢ä¸­ä¸è¢«ä½¿ç”¨ç´¢å¼•æœ‰å…³çš„æœç´¢æ¡ä»¶ä¸‹æ¨çš„å­˜å‚¨å¼•æ“ä¸­åˆ¤æ–­ï¼Œè€Œä¸æ˜¯è¿”å›serverå±‚å†åˆ¤æ–­</strong>ã€‚ç´¢å¼•ä¸‹æ¨åªæ˜¯ä¸ºäº†å‡å°‘å›è¡¨æ¬¡æ•°ï¼Œåªé€‚ç”¨äºäºŒçº§ç´¢å¼•å’ŒSELECTè¯­å¥ã€‚</p><p>ç¬¦åˆç´¢å¼•ä¸‹æ¨æ¡ä»¶ï¼Œè·³åˆ°ç¬¬å››æ­¥ç»§ç»­æ‰§è¡Œï¼›ä¸ç¬¦åˆè·å–å½“å‰è®°å½•çš„å•é“¾è¡¨çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå°†è¯¥è®°å½•ä½œä¸ºæ–°çš„å½“å‰è®°å½•ï¼Œè·³å›æ­¥éª¤äºŒã€‚å¦å¤–æ­¥éª¤3è¿˜ä¼šåˆ¤æ–­å½“å‰è®°å½•æ˜¯å¦ç¬¦åˆå½¢æˆæ‰«æåŒºé—´çš„è¾¹ç•Œæ¡ä»¶ï¼Œä¸ç¬¦åˆè·³è¿‡æ­¥éª¤4å’Œæ­¥éª¤5ï¼Œç›´æ¥å‘serverå‘é€â€œæŸ¥è¯¢å®Œæ¯•â€çš„ä¿¡æ¯ã€‚</p><p>éœ€æ³¨æ„ï¼Œ<strong>æ­¥éª¤3ä¸ä¼šé‡Šæ”¾é”</strong>ã€‚</p><p>æ­¥éª¤4ï¼šæ‰§è¡Œå›è¡¨æ“ä½œã€‚</p><p>äºŒçº§ç´¢å¼•å›è¡¨ï¼ŒæŸ¥åˆ°èšç°‡ç´¢å¼•å¹¶ç»™è¯¥è®°å½•åŠ è®°å½•é”ã€‚</p><p>æ­¥éª¤5ï¼šåˆ¤æ–­è¾¹ç•Œæ¡ä»¶æ˜¯å¦æˆç«‹ã€‚</p><p>ç¬¦åˆè¾¹ç•Œæ¡ä»¶ï¼Œç»§ç»­æ‰§è¡Œæ­¥éª¤6ï¼›å¦åˆ™åœ¨éš”ç¦»çº§åˆ«ä¸å¤§äºè¯»æäº¤æ—¶ï¼Œé‡Šæ”¾è¯¥è®°å½•é”ï¼Œå¹¶å‘serverå±‚è¿”å›â€œæŸ¥è¯¢å®Œæ¯•â€çš„ä¿¡æ¯ã€‚</p><p>æ­¥éª¤6ï¼šserverå±‚åˆ¤æ–­å…¶ä½™æœç´¢æ¡ä»¶æ˜¯å¦æˆç«‹ã€‚</p><p>å¦‚æœæˆç«‹ï¼Œå°†è¯¥è®°å½•å‘é€åˆ°å®¢æˆ·ç«¯ï¼›å¦åˆ™åœ¨éš”ç¦»çº§åˆ«ä¸å¤§äºè¯»æäº¤æ—¶ï¼Œé‡Šæ”¾è¯¥è®°å½•é”ã€‚</p><p>æ­¥éª¤7ï¼šè·å–å½“å‰è®°å½•æ‰€åœ¨å•é“¾è¡¨çš„ä¸‹ä¸€æ¡è®°å½•ï¼Œå¹¶å°†å…¶ä½œä¸ºæ–°çš„å½“å‰è®°å½•ï¼Œå¹¶è·³å›æ­¥éª¤2ã€‚</p><h4 id="ç‰¹æ®Šæƒ…å†µä¸‹çš„åŠ é”" tabindex="-1"><a class="header-anchor" href="#ç‰¹æ®Šæƒ…å†µä¸‹çš„åŠ é”" aria-hidden="true">#</a> ç‰¹æ®Šæƒ…å†µä¸‹çš„åŠ é”</h4><p>1ã€UPDATEè¯­å¥ ä¸ä¸Šè¿°æµç¨‹ç±»ä¼¼ï¼Œä¸è¿‡ï¼Œå¦‚æœæ›´æ–°äº†äºŒçº§ç´¢å¼•ï¼Œé‚£ä¹ˆæ‰€æœ‰è¢«æ›´æ–°çš„äºŒçº§ç´¢å¼•è®°å½•åœ¨æ›´æ–°ä¹‹å‰éƒ½éœ€è¦åŠ  Xå‹è®°å½•é”ã€‚</p><p>2ã€DETELEè¯­å¥ ä¸ä¸Šè¿°æµç¨‹ç±»ä¼¼ï¼Œä¸è¿‡ï¼Œå¦‚æœè¡¨ä¸­åŒ…å«äºŒçº§ç´¢å¼•ï¼Œé‚£ä¹ˆåˆ é™¤è®°å½•å‰è¦åŠ  Xå‹è®°å½•é”ã€‚</p><p>3ã€<strong>ç²¾ç¡®åŒ¹é…</strong>ã€‚<strong>éš”ç¦»çº§åˆ«ä¸å¤§äº è¯»æäº¤ æ—¶</strong>ï¼Œåˆ™ä¸ä¼šä¸ºæ‰«æåŒºé—´çš„åé¢ä¸‹ä¸€æ¡è®°å½•åŠ  è®°å½•é”ï¼›<strong>éš”ç¦»çº§åˆ«ä¸å°äº å¯é‡å¤è¯» æ—¶</strong>ï¼Œä¼šä¸ºæ‰«æåŒºé—´åé¢çš„ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>é—´éš™é”</strong>ã€‚</p><p>4ã€<strong>ä¸æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è®°å½•</strong>ã€‚å½“éš”ç¦»çº§åˆ«ä¸å°äº<strong>å¯é‡å¤è¯»</strong>æ—¶ï¼Œä¸ºæ‰«æåŒºé—´çš„åé¢ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>ä¸´é”®é”</strong> ã€‚</p><p>5ã€å½“éš”ç¦»çº§åˆ«ä¸å°äº<strong>å¯é‡å¤è¯»</strong>æ—¶ï¼Œå¦‚æœä½¿ç”¨çš„<strong>èšç°‡ç´¢å¼•</strong>ï¼Œå¹¶ä¸”æ‰«æçš„åŒºé—´æ˜¯<strong>å·¦é—­åŒºé—´</strong>ï¼Œè€Œä¸”<strong>å®šä½åˆ°çš„ç¬¬ä¸€æ¡èšç°‡ç´¢å¼•è®°å½• ä¸ æ‰«æåŒºé—´ä¸­æœ€å°å€¼ç›¸åŒ</strong>ï¼Œé‚£ä¹ˆä¼šä¸ºè¯¥èšç°‡ç´¢å¼•åŠ  <strong>è®°å½•é”</strong>ã€‚</p><p>6ã€<strong>æ— è®ºå“ªä¸ªéš”ç¦»çº§åˆ«</strong>ï¼Œåªè¦æ˜¯<strong>å”¯ä¸€æ€§æœç´¢</strong>ï¼Œå¹¶ä¸”è¯»åˆ°çš„è®°å½•è¢«æ ‡è®°ä¸ºâ€œ<strong>å·²åˆ é™¤</strong>â€ï¼Œä¸ºè¯»å–åˆ°çš„è®°å½•åŠ  <strong>è®°å½•é”</strong>ã€‚</p><p>7ã€ä¸€èˆ¬æ‰«æè®°å½•æ˜¯ä»å·¦åˆ°å³ï¼Œå¦‚æœ<strong>æ‰«ææ˜¯ä»å³åˆ°å·¦</strong>ï¼Œå½“<strong>éš”ç¦»çº§åˆ«ä¸å°äºå¯é‡å¤è¯»æ—¶</strong>ï¼ŒåŒ¹é…åˆ°ç¬¬ä¸€æ¡è®°å½•çš„ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>é—´éš™é”</strong>ã€‚</p><h3 id="åŠä¸€è‡´æ€§è¯»è¯­å¥" tabindex="-1"><a class="header-anchor" href="#åŠä¸€è‡´æ€§è¯»è¯­å¥" aria-hidden="true">#</a> åŠä¸€è‡´æ€§è¯»è¯­å¥</h3><p><strong>å½“éš”ç¦»çº§åˆ«ä¸å¤§äºè¯»æäº¤ ä¸”æ‰§è¡Œ UPDATEè¯­å¥æ—¶</strong>ï¼Œç§°ä¸ºåŠä¸€è‡´æ€§è¯»ã€‚</p><p>å³UPDATEè¯­å¥è¯»åˆ°å·²ç»è¢«å…¶ä»–äº‹åŠ¡åŠ äº†Xé”è®°å½•æ—¶ï¼ŒInnoDBä¼šæŠŠæœ€æ–°ç‰ˆæœ¬çš„è®°å½•è¯»å‡ºæ¥ï¼Œç„¶ååˆ¤æ–­è¯¥ç‰ˆæœ¬æ˜¯å¦ä¸UPDATEè¯­å¥ä¸­æœç´¢æ¡ä»¶ç›¸åŒ¹é…ã€‚</p><p>ä¸åŒ¹é…ï¼Œä¸å¯¹è¯¥è®°å½•åŠ é”ï¼Œè·³åˆ°ä¸‹ä¸€æ¡è®°å½•ï¼›å¦‚æœåŒ¹é…ï¼Œå†æ¬¡è¯»å–è¯¥è®°å½•å¹¶åŠ é”ã€‚</p><p>ç›®çš„ï¼šå°½é‡å‡å°‘UPDATEè¯­å¥è¢«åˆ«çš„è¯­å¥é˜»å¡ã€‚</p><h3 id="insertè¯­å¥" tabindex="-1"><a class="header-anchor" href="#insertè¯­å¥" aria-hidden="true">#</a> INSERTè¯­å¥</h3><p>INSERTè¯­å¥ä¸€èˆ¬æƒ…å†µä¸‹ä¸éœ€è¦åœ¨å†…å­˜ä¸­ç”Ÿæˆé”ç»“æ„ï¼Œå¹¶å•çº¯ä¾é  <strong>éšå¼é”</strong> ä¿æŠ¤æ’å…¥çš„è®°å½•ã€‚</p><p>æ’å…¥è®°å½•å‰éœ€è¦å…ˆåœ¨B+æ ‘ä¸­å®šä½åˆ°è®°å½•çš„ä½ç½®ï¼Œ<strong>å¦‚æœè¯¥ä½ç½®çš„ä¸‹ä¸€æ¡è®°å½•è¢«åŠ äº† é—´éš™é” æˆ–è€… ä¸´é”®é”ï¼Œé‚£ä¹ˆå½“å‰äº‹åŠ¡ä¼šä¸ºè¯¥è®°å½•åŠ ä¸Š æ’å…¥æ„å‘é”</strong>ã€‚</p><p>æ‰§è¡ŒINSERTè¯­å¥ï¼Œåœ¨å†…å­˜ä¸­ç”Ÿæˆé”ç»“æ„çš„ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼šé‡åˆ°é‡å¤é”®ã€å¤–é”®æ£€æŸ¥ã€‚</p><p><strong>1ã€é‡åˆ°é‡å¤é”®</strong></p><p>é‡åˆ°é‡å¤è®°å½•çš„ä¸»é”®å’Œå”¯ä¸€äºŒçº§ç´¢å¼•æ—¶ä¼šæŠ¥é”™ï¼Œä½†æ˜¯åœ¨æŠ¥é”™ä¹‹å‰ä¼šç»™è®°å½•åŠ  <strong>Sé”</strong>ã€‚</p><p>ä¸»é”®é‡å¤ï¼Œåœ¨ä¸åŒéš”ç¦»çº§åˆ«çš„åŠ é”ç±»å‹ä¸åŒï¼š</p><ul><li>éš”ç¦»çº§åˆ«ä¸º <strong>è¯»æœªæäº¤</strong> æ—¶ï¼ŒåŠ çš„æ˜¯ <strong>è®°å½•é”</strong>ã€‚</li><li>éš”ç¦»çº§åˆ«<strong>ä¸å°äºå¯é‡å¤è¯»</strong>æ—¶ï¼ŒåŠ çš„æ˜¯ <strong>ä¸´é”®é”</strong>ã€‚</li></ul><p><strong>äºŒçº§å”¯ä¸€ç´¢å¼•é‡å¤ï¼Œä¸ç®¡ä»€ä¹ˆéš”ç¦»çº§åˆ«éƒ½åŠ  ä¸´é”®é”ã€‚</strong></p><p><strong>2ã€å¤–é”®æ£€æŸ¥</strong></p><p>å¾…æ’è®°å½•çš„å¤–é”®å€¼å¯ä»¥åœ¨çˆ¶è¡¨ä¸­åŒ¹é…åˆ°ï¼Œç»™çˆ¶è¡¨çš„è¿™æ¡è®°å½•åŠ  è®°å½•é”ã€‚</p><p>å¦‚æœåœ¨çˆ¶è¡¨ä¸­æ²¡æœ‰åŒ¹é…åˆ°ï¼Œä¼šæ’å…¥å¤±è´¥ï¼Œå¹¶ä¸”ï¼š</p><ul><li>éš”ç¦»çº§åˆ«ä¸å¤§äºè¯»æäº¤æ—¶ï¼Œä¸åŠ é”</li><li>éš”ç¦»çº§åˆ«ä¸å°äºå¯é‡å¤è¯»æ—¶ï¼ŒåŠ  é—´éš™é”ã€‚</li></ul><h2 id="åŠ é”æƒ…å†µæ€»ç»“" tabindex="-1"><a class="header-anchor" href="#åŠ é”æƒ…å†µæ€»ç»“" aria-hidden="true">#</a> åŠ é”æƒ…å†µæ€»ç»“</h2><ol><li>æ™®é€šSELECTè¯­å¥ä¸åŠ é”ï¼Œä¸»è¦ä¾èµ–MVCCæœºåˆ¶ã€‚</li><li>é”å®šè¯»æƒ…å†µï¼š <ol><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåœ¨éš”ç¦»çº§åˆ«<strong>ä¸å¤§äº è¯»æäº¤</strong> æ—¶ï¼Œä¼šä¸ºå½“å‰è®°å½•åŠ <strong>è®°å½•é”</strong>ã€‚åœ¨éš”ç¦»çº§åˆ«<strong>ä¸å°äº å¯é‡å¤è¯»</strong> æ—¶ï¼Œä¼šä¸ºè®°å½•åŠ <strong>ä¸´é”®é”</strong>ã€‚</li><li><strong>UPDATEè¯­å¥æ›´æ–°äºŒçº§ç´¢å¼•</strong> æˆ– <strong>DELETEè¯­å¥åˆ é™¤è®°å½•ä¸­åŒ…å«äºŒçº§ç´¢å¼•</strong>ï¼Œéœ€è¦åŠ  <strong>Xå‹è®°å½•é”</strong>ã€‚</li><li><strong>ç²¾ç¡®åŒ¹é…</strong>ã€‚<strong>éš”ç¦»çº§åˆ«ä¸å¤§äº è¯»æäº¤ æ—¶</strong>ï¼Œåˆ™ä¸ä¼šä¸ºæ‰«æåŒºé—´çš„åé¢ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>è®°å½•é”</strong>ï¼›<strong>éš”ç¦»çº§åˆ«ä¸å°äº å¯é‡å¤è¯» æ—¶</strong>ï¼Œä¼šä¸ºæ‰«æåŒºé—´åé¢çš„ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>é—´éš™é”</strong>ã€‚</li><li><strong>ä¸æ˜¯ç²¾ç¡®åŒ¹é…ï¼Œæ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„è®°å½•</strong>ã€‚å½“éš”ç¦»çº§åˆ«ä¸å°äº<strong>å¯é‡å¤è¯»</strong>æ—¶ï¼Œä¸ºæ‰«æåŒºé—´çš„åé¢ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>ä¸´é”®é”</strong> ã€‚</li><li>å½“éš”ç¦»çº§åˆ«ä¸å°äº<strong>å¯é‡å¤è¯»</strong>æ—¶ï¼Œå¦‚æœä½¿ç”¨çš„<strong>èšç°‡ç´¢å¼•</strong>ï¼Œå¹¶ä¸”æ‰«æçš„åŒºé—´æ˜¯<strong>å·¦é—­åŒºé—´</strong>ï¼Œè€Œä¸”<strong>å®šä½åˆ°çš„ç¬¬ä¸€æ¡èšç°‡ç´¢å¼•è®°å½• ä¸ æ‰«æåŒºé—´ä¸­æœ€å°å€¼ç›¸åŒ</strong>ï¼Œé‚£ä¹ˆä¼šä¸ºè¯¥èšç°‡ç´¢å¼•åŠ  <strong>è®°å½•é”</strong>ã€‚</li><li><strong>æ— è®ºå“ªä¸ªéš”ç¦»çº§åˆ«</strong>ï¼Œåªè¦æ˜¯<strong>å”¯ä¸€æ€§æœç´¢</strong>ï¼Œå¹¶ä¸”è¯»åˆ°çš„è®°å½•è¢«æ ‡è®°ä¸ºâ€œ<strong>å·²åˆ é™¤</strong>â€ï¼Œä¸ºè¯»å–åˆ°çš„è®°å½•åŠ  <strong>è®°å½•é”</strong>ã€‚</li><li>ä¸€èˆ¬æ‰«æè®°å½•æ˜¯ä»å·¦åˆ°å³ï¼Œå¦‚æœ<strong>æ‰«ææ˜¯ä»å³åˆ°å·¦</strong>ï¼Œå½“<strong>éš”ç¦»çº§åˆ«ä¸å°äºå¯é‡å¤è¯»æ—¶</strong>ï¼ŒåŒ¹é…åˆ°ç¬¬ä¸€æ¡è®°å½•çš„ä¸‹ä¸€æ¡è®°å½•åŠ  <strong>é—´éš™é”</strong>ã€‚</li></ol></li><li>åŠä¸€è‡´æ€§è¯»è¯­å¥ï¼š<strong>UPDATEè¯­å¥è¯»åˆ°å·²ç»è¢«å…¶ä»–äº‹åŠ¡åŠ äº†Xé”è®°å½•æ—¶ï¼ŒInnoDBä¼šæŠŠæœ€æ–°ç‰ˆæœ¬çš„è®°å½•è¯»å‡ºæ¥ï¼Œç„¶ååˆ¤æ–­è¯¥ç‰ˆæœ¬æ˜¯å¦ä¸UPDATEè¯­å¥ä¸­æœç´¢æ¡ä»¶ç›¸åŒ¹é…</strong>ã€‚ä¸åŒ¹é…ï¼Œä¸å¯¹è¯¥è®°å½•åŠ é”ï¼Œè·³åˆ°ä¸‹ä¸€æ¡è®°å½•ï¼›** å¦‚æœåŒ¹é…ï¼Œå†æ¬¡è¯»å–è¯¥è®°å½•å¹¶åŠ é”**ã€‚</li><li>INSERTè¯­å¥ï¼š <ol><li>ä¸»é”®é‡å¤ï¼Œåœ¨ä¸åŒéš”ç¦»çº§åˆ«çš„åŠ é”ç±»å‹ä¸åŒï¼šéš”ç¦»çº§åˆ«ä¸º <strong>è¯»æœªæäº¤</strong> æ—¶ï¼ŒåŠ çš„æ˜¯ <strong>è®°å½•é”</strong>ã€‚éš”ç¦»çº§åˆ«<strong>ä¸å°äºå¯é‡å¤è¯»</strong>æ—¶ï¼ŒåŠ çš„æ˜¯ <strong>ä¸´é”®é”</strong>ã€‚</li><li><strong>äºŒçº§å”¯ä¸€ç´¢å¼•é‡å¤ï¼Œä¸ç®¡ä»€ä¹ˆéš”ç¦»çº§åˆ«éƒ½åŠ  ä¸´é”®é”ã€‚</strong></li><li>å¤–é”®æ£€æŸ¥ <ol><li>å¾…æ’è®°å½•çš„å¤–é”®å€¼å¯ä»¥åœ¨çˆ¶è¡¨ä¸­<strong>åŒ¹é…åˆ°</strong>ï¼Œç»™çˆ¶è¡¨çš„è¿™æ¡è®°å½•åŠ  <strong>è®°å½•é”</strong>ã€‚</li><li>å¦‚æœåœ¨çˆ¶è¡¨ä¸­<strong>æ²¡æœ‰åŒ¹é…åˆ°</strong>ï¼Œä¼šæ’å…¥å¤±è´¥ï¼Œå¹¶ä¸”ï¼šéš”ç¦»çº§åˆ«ä¸å¤§äºè¯»æäº¤æ—¶ï¼Œä¸åŠ é”ï¼›<strong>éš”ç¦»çº§åˆ«ä¸å°äºå¯é‡å¤è¯»æ—¶ï¼ŒåŠ  é—´éš™é”</strong>ã€‚</li></ol></li></ol></li></ol><h2 id="æŸ¥çœ‹äº‹åŠ¡çš„åŠ é”æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹äº‹åŠ¡çš„åŠ é”æƒ…å†µ" aria-hidden="true">#</a> æŸ¥çœ‹äº‹åŠ¡çš„åŠ é”æƒ…å†µ</h2><h3 id="ä½¿ç”¨-information-schema-æ•°æ®åº“ä¸­çš„è¡¨è·å–é”ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-information-schema-æ•°æ®åº“ä¸­çš„è¡¨è·å–é”ä¿¡æ¯" aria-hidden="true">#</a> ä½¿ç”¨ information_schema æ•°æ®åº“ä¸­çš„è¡¨è·å–é”ä¿¡æ¯</h3><p>åœ¨æ•°æ®åº“ information_schema ä¸­ï¼Œæœ‰å‡ ä¸ªè¡¨å’Œäº‹åŠ¡ã€é”æœ‰å…³ã€‚</p><p>1ã€<code>INNODB_TRX</code>ï¼šè¯¥è¡¨å­˜å‚¨äº†InnoDBå­˜å‚¨å¼•æ“å½“å‰æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡ä¿¡æ¯ã€‚åŒ…æ‹¬ï¼šäº‹åŠ¡idï¼Œäº‹åŠ¡çŠ¶æ€ç­‰ã€‚</p><p>å…¶ä¸­é‡ç‚¹æœ‰å‡ ä¸ªå±æ€§å€¼å¾—å…³æ³¨ï¼š</p><ul><li><code>trx_tables_locked</code>ï¼šè¡¨ç¤ºè¯¥äº‹åŠ¡ç›®å‰åŠ äº†å¤šå°‘ä¸ªè¡¨çº§é”</li><li><code>trx_rows_locked</code>ï¼šè¡¨ç¤ºè¯¥äº‹åŠ¡ç›®å‰åŠ äº†å¤šå°‘ä¸ªè¡Œçº§é”(ä¸åŒ…æ‹¬éšå¼é”)</li><li><code>trx_lock_structs</code>ï¼šè¡¨ç¤ºç”Ÿæˆè¯¥äº‹ç‰©ç”Ÿæˆäº†å¤šå°‘ä¸ªå†…å­˜ç»“æ„çš„é”</li></ul><p>2ã€<code>INNODB_LOCKS</code>ï¼šè¯¥è¡¨è®°å½•äº†ä¸€äº›é”ä¿¡æ¯ï¼š</p><ul><li>å¦‚æœä¸€ä¸ªäº‹åŠ¡æƒ³è¦è·å–åˆ°æŸä¸ªé”ä½†æœªè·å–åˆ°ï¼Œåˆ™è®°å½•è¯¥é”ä¿¡æ¯</li><li>å¦‚æœä¸€ä¸ªäº‹åŠ¡è·å–åˆ°é”ï¼Œä½†æ˜¯è¿™ä¸ªé”é˜»å¡äº†åˆ«çš„äº‹åŠ¡ï¼Œåˆ™è®°å½•è¯¥é”ä¿¡æ¯ã€‚</li></ul><p>3ã€<code>INNODB_LOCK_WAITS</code>ï¼šè¡¨æ˜æ¯ä¸ªé˜»å¡äº‹åŠ¡æ˜¯å› ä¸ºè·å–ä¸åˆ°é‚£ä¸ªäº‹åŠ¡æŒæœ‰çš„é”è€Œé˜»å¡ã€‚</p><h3 id="ä½¿ç”¨-show-eninge-innodb-status-è·å–é”ä¿¡æ¯" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-show-eninge-innodb-status-è·å–é”ä¿¡æ¯" aria-hidden="true">#</a> ä½¿ç”¨ SHOW ENINGE INNODB STATUS è·å–é”ä¿¡æ¯</h3><p>ç•¥</p><h2 id="æ­»é”é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#æ­»é”é—®é¢˜" aria-hidden="true">#</a> æ­»é”é—®é¢˜</h2><p>T1å’ŒT2éƒ½åœ¨ç­‰å¾…å¯¹æ–¹å…ˆé‡Šæ”¾æ‰ä¸è‡ªå·±éœ€è¦çš„é”ç›¸å†²çªçš„é”ï¼Œå› æ­¤T1å’ŒT2éƒ½ä¸èƒ½ç»§ç»­æ‰§è¡Œï¼Œæ­¤æ—¶å°±ç§°å‘ç”Ÿäº†æ­»é”ã€‚</p><p>ä¾‹å­ï¼š</p><table><thead><tr><th>å‘ç”Ÿæ—¶é—´ç¼–å·</th><th>T1</th><th>T2</th></tr></thead><tbody><tr><td>1</td><td>BEGIN;</td><td></td></tr><tr><td>2</td><td></td><td>BEGIN;</td></tr><tr><td>3</td><td>SELECT * FROM hero WHERE number=1 FOR UPDATE;</td><td></td></tr><tr><td>4</td><td></td><td>SELECT * FROM hero WHERE number=3 FOR UPDATE;</td></tr><tr><td>5</td><td>SELECT * FROM hero WHERE number=3 FOR UPDATE; <br>(æ­¤æ“ä½œé˜»å¡)</td><td></td></tr><tr><td>6</td><td></td><td>SELECT * FROM hero WHERE number=1 FOR UPDATE; <br>(æ­»é”å‘ç”Ÿï¼Œè®°å½•æ—¥å¿—ï¼ŒæœåŠ¡å™¨å›æ»šä¸€ä¸ªäº‹åŠ¡)</td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p>**æ­»é”æ£€æµ‹æœºåˆ¶ï¼š**æ£€æµ‹æ­»é”ï¼Œä¼šé€‰æ‹©ä¸€ä¸ªè¾ƒå°çš„äº‹åŠ¡(å¢åˆ æ”¹è®°å½•æ¡æ•°è¾ƒå°‘)ï¼Œå¹¶å‘å®¢æˆ·ç«¯å‘é€ä¸€æ¡æŠ¥é”™ä¿¡æ¯ã€‚</p><p>å¯é€šè¿‡è¯­å¥ <code>SELECT ENGINE INNODB STATUS</code> æŸ¥çœ‹æœ€è¿‘ä¸€æ¬¡æ­»é”å‘ç”Ÿçš„ä¿¡æ¯ã€‚</p><h2 id="å‚çœ‹-2" tabindex="-1"><a class="header-anchor" href="#å‚çœ‹-2" aria-hidden="true">#</a> å‚çœ‹ï¼š</h2><ul><li>ã€ŠMySQLæ˜¯æ€æ ·è¿è¡Œçš„ã€‹</li><li><a href="https://zhuanlan.zhihu.com/p/149228460" target="_blank" rel="noopener noreferrer">æŠŠMySQLä¸­çš„å„ç§é”åŠå…¶åŸç†éƒ½ç”»å‡ºæ¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/213814000" target="_blank" rel="noopener noreferrer">Mysqlé‡Œçš„é”(æ’å®ƒé”ã€å…±äº«é”ã€è¡Œé”ã€è¡¨é”ã€é—´éš™é”ã€ä¸´é”®é”ã€æ„å‘é”)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/31537871" target="_blank" rel="noopener noreferrer">ä»€ä¹ˆæ˜¯æ‚²è§‚é”å’Œä¹è§‚é”<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/29150809" target="_blank" rel="noopener noreferrer">MySQLé”æ€»ç»“<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h1 id="mysqlç´¢å¼•çš„18ä¸ªé—®é¢˜" tabindex="-1"><a class="header-anchor" href="#mysqlç´¢å¼•çš„18ä¸ªé—®é¢˜" aria-hidden="true">#</a> MySQLç´¢å¼•çš„18ä¸ªé—®é¢˜</h1><h2 id="_1-ç´¢å¼•æ˜¯ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#_1-ç´¢å¼•æ˜¯ä»€ä¹ˆ" aria-hidden="true">#</a> 1 ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>ç´¢å¼•æ˜¯ä¸€ç§æ•°æ®ç»“æ„ï¼ŒååŠ©å¿«é€ŸæŸ¥è¯¢å’Œæ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®ã€‚</p><p>ç´¢å¼•ä¹Ÿæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼ŒåŒ…å«æ•°æ®åº“è¡¨é‡Œæ‰€æœ‰è®°å½•çš„å¼•ç”¨æŒ‡é’ˆã€‚</p><p>å¯ä»¥ç±»æ¯”å­—å…¸ï¼Œæœ‰æ‹¼éŸ³æˆ–è€…ç¬”ç”»çš„å¿«é€Ÿæ£€ç´¢ï¼Œæ‰¾åˆ°å¯¹åº”çš„é¡µç ï¼Œæ‰“å¼€åå³å¯çŸ¥é“æŸä¸€ä¸ªkeyçš„å…¨éƒ¨å€¼ä¿¡æ¯ã€‚</p><h2 id="_2-ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#_2-ç´¢å¼•çš„ä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> 2 ç´¢å¼•çš„ä¼˜ç¼ºç‚¹ï¼Ÿ</h2><p>ä¼˜ç‚¹ï¼š</p><ul><li>å¤§å¤§åŠ å¿«æ£€ç´¢é€Ÿåº¦ã€‚(åˆ›å»ºç´¢å¼•æœ€ä¸»è¦åŸå› )</li><li>ä½¿ç”¨ç´¢å¼•ï¼Œåœ¨æŸ¥è¯¢è¿‡ç¨‹ä¸­ä½¿ç”¨ä¼˜åŒ–éšè—å™¨ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>æ—¶é—´æ–¹é¢ï¼šåˆ›å»ºç´¢å¼•å’Œç»´æŠ¤ç´¢å¼•éœ€è¦è€—è´¹æ—¶é—´ï¼Œå¯¹ç´¢å¼•æ•°æ®å¢åˆ æ”¹ã€ç´¢å¼•ä¹Ÿè¦ç»´æŠ¤ï¼Œé™ä½å¢åˆ æ”¹æ•ˆç‡ã€‚</li><li>ç©ºé—´æ–¹é¢ï¼šç´¢å¼•å ç”¨ç‰©ç†ç©ºé—´ã€‚</li></ul><h2 id="_3-mysqlçš„ç´¢å¼•ç±»å‹" tabindex="-1"><a class="header-anchor" href="#_3-mysqlçš„ç´¢å¼•ç±»å‹" aria-hidden="true">#</a> 3 MySQLçš„ç´¢å¼•ç±»å‹</h2><p>å­˜å‚¨ç»“æ„åˆ’åˆ†ï¼šBTreeç´¢å¼•(B-Treeæˆ–B+Treeç´¢å¼•)ï¼ŒHashç´¢å¼•ï¼Œfull-indexå…¨æ–‡ç´¢å¼•ï¼ŒR-Treeç´¢å¼•ã€‚</p><p>åº”ç”¨å±‚æ¬¡æ¥åˆ†ï¼š</p><ul><li>æ™®é€šç´¢å¼•ï¼šå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•</li><li>å”¯ä¸€ç´¢å¼•ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼</li><li>å¤åˆç´¢å¼•ï¼šå¤šåˆ—å€¼ç»„æˆä¸€ä¸ªç´¢å¼•ï¼Œä¸“é—¨ç”¨äºç»„åˆæœç´¢ï¼Œå…¶æ•ˆç‡å¤§äºç´¢å¼•åˆå¹¶</li><li>èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•(ä¸‹è¾¹ä»‹ç»)</li></ul><p>æ ¹æ®æ•°æ®çš„ç‰©ç†é¡ºåºä¸é”®å€¼çš„é€»è¾‘(ç´¢å¼•)é¡ºåºå…³ç³»ï¼š èšé›†ç´¢å¼•ï¼Œéèšé›†ç´¢å¼•</p><h2 id="_4-mysql-ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„é€‰å‹-ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨b-tree-è€Œä¸æ˜¯b-tree-hash-äºŒå‰æ ‘-çº¢é»‘æ ‘" tabindex="-1"><a class="header-anchor" href="#_4-mysql-ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„é€‰å‹-ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨b-tree-è€Œä¸æ˜¯b-tree-hash-äºŒå‰æ ‘-çº¢é»‘æ ‘" aria-hidden="true">#</a> 4 Mysql ç´¢å¼•åº•å±‚æ•°æ®ç»“æ„é€‰å‹(ä¸ºä»€ä¹ˆç´¢å¼•ç»“æ„é»˜è®¤ä½¿ç”¨B+Treeï¼Œè€Œä¸æ˜¯B-Treeï¼ŒHashï¼ŒäºŒå‰æ ‘ï¼Œçº¢é»‘æ ‘ï¼Ÿ)</h2><p>æ•°æ®ç»“æ„é€‰å‹ä»¥å¦‚ä¸‹å›¾çš„userè¡¨è¿›è¡Œåˆ†æï¼š</p><img src="/assets/20210626100234-4f58496e.png" alt="userè¡¨éƒ¨åˆ†æ•°æ®ç¤ºä¾‹" style="zoom:50%;"><h3 id="å“ˆå¸Œè¡¨" tabindex="-1"><a class="header-anchor" href="#å“ˆå¸Œè¡¨" aria-hidden="true">#</a> å“ˆå¸Œè¡¨</h3><p>å“ˆå¸Œè¡¨å¯ä»¥è¿›è¡Œæ•°æ®çš„å¿«é€Ÿæ£€ç´¢ã€‚</p><p>å“ˆå¸Œç®—æ³•ï¼šä¹Ÿå«æ•£åˆ—ç®—æ³•ï¼Œå°±æ˜¯æŠŠä»»æ„å€¼(key)é€šè¿‡å“ˆå¸Œå‡½æ•°å˜æ¢ä¸ºå›ºå®šé•¿åº¦çš„ key åœ°å€ï¼Œé€šè¿‡è¿™ä¸ªåœ°å€è¿›è¡Œæ•°æ®æŸ¥è¯¢çš„æ•°æ®ç»“æ„ã€‚</p><img src="/assets/20210626100002-03d427b2.png" alt="å“ˆå¸Œè¡¨åŸç†" style="zoom:67%;"><p>å¦‚æœéœ€è¦æ£€ç´¢<code>id=7</code>çš„æ•°æ®ï¼Œsqlå¦‚ä¸‹ï¼š</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> <span class="token operator">*</span>
<span class="token keyword">from</span> <span class="token keyword">user</span>
<span class="token keyword">where</span> id <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å“ˆå¸Œç®—æ³•å¿«é€Ÿæ£€ç´¢æ•°æ®çš„è®¡ç®—è¿‡ç¨‹ï¼šé¦–å…ˆè®¡ç®—å­˜å‚¨ id=7 çš„æ•°æ®çš„ç‰©ç†åœ°å€ addr=hash(7)=4231ï¼Œè€Œ 4231 æ˜ å°„çš„ç‰©ç†åœ°å€æ˜¯ 0x77ï¼Œ0x77 å°±æ˜¯ id=7 å­˜å‚¨çš„é¢æ•°æ®çš„ç‰©ç†åœ°å€ï¼Œé€šè¿‡è¯¥ç‹¬ç«‹åœ°å€å¯ä»¥æ‰¾åˆ°å¯¹åº” user_name=&#39;g&#39;è¿™ä¸ªæ•°æ®ã€‚</p><p>ä½†æ˜¯hashç®—æ³•å¯èƒ½å‡ºç°<strong>ç¢°æ’é—®é¢˜</strong>ï¼Œå³hashå‡½æ•°å¯èƒ½è®¡ç®—ç›¸åŒçš„keyå€¼ï¼Œä¸åŒçš„keyæ˜ å°„åˆ°äº†åŒä¸€ä¸ªç»“æœã€‚è§£å†³ç¢°æ’é—®é¢˜çš„å¸¸è§æ–¹æ³•æ˜¯<strong>é“¾åœ°å€æ³•</strong> ï¼šç¢°æ’æ•°æ®ä½¿ç”¨é“¾è¡¨è¿æ¥ï¼Œè®¡ç®—hashå€¼åï¼Œåˆ¤æ–­è¯¥å€¼å¦‚æœæœ‰ç¢°æ’ï¼Œéå†åˆ°é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°çœŸæ­£çš„keyæ‰€å¯¹åº”çš„æ•°æ®ä¸ºæ­¢ã€‚</p><figure><img src="/assets/20210626101110-b95b1b61.png" alt="hashç¢°æ’-é“¾åœ°å€æ³•" tabindex="0" loading="lazy"><figcaption>hashç¢°æ’-é“¾åœ°å€æ³•</figcaption></figure><p>ä»ç®—æ³•æ—¶é—´å¤æ‚åº¦åˆ†ææ¥çœ‹ï¼Œå“ˆå¸Œç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º O(1)ï¼Œæ£€ç´¢é€Ÿåº¦éå¸¸å¿«ã€‚æ¯”å¦‚æŸ¥æ‰¾ id=7 çš„æ•°æ®ï¼Œå“ˆå¸Œç´¢å¼•åªéœ€è¦è®¡ç®—ä¸€æ¬¡å°±å¯ä»¥è·å–åˆ°å¯¹åº”çš„æ•°æ®ï¼Œæ£€ç´¢é€Ÿåº¦éå¸¸å¿«ã€‚ä½†æ˜¯ Mysql å¹¶æ²¡æœ‰é‡‡å–å“ˆå¸Œä½œä¸ºå…¶åº•å±‚ç®—æ³•ã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>select * from user where id &gt;3;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å³hashç®—æ³•é’ˆå¯¹èŒƒå›´æŸ¥æ‰¾æ•ˆç‡å¤ªä½ï¼Œéœ€è¦æŠŠæ‰€æœ‰æ•°æ®æ‰¾å‡ºæ¥åŠ è½½åˆ°å†…å­˜ï¼Œç„¶åå†åœ¨å†…å­˜é‡Œç­›é€‰ç­›é€‰ç›®æ ‡èŒƒå›´å†…çš„æ•°æ®ã€‚</p><p><strong>æ€»ç»“ï¼šhashè¡¨å¯ä»¥å¿«é€Ÿæ£€ç´¢æ•°æ®ï¼Œä½†æ˜¯èŒƒå›´æŸ¥æ‰¾æ•ˆç‡ä½ã€‚æ‰€ä»¥ä¸é€‚åˆä½œä¸ºMySQLçš„ç´¢å¼•æ•°æ®ç»“æ„</strong>ã€‚</p><h3 id="äºŒå‰æŸ¥æ‰¾æ•°-bst" tabindex="-1"><a class="header-anchor" href="#äºŒå‰æŸ¥æ‰¾æ•°-bst" aria-hidden="true">#</a> äºŒå‰æŸ¥æ‰¾æ•°(BST)</h3><p>äºŒå‰æŸ¥æ‰¾æ ‘æ”¯æŒå¿«é€ŸæŸ¥æ‰¾æ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logn)ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåªéœ€è®¡ç®—ä¸‰æ¬¡å³å¯æ‰¾åˆ°<code>id=7</code>çš„æ•°æ®ã€‚éœ€è¦è€ƒè™‘å…¶æ˜¯å¦èƒ½è§£å†³hashè¡¨èŒƒå›´æŸ¥æ‰¾æ•ˆç‡ä½çš„é—®é¢˜ã€‚</p><img src="/assets/20210626101831-b0b1e749.png" alt="image-20210626101831123" style="zoom:67%;"><p>äºŒå‰æŸ¥æ‰¾æ•°æŒ‰åºæ’åˆ—(ä»å·¦åˆ°å³å‡åº)ï¼Œå¦‚æœæƒ³æ‰¾åˆ°<code>id&gt;5</code>çš„æ•°æ®ï¼Œåªéœ€è¦æ‰¾åˆ°<strong>èŠ‚ç‚¹6åŠå…¶å³å­æ ‘</strong>çš„æ•°æ®å³å¯ï¼ŒèŒƒå›´æŸ¥æ‰¾æ¯”è¾ƒå®¹æ˜“å®ç°ã€‚</p><p><strong>æ™®é€šäºŒå‰æ ‘çš„è‡´å‘½ç¼ºç‚¹</strong>ï¼šæç«¯æƒ…å†µä¸‹ä¼šé€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(n)ï¼Œæ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œå¦‚ä¸‹å›¾ï¼š</p><img src="/assets/20210626102314-689c1c60.png" alt="äºŒå‰æ ‘é€€åŒ–ä¸ºçº¿æ€§é“¾è¡¨"><p>æ•°æ®åº“è¡¨çš„ä¸»é”®idä¸€èˆ¬ä¸ºè‡ªå¢ï¼Œä¸Šè¿°çš„çº¿æ€§ç»“æ„æŸ¥æ‰¾é—®é¢˜å¿…ç„¶å‡ºç°ï¼Œè€Œä¸”é¢‘ç‡è¿˜å¾ˆé«˜ã€‚</p><p><strong>æ€»ç»“ï¼šäºŒå‰æŸ¥æ‰¾æ•°æŸ¥è¯¢æ•ˆç‡é«˜ï¼Œè€Œä¸”å¯ä»¥è§£å†³hashè¡¨èŒƒå›´æŸ¥è¯¢æ•ˆç‡ä½çš„é—®é¢˜ï¼Œä½†æ˜¯ä¼šé¢‘ç¹å‡ºç°ä¸å¹³è¡¡é€€åŒ–é—®é¢˜å¯¼è‡´æŸ¥è¯¢æ•ˆç‡ä½çš„é—®é¢˜ï¼Œæ‰€ä»¥ä¸é€‚åˆä½œä¸ºMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ã€‚</p><h3 id="çº¢é»‘æ ‘-1" tabindex="-1"><a class="header-anchor" href="#çº¢é»‘æ ‘-1" aria-hidden="true">#</a> çº¢é»‘æ ‘</h3><p>äºŒå‰æŸ¥æ‰¾æ ‘ä¸å¹³è¡¡ï¼Œå¯ä»¥é€šè¿‡æ ‘èŠ‚ç‚¹çš„è‡ªåŠ¨æ—‹è½¬å’Œè°ƒæ•´æ¥è§£å†³ï¼Œä»è€Œä¿è¯äºŒå‰æ ‘çš„æŸ¥æ‰¾æ€§èƒ½ã€‚æœ€å¸¸è§çš„æ€è·¯æ˜¯å¹³è¡¡äºŒå‰æ ‘å’Œçº¢é»‘æ ‘ã€‚</p><p>çº¢é»‘æ ‘å¯ä»¥è‡ªåŠ¨è°ƒæ•´æ ‘çš„ç»“æ„ï¼Œå½“äºŒå‰æ ‘ä¸å¹³è¡¡æ—¶ï¼Œçº¢é»‘æ ‘è‡ªåŠ¨å·¦å³æ—‹è½¬å’ŒèŠ‚ç‚¹å˜è‰²ï¼Œä¿æŒåŸºæœ¬å¹³è¡¡ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logn)ï¼ŒæŸ¥è¯¢æ•ˆç‡ä¸ä¼šé™ä½ã€‚å¦‚ä¸‹å›¾ï¼Œçº¢é»‘æ ‘æŸ¥æ‰¾<code>id=7</code>çš„èŠ‚ç‚¹åªéœ€è¦æŸ¥æ‰¾4æ¬¡ï¼š</p><img src="/assets/20210626105121-2725e72c.png" alt="çº¢é»‘æ ‘æŸ¥æ‰¾èŠ‚ç‚¹" style="zoom:80%;"><p><strong>ä½†æ˜¯çº¢é»‘æ ‘ä¹Ÿæœ‰ç¼ºç‚¹ï¼Œå³â€œå³å€¾â€ç°è±¡</strong>(å‚çœ‹ä¸‹å›¾)ï¼Œè™½ç„¶æ²¡æœ‰äºŒå‰æ ‘é€€åŒ–é‚£ä¹ˆå¤¸å¼ ï¼Œä½†æ•°æ®åº“ä¸»é”®åŸºæœ¬éƒ½æ˜¯è‡ªå¢ï¼Œé¢å¯¹æˆåƒä¸Šç™¾ä¸‡çš„æ•°æ®ï¼Œè¿™æŸ¥è¯¢æ•ˆç‡å¯æƒ³è€ŒçŸ¥ã€‚</p><figure><img src="/assets/20210626105920-4c5fa6db.png" alt="çº¢é»‘æ ‘â€œå³å€¾â€ç°è±¡" tabindex="0" loading="lazy"><figcaption>çº¢é»‘æ ‘â€œå³å€¾â€ç°è±¡</figcaption></figure><p><strong>æ€»ç»“ï¼šçº¢é»‘æ ‘æŸ¥è¯¢æ•ˆç‡ä¸äºŒå‰æŸ¥æ‰¾æ ‘ç›¸ä¼¼ï¼Œæç«¯é€€åŒ–æƒ…å†µæ¯”å¹³è¡¡äºŒå‰æ ‘å¥½ï¼Œä½†æ˜¯ä¹Ÿæ²¡èƒ½è¾¾åˆ°é¢„æœŸï¼Œæ‰€ä»¥ä¸é€‚åˆMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ã€‚</p><h3 id="å¹³è¡¡äºŒå‰æ ‘-avl-1" tabindex="-1"><a class="header-anchor" href="#å¹³è¡¡äºŒå‰æ ‘-avl-1" aria-hidden="true">#</a> å¹³è¡¡äºŒå‰æ ‘(AVL)</h3><p>å¹³è¡¡äºŒå‰æ ‘ï¼Œæ˜¯ç»å¯¹å¹³è¡¡çš„ã€‚</p><p>AVL æ ‘é¡ºåºæ’å…¥ 1~7 ä¸ªèŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ id=7 æ‰€è¦æ¯”è¾ƒèŠ‚ç‚¹çš„æ¬¡æ•°ä¸º 3ã€‚</p><p>AVL æ ‘æ’å…¥ 1~16 ä¸ªèŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾ id=16 éœ€è¦æ¯”è¾ƒçš„èŠ‚ç‚¹æ•°ä¸º 4ã€‚ä»æŸ¥æ‰¾æ•ˆç‡è€Œè¨€ï¼ŒAVL æ ‘æŸ¥æ‰¾çš„é€Ÿåº¦è¦é«˜äºçº¢é»‘æ ‘çš„æŸ¥æ‰¾æ•ˆç‡(AVL æ ‘æ˜¯ 4 æ¬¡æ¯”è¾ƒï¼Œçº¢é»‘æ ‘æ˜¯ 6 æ¬¡æ¯”è¾ƒ)ã€‚</p><p>ä»æ ‘çš„å½¢æ€çœ‹æ¥ï¼ŒAVL æ ‘ä¸å­˜åœ¨çº¢é»‘æ ‘çš„â€œå³å€¾â€é—®é¢˜ã€‚å¤§é‡çš„é¡ºåºæ’å…¥ä¸ä¼šå¯¼è‡´æŸ¥è¯¢æ€§èƒ½çš„é™ä½ï¼Œè¿™ä»æ ¹æœ¬ä¸Šè§£å†³äº†çº¢é»‘æ ‘çš„é—®é¢˜ã€‚</p><p><strong>AVL æ ‘çš„ä¼˜ç‚¹</strong>ï¼š</p><ul><li>æŸ¥è¯¢æ•ˆç‡é«˜O(logn)ï¼Œä¸å­˜åœ¨æç«¯æƒ…å†µã€‚</li><li>å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥æ‰¾å’Œæ’åºã€‚</li></ul><p><strong>ä½†æ˜¯ä¸ºä»€ä¹ˆä¸é€‰å–AVLæ ‘ä½œä¸ºMySQLç´¢å¼•çš„æ•°æ®ç»“æ„</strong>ï¼Ÿ</p><p><strong>ä¸»è¦æ˜¯ç£ç›˜IOå› ç´ çš„å½±å“</strong>ã€‚å¦‚æœä½¿ç”¨AVLæ ‘ï¼Œæ¯ä¸€ä¸ªæ ‘èŠ‚ç‚¹ï¼Œåªå­˜å‚¨ä¸€ä¸ªæ•°æ®ã€‚å¦‚æœæŸ¥è¯¢<code>id=7</code>çš„æ•°æ®ï¼Œéœ€è¦æ¯”å¯¹ä¸‰æ¬¡æ ‘èŠ‚ç‚¹ï¼Œå³è¿›è¡Œä¸‰æ¬¡ç£ç›˜IOæ“ä½œï¼Œå¦‚æœæ•°æ®é‡å¤§äº†ï¼Œé‚£ç£ç›˜IOçš„æ¬¡æ•°ä¼šå¾ˆé«˜ï¼Œæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚</p><p>æ‰€ä»¥ï¼Œ<strong>è®¾è®¡æ•°æ®åº“ç´¢å¼•çš„æ—¶å€™ï¼Œè¿˜éœ€è¦è€ƒè™‘æ€ä¹ˆå°½å¯èƒ½å‡å°‘ç£ç›˜çš„IOæ¬¡æ•°</strong>ã€‚</p><p><strong>ç£ç›˜è¯»å–1Bå’Œ1KBçš„æ•°æ®æ¶ˆè€—çš„æ—¶é—´åŸºæœ¬æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨æ›´å¤šçš„æ•°æ®ï¼Œå³ä¸€æ¬¡ç£ç›˜IOè¯»å–æ›´å¤šæ•°æ®ï¼Œå³å¯è§£å†³é—®é¢˜ã€‚æ‰€ä»¥å°±è€ƒè™‘åˆ°äº†Bæ ‘</strong>ã€‚</p><h3 id="bæ ‘-b-æ ‘" tabindex="-1"><a class="header-anchor" href="#bæ ‘-b-æ ‘" aria-hidden="true">#</a> Bæ ‘(B-æ ‘)</h3><p>Bæ ‘çš„ç†è§£å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/27700617" target="_blank" rel="noopener noreferrer">å¹³è¡¡äºŒå‰æ ‘ã€Bæ ‘ã€B+æ ‘ã€B*æ ‘ ç†è§£å…¶ä¸­ä¸€ç§ä½ å°±éƒ½æ˜ç™½äº†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Bæ ‘ï¼Œå¹³è¡¡å¤šè·¯æŸ¥æ‰¾æ ‘ï¼Œåˆç§°B-æ ‘ã€‚</p><p><strong>å¦‚æœæ¯ä¸ªèŠ‚ç‚¹é™åˆ¶æœ€å¤šå­˜å‚¨ä¸¤ä¸ªkey(å³äºŒå‰æ ‘)ï¼Œä¸€ä¸ªèŠ‚ç‚¹å¦‚æœè¶…è¿‡ä¸¤ä¸ªkeyä¼šè‡ªåŠ¨åˆ†è£‚ã€‚</strong></p><p>æ¯”å¦‚ä¸‹é¢è¿™ä¸ªå­˜å‚¨äº† 7 ä¸ªæ•°æ® B æ ‘ï¼Œåªéœ€è¦æŸ¥è¯¢ä¸¤ä¸ªèŠ‚ç‚¹å°±å¯ä»¥çŸ¥é“ id=7 è¿™æ•°æ®çš„å…·ä½“ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä¸¤æ¬¡ç£ç›˜ IO å°±å¯ä»¥æŸ¥è¯¢åˆ°æŒ‡å®šæ•°æ®ï¼Œä¼˜äº AVL æ ‘ã€‚</p><img src="/assets/20210626112940-eb38c8fa.png" alt="Bæ ‘7èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=2)" style="zoom:80%;"><p>å¦‚æœæ˜¯ä¸€ä¸ªå­˜å‚¨äº† 16 ä¸ªæ•°æ®çš„ B æ ‘ï¼ŒåŒæ ·æ¯ä¸ªèŠ‚ç‚¹æœ€å¤šå­˜å‚¨ 2 ä¸ª keyï¼ŒæŸ¥è¯¢ id=16 è¿™ä¸ªæ•°æ®éœ€è¦æŸ¥è¯¢æ¯”è¾ƒ 4 ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ç»è¿‡ 4 æ¬¡ç£ç›˜ IOã€‚çœ‹èµ·æ¥æŸ¥è¯¢æ€§èƒ½ä¸ AVL æ ‘ä¸€æ ·ã€‚</p><img src="/assets/20210626115100-cce4d784.png" alt="Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=2)" style="zoom:80%;"><p><strong>å¦‚æœé™åˆ¶æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å­˜å‚¨6ä¸ªkeyã€‚</strong></p><p>ä¸€ä¸ªå­˜å‚¨äº† 7 ä¸ªæ•°æ®çš„ B æ ‘ï¼ŒæŸ¥è¯¢ id=7 è¿™ä¸ªæ•°æ®æ‰€è¦è¿›è¡Œçš„ç£ç›˜ IO ä¸º 2 æ¬¡ã€‚</p><img src="/assets/20210626115252-4b1a3723.png" alt="Bæ ‘7èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)" style="zoom:80%;"><p>ä¸€ä¸ªå­˜å‚¨äº† 16 ä¸ªæ•°æ®çš„ B æ ‘ï¼ŒæŸ¥è¯¢ id=7 è¿™ä¸ªæ•°æ®æ‰€è¦è¿›è¡Œçš„ç£ç›˜ IO ä¸º 2 æ¬¡ã€‚ç›¸å¯¹äº AVL æ ‘è€Œè¨€ç£ç›˜ IO æ¬¡æ•°é™ä½ä¸ºä¸€åŠã€‚</p><figure><img src="/assets/20210626115329-3e54ec23.png" alt="Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)" tabindex="0" loading="lazy"><figcaption>Bæ ‘16èŠ‚ç‚¹(é™åˆ¶å•èŠ‚ç‚¹key=6)</figcaption></figure><p><strong>B æ ‘ä½œæ•°æ®åº“ç´¢å¼•ä¼˜ç‚¹</strong>ï¼š</p><ul><li>ä¼˜ç§€æ£€ç´¢é€Ÿåº¦ï¼Œæ—¶é—´å¤æ‚åº¦ï¼šB æ ‘çš„æŸ¥æ‰¾æ€§èƒ½ç­‰äº O(h*logn)ï¼Œå…¶ä¸­ h ä¸ºæ ‘é«˜ï¼Œn ä¸ºæ¯ä¸ªèŠ‚ç‚¹å…³é”®è¯çš„ä¸ªæ•°ï¼›</li><li>å°½å¯èƒ½å°‘çš„ç£ç›˜ IOï¼ŒåŠ å¿«äº†æ£€ç´¢é€Ÿåº¦ï¼›</li><li>å¯ä»¥æ”¯æŒèŒƒå›´æŸ¥æ‰¾ã€‚</li></ul><p>B-Treeèƒ½åŠ å¿«æ•°æ®çš„è®¿é—®é€Ÿåº¦ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“ä¸å†éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«ææ¥è·å–æ•°æ®ï¼Œä½†æ˜¯æ•°æ®åˆ†å¸ƒåœ¨å„ä¸ªèŠ‚ç‚¹ä¹‹ä¸­ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®é‡æ˜¯æœ‰é™çš„ï¼ŒMySQLå¸Œæœ›ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥å°½å¯èƒ½å¤šçš„å­˜å‚¨æ•°æ®ï¼Œå› æ­¤é‡‡ç”¨äº†B+æ ‘ã€‚</p><h3 id="b-æ ‘-2" tabindex="-1"><a class="header-anchor" href="#b-æ ‘-2" aria-hidden="true">#</a> B+æ ‘</h3><ul><li>Bæ ‘ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨çš„æ˜¯æ•°æ®ï¼Œä¸€ä¸ªèŠ‚ç‚¹ä¸­å­˜å‚¨ä¸äº†å¤ªå¤šæ•°æ®ï¼›è€ŒB+æ ‘éå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯åœ°å€ï¼Œå¶å­ç»“ç‚¹å­˜å‚¨çš„æ˜¯æ•°æ®ï¼Œå¯ä»¥å­˜å‚¨æ›´å¤šæ•°æ®ã€‚</li><li>B+æ•°å¶å­ç»“ç‚¹é‡‡ç”¨é“¾è¡¨ä¸²è”ï¼Œæ›´ä¾¿äºèŒƒå›´æŸ¥æ‰¾ã€‚è€ŒBæ ‘éœ€è¦ä¸­åºéå†ã€‚</li></ul><figure><img src="/assets/20210626115803-e46c33d6.png" alt="B+æ ‘" tabindex="0" loading="lazy"><figcaption>B+æ ‘</figcaption></figure><h2 id="_5-innodb-å¼•æ“å’Œ-myisam-å¼•æ“å¯¹ç´¢å¼•çš„å®ç°" tabindex="-1"><a class="header-anchor" href="#_5-innodb-å¼•æ“å’Œ-myisam-å¼•æ“å¯¹ç´¢å¼•çš„å®ç°" aria-hidden="true">#</a> 5 Innodb å¼•æ“å’Œ Myisam å¼•æ“å¯¹ç´¢å¼•çš„å®ç°</h2><p>Myisam è™½ç„¶æ•°æ®æŸ¥æ‰¾æ€§èƒ½æä½³ï¼Œä½†æ˜¯ä¸æ”¯æŒäº‹åŠ¡å¤„ç†ã€‚Innodb æœ€å¤§çš„ç‰¹è‰²å°±æ˜¯æ”¯æŒäº† ACID å…¼å®¹çš„äº‹åŠ¡åŠŸèƒ½ï¼Œè€Œä¸”ä»–æ”¯æŒè¡Œçº§é”ã€‚Mysql å»ºç«‹è¡¨çš„æ—¶å€™å°±å¯ä»¥æŒ‡å®šå¼•æ“ã€‚B+æ ‘ä½œä¸º Mysql çš„ç´¢å¼•çš„æ•°æ®ç»“æ„éå¸¸åˆé€‚ï¼Œé‚£ä¹ˆä¸¤ç§å¼•æ“æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</p><p>åœ¨æ‰§è¡Œå»ºè¡¨è¯­å¥å¹¶æŒ‡å®šå¼•æ“åï¼ŒInnodb ç”Ÿæˆçš„æ–‡ä»¶æœ‰ï¼š</p><ul><li>frm:åˆ›å»ºè¡¨çš„è¯­å¥</li><li>idb:è¡¨é‡Œé¢çš„æ•°æ®+ç´¢å¼•æ–‡ä»¶</li></ul><p>Myisam ç”Ÿæˆçš„æ–‡ä»¶æœ‰:</p><ul><li>frm:åˆ›å»ºè¡¨çš„è¯­å¥</li><li>MYD:è¡¨é‡Œé¢çš„æ•°æ®æ–‡ä»¶(myisam data)</li><li>MYI:è¡¨é‡Œé¢çš„ç´¢å¼•æ–‡ä»¶(myisam index)</li></ul><p>ä»ç”Ÿæˆçš„æ–‡ä»¶çœ‹æ¥ï¼Œè¿™ä¸¤ä¸ªå¼•æ“åº•å±‚æ•°æ®å’Œç´¢å¼•çš„ç»„ç»‡æ–¹å¼å¹¶ä¸ä¸€æ ·ï¼ŒMyISAM å¼•æ“æŠŠæ•°æ®å’Œç´¢å¼•åˆ†å¼€äº†ï¼Œä¸€äººä¸€ä¸ªæ–‡ä»¶ï¼Œè¿™å«åš<strong>éèšé›†ç´¢å¼•æ–¹å¼</strong>ï¼›Innodb å¼•æ“æŠŠæ•°æ®å’Œç´¢å¼•æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œäº†ï¼Œè¿™å«åš<strong>èšé›†ç´¢å¼•æ–¹å¼</strong>ã€‚</p><p>æ¥ä¸‹æ¥ä»åº•å±‚å®ç°çš„è§’åº¦åˆ†æã€‚</p><p><strong>MyISAM å¼•æ“çš„åº•å±‚å®ç°(éèšé›†ç´¢å¼•æ–¹å¼)</strong></p><p>MyISAM ç”¨çš„æ˜¯éèšé›†ç´¢å¼•æ–¹å¼ï¼Œå³æ•°æ®å’Œç´¢å¼•è½åœ¨ä¸åŒçš„ä¸¤ä¸ªæ–‡ä»¶ä¸Šã€‚MyISAM åœ¨å»ºè¡¨æ—¶<strong>ä»¥ä¸»é”®ä½œä¸º KEY æ¥å»ºç«‹ä¸»ç´¢å¼• B+æ ‘ï¼Œæ ‘çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯å¯¹åº”æ•°æ®çš„ç‰©ç†åœ°å€</strong>ã€‚<strong>é€šè¿‡è¿™ä¸ªç‰©ç†åœ°å€åï¼Œå°±å¯ä»¥åˆ° MyISAM æ•°æ®æ–‡ä»¶ä¸­ç›´æ¥å®šä½åˆ°å…·ä½“çš„æ•°æ®è®°å½•äº†</strong>ã€‚</p><img src="/assets/20210626154923-7973f73f.png" alt="MyISAM å¼•æ“çš„åº•å±‚å®ç°" style="zoom:50%;"><p>åœ¨ä¸ºå…¶ä»–å­—æ®µæ·»åŠ ç´¢å¼•æ—¶ï¼ŒåŒæ ·ä¼šç”Ÿæˆå¯¹åº”çš„ç´¢å¼•æ ‘ï¼Œæ£€ç´¢æ–¹å¼ä¸ä¸Šè¿°ç›¸åŒã€‚</p><p><strong>Innodb å¼•æ“çš„åº•å±‚å®ç°(èšé›†ç´¢å¼•æ–¹å¼)</strong></p><p>InnoDB æ˜¯çš„ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•æ–¹å¼ï¼Œæ•°æ®å’Œç´¢å¼•éƒ½å­˜å‚¨åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œã€‚é¦–å…ˆ InnoDB ä¼šæ ¹æ®ä¸»é”® ID ä½œä¸º KEY å»ºç«‹ç´¢å¼• B+æ ‘ï¼Œè€Œ B+æ ‘çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯ä¸»é”® ID å¯¹åº”çš„æ•°æ®ã€‚åœ¨æ ¹æ®ä¸»é”®IDæŸ¥è¯¢æ—¶ï¼Œä¼šæŸ¥è¯¢è¿™é¢—ä¸»é”®IDçš„ç´¢å¼•æ ‘ï¼Œæ‰¾åˆ°å¯¹åº”å¶å­ç»“ç‚¹çš„æ•°æ®ã€‚</p><p>å»ºè¡¨çš„æ—¶å€™ï¼ŒInnoDBå°±ä¼šå»ºå¥½ä¸»é”®IDçš„ç´¢å¼•æ ‘ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ Mysql åœ¨å»ºè¡¨æ—¶è¦æ±‚å¿…é¡»æŒ‡å®šä¸»é”®çš„åŸå› ã€‚</p><p>åœ¨ä¸ºå…¶ä»–å­—æ®µå»ºç«‹ç´¢å¼•æ—¶ï¼Œéå¶å­ç»“ç‚¹å­˜å‚¨å½“å‰å­—æ®µçš„keyï¼Œ<strong>å¶å­ç»“ç‚¹å­˜å‚¨ä¸»é”®çš„key</strong>ã€‚å¾—åˆ°ä¸»é”®keyåï¼Œæ‰ä¼šåœ¨ä¸»é”®ç´¢å¼•æ ‘ä¸­æ‰¾åˆ°å½“å‰å­—æ®µæ‰€å¯¹åº”çš„æ•°æ®ã€‚</p><img src="/assets/20210626155854-20d7a61d.png" alt="Innodb å¼•æ“çš„åº•å±‚å®ç°" style="zoom:50%;"><p><strong>ä¸ºä»€ä¹ˆ InnoDB åªåœ¨ä¸»é”®ç´¢å¼•æ ‘çš„å¶å­èŠ‚ç‚¹å­˜å‚¨äº†å…·ä½“æ•°æ®ï¼Œä½†æ˜¯å…¶ä»–ç´¢å¼•æ ‘å´ä¸å­˜å…·ä½“æ•°æ®å‘¢ï¼Œè€Œè¦å¤šæ­¤ä¸€ä¸¾å…ˆæ‰¾åˆ°ä¸»é”®ï¼Œå†åœ¨ä¸»é”®ç´¢å¼•æ ‘æ‰¾åˆ°å¯¹åº”çš„æ•°æ®å‘¢</strong>ï¼Ÿ</p><p>å› ä¸º InnoDB è¦èŠ‚çœå­˜å‚¨ç©ºé—´ã€‚ä¸€ä¸ªè¡¨é‡Œå¯èƒ½æœ‰å¾ˆå¤šä¸ªç´¢å¼•ï¼Œå¦‚æœç»™æ¯ä¸ªåŠ äº†ç´¢å¼•çš„å­—æ®µç”Ÿæˆç´¢å¼•æ ‘ï¼Œéƒ½å­˜å‚¨äº†å…·ä½“æ•°æ®ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨çš„ç´¢å¼•æ•°æ®æ–‡ä»¶å°±å˜å¾—éå¸¸å·¨å¤§(æ•°æ®æåº¦å†—ä½™äº†)ã€‚ä»èŠ‚çº¦ç£ç›˜ç©ºé—´çš„è§’åº¦æ¥è¯´ï¼Œæ²¡æœ‰å¿…è¦ï¼Œé€šè¿‡è¿™ç§çœ‹ä¼¼â€œå¤šæ­¤ä¸€ä¸¾â€çš„æ­¥éª¤ï¼Œåœ¨ç‰ºç‰²è¾ƒå°‘æŸ¥è¯¢çš„æ€§èƒ½ä¸‹èŠ‚çœäº†å·¨å¤§çš„ç£ç›˜ç©ºé—´ã€‚</p><p><strong>ä¸ºä»€ä¹ˆInnoDB å’ŒMyISAM å¯¹æ¯”ï¼ŒMyISAM æŸ¥è¯¢æ€§èƒ½æ›´å¥½ï¼Ÿ</strong></p><p>ä»ä¸Šé¢ç´¢å¼•æ–‡ä»¶æ•°æ®æ–‡ä»¶çš„è®¾è®¡æ¥çœ‹ä¹Ÿå¯ä»¥çœ‹å‡ºåŸå› ï¼š</p><ul><li><strong>MyISAM ç›´æ¥æ‰¾åˆ°ç‰©ç†åœ°å€åå°±å¯ä»¥ç›´æ¥å®šä½åˆ°æ•°æ®è®°å½•</strong>ã€‚</li><li><strong>InnoDB æŸ¥è¯¢åˆ°å¶å­èŠ‚ç‚¹åï¼Œè¿˜éœ€è¦å†æŸ¥è¯¢ä¸€æ¬¡ä¸»é”®ç´¢å¼•æ ‘ï¼Œæ‰å¯ä»¥å®šä½åˆ°å…·ä½“æ•°æ®</strong>ã€‚</li></ul><p>ç­‰äº MyISAM ä¸€æ­¥å°±æŸ¥åˆ°äº†æ•°æ®ï¼Œä½†æ˜¯ InnoDB è¦ä¸¤æ­¥ï¼Œæ‰€ä»¥ MyISAM æŸ¥è¯¢æ€§èƒ½æ›´é«˜ã€‚</p><h2 id="_6-innodbä¸­ä¸€æ£µb-æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®" tabindex="-1"><a class="header-anchor" href="#_6-innodbä¸­ä¸€æ£µb-æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®" aria-hidden="true">#</a> 6 InnoDBä¸­ä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿ</h2><p><strong>çº¦ 2 åƒä¸‡</strong></p><p>å‚çœ‹ï¼š</p><ul><li><a href="https://zhuanlan.zhihu.com/p/67982911" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šInnoDBä¸­ä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/379092178" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šmysql ä¸€æ£µ B+ æ ‘èƒ½å­˜å¤šå°‘æ¡æ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="_7-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_7-èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•" aria-hidden="true">#</a> 7 èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼•</h2><blockquote><p>èšç°‡ç´¢å¼•æ˜¯å¶å­ç»“ç‚¹å­˜å‚¨æ•´è¡Œæ•°æ®ï¼Œå³æ•°æ®ä¸ç´¢å¼•å­˜å‚¨åœ¨ä¸€å—ï¼Œæ‰¾åˆ°ç´¢å¼•ä¹Ÿå°±æ‰¾åˆ°äº†æ•°æ®ã€‚InnoDBçš„ä¸»é”®ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ã€‚</p></blockquote><blockquote><p>éèšç°‡ç´¢å¼•æ˜¯å¶å­ç»“ç‚¹å­˜å‚¨äº†ä¸»é”®çš„å€¼ï¼Œä¹Ÿè¢«ç§°ä¸ºäºŒçº§ç´¢å¼•ã€‚</p></blockquote><ul><li>éèšé›†ç´¢å¼•ä¸èšé›†ç´¢å¼•çš„åŒºåˆ«åœ¨äº<strong>éèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸å­˜å‚¨è¡¨ä¸­çš„æ•°æ®ï¼Œè€Œæ˜¯å­˜å‚¨è¯¥åˆ—å¯¹åº”çš„ä¸»é”®</strong>ã€‚</li><li>å¯¹äºInnoDBæ¥è¯´ï¼Œéä¸»é”®çš„ç´¢å¼•æŸ¥åˆ°äº†ä¸»é”®çš„å€¼ï¼Œè¿˜éœ€è¦å»ä¸»é”®ç´¢å¼•æ ‘å†æ¬¡æŸ¥æ‰¾æ•°æ®ï¼Œç§°è¿™ä¸ªè¿‡ç¨‹ä¸º<strong>å›è¡¨</strong>ã€‚</li><li>é€šå¸¸æƒ…å†µä¸‹ï¼Œ ä¸»é”®ç´¢å¼•(èšç°‡ç´¢å¼•)æŸ¥è¯¢åªä¼šæŸ¥ä¸€æ¬¡ï¼Œè€Œéä¸»é”®ç´¢å¼•(éèšç°‡ç´¢å¼•)éœ€è¦å›è¡¨æŸ¥è¯¢å¤šæ¬¡ã€‚</li><li>MyISAMæ— è®ºä¸»é”®ç´¢å¼•è¿˜æ˜¯äºŒçº§ç´¢å¼•éƒ½æ˜¯éèšç°‡ç´¢å¼•ï¼Œè€ŒInnoDBçš„ä¸»é”®ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼ŒäºŒçº§ç´¢å¼•æ˜¯éèšç°‡ç´¢å¼•ã€‚æˆ‘ä»¬è‡ªå·±å»ºçš„ç´¢å¼•åŸºæœ¬éƒ½æ˜¯éèšç°‡ç´¢å¼•ã€‚</li></ul><h2 id="_8-éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—-è¦†ç›–ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_8-éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—-è¦†ç›–ç´¢å¼•" aria-hidden="true">#</a> 8 éèšç°‡ç´¢å¼•ä¸€å®šä¼šå›è¡¨æŸ¥è¯¢å—ï¼Ÿ(è¦†ç›–ç´¢å¼•)</h2><p>ä¸ä¸€å®šï¼Œè¿™æ¶‰åŠåˆ°æŸ¥è¯¢è¯­å¥æ‰€è¦æ±‚çš„å­—æ®µæ˜¯å¦å…¨éƒ¨å‘½ä¸­äº†ç´¢å¼•ï¼Œå¦‚æœå…¨éƒ¨å‘½ä¸­äº†ç´¢å¼•ï¼Œé‚£ä¹ˆå°±ä¸å¿…å†è¿›è¡Œå›è¡¨æŸ¥è¯¢ã€‚ä¸€ä¸ªç´¢å¼•åŒ…å«(è¦†ç›–)æ‰€æœ‰éœ€è¦æŸ¥è¯¢å­—æ®µçš„å€¼ï¼Œè¢«ç§°ä¹‹ä¸º&quot;è¦†ç›–ç´¢å¼•&quot;ã€‚</p><p>ä¾‹å­ï¼šå‡è®¾åœ¨å­¦ç”Ÿè¡¨çš„æˆç»©(<code>score</code>)ä¸Šå»ºç«‹äº†ç´¢å¼•ï¼Œé‚£ä¹ˆå½“è¿›è¡Œ<code>select score from student where score &gt; 90</code>çš„æŸ¥è¯¢æ—¶ï¼Œåœ¨ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œå·²ç»åŒ…å«äº†score ä¿¡æ¯ï¼Œä¸ä¼šå†æ¬¡è¿›è¡Œå›è¡¨æŸ¥è¯¢ã€‚</p><h2 id="_9-è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº" tabindex="-1"><a class="header-anchor" href="#_9-è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåº" aria-hidden="true">#</a> 9 è”åˆç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆéœ€è¦æ³¨æ„è”åˆç´¢å¼•ä¸­çš„é¡ºåºï¼Ÿ</h2><blockquote><p>è”åˆç´¢å¼•ï¼šä½¿ç”¨å¤šä¸ªå­—æ®µåŒæ—¶å»ºç«‹ä¸€ä¸ªç´¢å¼•ã€‚</p></blockquote><p>åœ¨è”åˆç´¢å¼•ä¸­ï¼Œåªæœ‰æŒ‰ç…§å»ºç«‹ç´¢å¼•æ—¶çš„å­—æ®µé¡ºåºä½¿ç”¨ï¼Œæ‰èƒ½å‘½ä¸­ã€‚</p><p>ä¾‹å­ï¼šå‡è®¾å»ºç«‹â€œnameï¼Œageï¼Œschoolâ€çš„è”åˆç´¢å¼•ï¼Œé‚£ä¹ˆç´¢å¼•çš„æ’åºä¸º: å…ˆæŒ‰ç…§nameæ’åºè¿›è¡Œç´¢å¼•ï¼Œå¦‚æœnameç›¸åŒï¼Œåˆ™æŒ‰ç…§ageæ’åºç´¢å¼•ï¼Œå¦‚æœageçš„å€¼ä¹Ÿç›¸ç­‰ï¼Œåˆ™æŒ‰ç…§schoolè¿›è¡Œæ’åºç´¢å¼•ã€‚</p><p>å› æ­¤åœ¨å»ºç«‹è”åˆç´¢å¼•çš„æ—¶å€™åº”è¯¥æ³¨æ„ç´¢å¼•åˆ—çš„é¡ºåºï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°†æŸ¥è¯¢éœ€æ±‚é¢‘ç¹æˆ–è€…å­—æ®µé€‰æ‹©æ€§é«˜çš„åˆ—æ”¾åœ¨å‰é¢ã€‚</p><h2 id="_10-mysqlçš„æœ€å·¦å‰ç¼€åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#_10-mysqlçš„æœ€å·¦å‰ç¼€åŸåˆ™" aria-hidden="true">#</a> 10 MySQLçš„æœ€å·¦å‰ç¼€åŸåˆ™?</h2><p>æœ€å·¦å‰ç¼€åŸåˆ™å°±æ˜¯æœ€å·¦ä¼˜å…ˆï¼Œåœ¨åˆ›å»ºå¤šåˆ—ç´¢å¼•æ—¶ï¼Œè¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œwhereå­å¥ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„ä¸€åˆ—æ”¾åœ¨æœ€å·¦è¾¹ã€‚ mysqlä¼šä¸€ç›´å‘å³åŒ¹é…ç›´åˆ°é‡åˆ°èŒƒå›´æŸ¥è¯¢(&gt;ã€&lt;ã€betweenã€like)å°±åœæ­¢åŒ¹é…ã€‚</p><p>ä¾‹å­ï¼šæ¯”å¦‚<code>a = 1 and b = 2 and c &gt; 3 and d = 4 </code>å¦‚æœå»ºç«‹(a,b,c,d)é¡ºåºçš„ç´¢å¼•ï¼Œdæ˜¯ç”¨ä¸åˆ°ç´¢å¼•çš„ï¼Œå¦‚æœå»ºç«‹(a,b,d,c)çš„ç´¢å¼•åˆ™éƒ½å¯ä»¥ç”¨åˆ°ï¼Œa,b,dçš„é¡ºåºå¯ä»¥ä»»æ„è°ƒæ•´ã€‚</p><p><code>=</code>å’Œ<code>in</code>å¯ä»¥ä¹±åºï¼Œæ¯”å¦‚<code>a = 1 and b = 2 and c = 3</code> å»ºç«‹(a,b,c)ç´¢å¼•å¯ä»¥ä»»æ„é¡ºåºï¼Œmysqlçš„æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šä¼˜åŒ–æˆç´¢å¼•å¯ä»¥è¯†åˆ«çš„å½¢å¼ã€‚</p><h2 id="_11-å‰ç¼€ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_11-å‰ç¼€ç´¢å¼•" aria-hidden="true">#</a> 11 å‰ç¼€ç´¢å¼•ï¼Ÿ</h2><p>å¯èƒ½å‡ºç°å»ºç«‹ç´¢å¼•å­—æ®µéå¸¸é•¿çš„æƒ…å†µï¼Œè¿™æ ·æ—¢å ç”¨å†…å­˜ç©ºé—´ï¼Œä¹Ÿä¸åˆ©äºç»´æŠ¤ã€‚æ‰€ä»¥å¯ä»¥é€‰å–å­—æ®µå‰é¢çš„å…¬å…±éƒ¨åˆ†ä½œä¸ºä¸€ä¸ªç´¢å¼•ï¼Œå¤§å¤§æå‡æ£€ç´¢æ•ˆç‡ã€‚ä½†æ˜¯<code>ORDER BY</code>å’Œ<code>GROUP BY</code>ä¸æ”¯æŒå‰ç¼€ç´¢å¼• ã€‚</p><p>æµç¨‹ï¼š</p><ol><li>è®¡ç®—å®Œæ•´åˆ—çš„é€‰æ‹©æ€§ :<code>select count(distinct col_1)/count(1) from table_1</code></li><li>è®¡ç®—ä¸åŒå‰ç¼€é•¿åº¦çš„é€‰æ‹©æ€§ :<code>select count(distinct left(col_1,4))/count(1) from table_1</code></li><li>æ‰¾åˆ°æœ€ä¼˜é•¿åº¦ä¹‹åï¼Œåˆ›å»ºå‰ç¼€ç´¢å¼• :<code>create index idx_front on table_1 (col_1(4))</code></li></ol><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li>å‰ç¼€ç´¢å¼•æ˜¯ä¸€ç§èƒ½ä½¿ç´¢å¼•æ›´å°ï¼Œæ›´å¿«çš„æœ‰æ•ˆåŠæ³•ï¼Œä½†å¦ä¸€æ–¹é¢ä¹Ÿæœ‰å…¶ç¼ºç‚¹ï¼šmysqlæ— æ³•ä½¿ç”¨å…¶å‰ç¼€ç´¢å¼•åšORDER BYå’ŒGROUP BYï¼Œä¹Ÿæ— æ³•ä½¿ç”¨å‰ç¼€ç´¢å¼•åšè¦†ç›–æ‰«æ</li><li>è¦æ˜ç¡®ä½¿ç”¨å‰ç¼€ç´¢å¼•çš„ç›®çš„ä¸ä¼˜åŠ¿ <ul><li>å¤§å¤§èŠ‚çº¦ç´¢å¼•ç©ºé—´ï¼Œä»è€Œæé«˜ç´¢å¼•æ•ˆç‡</li><li>å¯¹äº BOLB ã€ TEXT æˆ–è€…å¾ˆé•¿çš„ VARCHAR ç±»å‹çš„åˆ—ï¼Œå¿…é¡»ä½¿ç”¨å‰ç¼€ç´¢å¼•,å› ä¸º MySQL ä¸å…è®¸ç´¢å¼•è¿™äº›åˆ—çš„å®Œæ•´é•¿åº¦</li></ul></li><li>å‰ç¼€ç´¢å¼•ä¼šé™ä½ç´¢å¼•çš„é€‰æ‹©æ€§ <ul><li>å…³äºç´¢å¼•çš„é€‰æ‹©æ€§ï¼Œå®ƒæ˜¯æŒ‡ä¸é‡å¤çš„ç´¢å¼•å€¼(ä¹Ÿç§°ä¸ºåŸºæ•°cardinality)å’Œæ•°æ®è¡¨çš„è®°å½•æ€»æ•°çš„æ¯”å€¼ï¼ŒèŒƒå›´ä»1/(æ•°æ®è¡¨è®°å½•æ€»æ•°) åˆ°1ä¹‹é—´ã€‚ç´¢å¼•çš„é€‰æ‹©æ€§è¶Šé«˜åˆ™æŸ¥è¯¢æ•ˆç‡è¶Šé«˜ï¼Œå› ä¸ºé€‰æ‹©æ€§é«˜çš„ç´¢å¼•å¯ä»¥è®©MySQLåœ¨æŸ¥æ‰¾æ—¶è¿‡æ»¤æ‰æ›´å¤šçš„è¡Œã€‚é€‰æ‹©æ€§ä¸º1çš„ç´¢å¼•å«å”¯ä¸€ç´¢å¼•ï¼Œè¿™æ˜¯æœ€å¥½çš„ç´¢å¼•é€‰æ‹©æ€§ï¼Œæ€§èƒ½ä¹Ÿæ˜¯æœ€å¥½çš„ã€‚</li></ul></li><li>çœŸæ­£çš„éš¾ç‚¹åœ¨äºï¼šè¦é€‰æ‹©è¶³å¤Ÿé•¿çš„å‰ç¼€ä»¥ä¿è¯è¾ƒé«˜çš„é€‰æ‹©æ€§ï¼ŒåŒæ—¶åˆä¸èƒ½å¤ªé•¿ï¼Œ å‰ç¼€çš„é•¿åº¦åº”è¯¥ä½¿å‰ç¼€ç´¢å¼•çš„é€‰æ‹©æ€§æ¥è¿‘ç´¢å¼•æ•´ä¸ªåˆ—ï¼Œå³å‰ç¼€çš„åŸºæ•°åº”è¯¥æ¥è¿‘äºå®Œæ•´åˆ—çš„åŸºæ•°</li></ul><p>å‰ç¼€ç´¢å¼•åˆ†æå¯å‚çœ‹ï¼š<a href="https://www.cnblogs.com/niuben/p/13188277.html" target="_blank" rel="noopener noreferrer">MySQL å‰ç¼€ç´¢å¼•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_12-ç´¢å¼•ä¸‹æ¨" tabindex="-1"><a class="header-anchor" href="#_12-ç´¢å¼•ä¸‹æ¨" aria-hidden="true">#</a> 12 ç´¢å¼•ä¸‹æ¨ï¼Ÿ</h2><blockquote><p>MySQL 5.6å¼•å…¥äº†ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ã€‚é»˜è®¤å¼€å¯ï¼Œä½¿ç”¨<code>SET optimizer_switch = &#39; index_condition_pushdown=off &#39;;</code>å¯ä»¥å°†å…¶å…³é—­ã€‚æœ‰äº†ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼Œå¯ä»¥åœ¨<strong>å‡å°‘å›è¡¨æ¬¡æ•°</strong>ã€‚</p></blockquote><p>å®˜æ–¹è§£é‡Šï¼š</p><p>åœ¨ people_tableä¸­æœ‰ä¸€ä¸ªäºŒçº§ç´¢å¼•(zipcodeï¼Œlastnameï¼Œfirstname) ï¼ŒæŸ¥è¯¢è¯­å¥ï¼š<code>SELECT * FROM people WHERE zipcode=&#39;95054&#39; AND lastname LIKE &#39;%etrunia%&#39; AND address LIKE &#39;%Main Street%&#39; ;</code></p><p>å¦‚æœæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ä¸‹æ¨æŠ€æœ¯ï¼Œåˆ™MySQLä¼šé€šè¿‡<code>zipcode=&#39;95054&#39;</code>ä»å­˜å‚¨å¼•æ“ä¸­æŸ¥è¯¢å¯¹åº”çš„æ•°æ®ï¼Œè¿”å›åˆ°MySQLæœåŠ¡ç«¯(<strong>å›è¡¨</strong> )ï¼Œç„¶åMySQLæœåŠ¡ç«¯åŸºäº<code>lastname LIKE &#39;%etrunia%&#39; AND address LIKE &#39;%Main Street%&#39;</code>æ¥åˆ¤æ–­æ•°æ®æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚</p><p>å¦‚æœä½¿ç”¨äº†ç´¢å¼•ä¸‹æ¨æŠ€æœ¯ï¼Œåˆ™MYSQLé¦–å…ˆä¼šè¿”å›ç¬¦åˆ<code>zipcode=&#39;95054&#39;</code>çš„ç´¢å¼•ï¼Œç„¶åæ ¹æ®<code>lastname LIKE &#39;%etrunia%&#39; AND address LIKE &#39;%Main Street%&#39;</code> æ¥åˆ¤æ–­ç´¢å¼•æ˜¯å¦ç¬¦åˆæ¡ä»¶ã€‚å¦‚æœç¬¦åˆæ¡ä»¶ï¼Œåˆ™æ ¹æ®è¯¥ç´¢å¼•æ¥å®šä½å¯¹åº”çš„æ•°æ®ï¼Œå¦‚æœä¸ç¬¦åˆï¼Œåˆ™ç›´æ¥rejectæ‰ã€‚</p><p>æ³¨æ„ï¼š<strong>åœ¨InnoDBä¸­ç´¢å¼•ä¸‹æ¨åªå¯¹äºŒçº§ç´¢å¼•æœ‰æ•ˆ</strong>ã€‚</p><h2 id="_13-æ€ä¹ˆæŸ¥çœ‹mysqlè¯­å¥æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_13-æ€ä¹ˆæŸ¥çœ‹mysqlè¯­å¥æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•" aria-hidden="true">#</a> 13 æ€ä¹ˆæŸ¥çœ‹MySQLè¯­å¥æœ‰æ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼Ÿ</h2><p>å¯ä»¥é€šè¿‡explainæŸ¥çœ‹sqlè¯­å¥çš„æ‰§è¡Œè®¡åˆ’ï¼Œé€šè¿‡æ‰§è¡Œè®¡åˆ’æ¥åˆ†æç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œåªéœ€è¦å°†explainæ·»åŠ åœ¨sqlè¯­å¥ä¹‹å‰å³å¯ã€‚</p><p>è¡¨ä¸­çš„ç´¢å¼•ï¼š</p><figure><img src="/assets/20210626214501-bf03e376.png" alt="è¡¨ä¸­çš„ç´¢å¼•" tabindex="0" loading="lazy"><figcaption>è¡¨ä¸­çš„ç´¢å¼•</figcaption></figure><p>é€šè¿‡explainæŸ¥çœ‹sqlæ˜¯å¦ç”¨åˆ°ç´¢å¼•ï¼š</p><figure><img src="/assets/20210626214556-570837f8.png" alt="explainæŸ¥çœ‹sqlçš„ç»“æœ" tabindex="0" loading="lazy"><figcaption>explainæŸ¥çœ‹sqlçš„ç»“æœ</figcaption></figure><ul><li>type çš„ä¿¡æ¯å¾ˆæ˜æ˜¾çš„ä½“ç°æ˜¯å¦ç”¨åˆ°ç´¢å¼•ï¼Œå®ƒæä¾›äº†åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦é«˜æ•ˆçš„é‡è¦ä¾æ®ä¾æ®ï¼Œå¦‚const(ä¸»é”®ç´¢å¼•æˆ–è€…å”¯ä¸€äºŒçº§ç´¢å¼•è¿›è¡Œç­‰å€¼åŒ¹é…çš„æƒ…å†µä¸‹)ï¼Œref(æ™®é€šçš„â¼†çº§ç´¢å¼•åˆ—ä¸å¸¸é‡è¿›â¾ç­‰å€¼åŒ¹é…)ï¼Œindex(æ‰«æå…¨è¡¨ç´¢å¼•çš„è¦†ç›–ç´¢å¼•) ã€‚æ€§èƒ½å¦‚ä¸‹ï¼š<code>ALL &lt; index &lt; range ~ index_merge &lt; ref &lt; eq_ref &lt; const &lt; system</code>ã€‚ <code>ALL</code> ç±»å‹å› ä¸ºæ˜¯å…¨è¡¨æ‰«æ, å› æ­¤åœ¨ç›¸åŒçš„æŸ¥è¯¢æ¡ä»¶ä¸‹, å®ƒæ˜¯é€Ÿåº¦æœ€æ…¢çš„. è€Œ <code>index</code> ç±»å‹çš„æŸ¥è¯¢è™½ç„¶ä¸æ˜¯å…¨è¡¨æ‰«æ, ä½†æ˜¯å®ƒæ‰«æäº†æ‰€æœ‰çš„ç´¢å¼•, å› æ­¤æ¯” ALL ç±»å‹çš„ç¨å¿«ã€‚</li><li>select_typeï¼šselectå…³é”®å­—å¯¹åº”çš„é‚£ä¸ªæŸ¥è¯¢çš„ç±»å‹ï¼Œå¦‚SIMPLEï¼ŒPRIMARYï¼ŒSUBQUERYï¼ŒDEPENDENTï¼ŒSNION ã€‚</li><li>tableï¼šæ¯ä¸ªæŸ¥è¯¢å¯¹åº”çš„è¡¨å ã€‚</li><li>possible_keyï¼šæŸ¥è¯¢ä¸­å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•</li><li>keyï¼šæ­¤å­—æ®µæ˜¯ MySQL åœ¨å½“å‰æŸ¥è¯¢æ—¶æ‰€çœŸæ­£ä½¿ç”¨åˆ°çš„ç´¢å¼•ã€‚</li><li>filteredï¼šæŸ¥è¯¢å™¨é¢„æµ‹æ»¡è¶³ä¸‹ä¸€æ¬¡æŸ¥è¯¢æ¡ä»¶çš„ç™¾åˆ†æ¯” ã€‚</li><li>rows: æ˜¾ç¤ºMySQLè®¤ä¸ºå®ƒæ‰§è¡ŒæŸ¥è¯¢æ—¶å¿…é¡»æ£€æŸ¥çš„è¡Œæ•°ã€‚è¿™ä¸ªå€¼éå¸¸ç›´è§‚æ˜¾ç¤º SQL çš„æ•ˆç‡å¥½å, åŸåˆ™ä¸Š rows è¶Šå°‘è¶Šå¥½ã€‚</li><li>extraï¼šè¡¨ç¤ºé¢å¤–ä¿¡æ¯ã€‚</li></ul><h2 id="_14-ä»€ä¹ˆæƒ…å†µä¸‹ä¸èµ°ç´¢å¼•-ç´¢å¼•å¤±æ•ˆ" tabindex="-1"><a class="header-anchor" href="#_14-ä»€ä¹ˆæƒ…å†µä¸‹ä¸èµ°ç´¢å¼•-ç´¢å¼•å¤±æ•ˆ" aria-hidden="true">#</a> 14 ä»€ä¹ˆæƒ…å†µä¸‹ä¸èµ°ç´¢å¼•(ç´¢å¼•å¤±æ•ˆ)ï¼Ÿ</h2><ol><li><strong>ä½¿ç”¨<code>!=</code> æˆ–è€… <code>&lt;&gt;</code> å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</strong>ã€‚</li><li><strong>ç±»å‹ä¸ä¸€è‡´å¯¼è‡´çš„ç´¢å¼•å¤±æ•ˆ</strong>ã€‚</li><li><strong>å‡½æ•°å¯¼è‡´çš„ç´¢å¼•å¤±æ•ˆ</strong>ã€‚å¦‚ï¼š<code>SELECT * FROM user WHERE DATE(create_time) = &#39;2020-09-03&#39;;</code> å¦‚æœ<code>create_time</code>æ·»åŠ äº†ç´¢å¼•ï¼Œç´¢å¼•ä¼šå¤±æ•ˆã€‚</li><li><strong>è¿ç®—ç¬¦å¯¼è‡´çš„ç´¢å¼•å¤±æ•ˆ</strong>ã€‚å¦‚ï¼š<code>SELECT * FROM user WHERE age - 1 = 20;</code> å¦‚æœå¯¹åˆ—è¿›è¡Œäº†(+ï¼Œ-ï¼Œ*ï¼Œ/ï¼Œ!), é‚£ä¹ˆéƒ½å°†ä¸ä¼šèµ°ç´¢å¼•ã€‚</li><li><strong><code>OR</code>å¼•èµ·çš„ç´¢å¼•å¤±æ•ˆ</strong>ã€‚ORå¯¼è‡´ç´¢å¼•æ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹çš„ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ORéƒ½æ˜¯ä½¿ç´¢å¼•å¤±æ•ˆï¼Œå¦‚æœORè¿æ¥çš„æ˜¯åŒä¸€ä¸ªå­—æ®µï¼Œé‚£ä¹ˆç´¢å¼•ä¸ä¼šå¤±æ•ˆï¼Œåä¹‹<code>OR</code>å³ä¾§å­—æ®µç´¢å¼•å¤±æ•ˆã€‚</li><li><strong>æ¨¡ç³Šæœç´¢å¯¼è‡´çš„ç´¢å¼•å¤±æ•ˆ</strong>ã€‚å½“<code>%</code>æ”¾åœ¨åŒ¹é…å­—æ®µå‰æ˜¯ä¸èµ°ç´¢å¼•çš„ï¼Œæ”¾åœ¨åé¢æ‰ä¼šèµ°ç´¢å¼•ã€‚</li><li><strong><code>NOT IN</code>ã€<code>NOT EXISTS</code>å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</strong>ã€‚</li></ol><h2 id="_15-ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿æ•°å­—ä¸»é”®ä½œä¸ºç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_15-ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿æ•°å­—ä¸»é”®ä½œä¸ºç´¢å¼•" aria-hidden="true">#</a> 15 ä¸ºä»€ä¹ˆå®˜æ–¹å»ºè®®ä½¿ç”¨è‡ªå¢é•¿æ•°å­—ä¸»é”®ä½œä¸ºç´¢å¼•ï¼Ÿ</h2><p><strong>å»ºè®®ä½¿ç”¨æœ‰åºçš„è‡ªå¢IDä½œä¸ºä¸»é”®</strong></p><p>æé«˜æ•ˆç‡ä¸»è¦ä½“ç°åœ¨ï¼š</p><ul><li>æé«˜èŒƒå›´æŸ¥è¯¢æ•ˆç‡ï¼›</li><li>å¢åŠ æ’åºæ•ˆç‡ï¼›</li><li>æé«˜æ‰«è¡¨èƒ½åŠ›,é¡ºåºè®¿é—®ã€‚</li></ul><p>ç»“åˆB+æ ‘çš„ç‰¹ç‚¹ï¼Œä¸€ä¸ªè¡¨æœ‰å¤šå°‘ä¸ªç´¢å¼•å°±ä¼šæœ‰å¤šå°‘é¢—B+æ ‘ï¼ŒMySQLçš„æ•°æ®éƒ½æ˜¯æŒ‰é¡ºåºä¿å­˜åœ¨æ ‘çš„å¶å­ç»“ç‚¹ä¸Šçš„ã€‚</p><p>mysql åœ¨åº•å±‚åˆæ˜¯ä»¥æ•°æ®é¡µä¸ºå•ä½æ¥å­˜å‚¨æ•°æ®çš„ï¼Œä¸€ä¸ªæ•°æ®é¡µå¤§å°é»˜è®¤ä¸º 16k(å¯ä»¥è‡ªå®šä¹‰å¤§å°)ã€‚å¦‚æœä¸€ä¸ªæ•°æ®é¡µå­˜æ»¡äº†ï¼Œmysql å°±ä¼šå»ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°æ®é¡µæ¥å­˜å‚¨æ•°æ®ã€‚</p><ul><li>å¦‚æœä¸»é”®ä¸ºè‡ªå¢ id çš„è¯ï¼Œmysql åœ¨å†™æ»¡ä¸€ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œç›´æ¥ç”³è¯·å¦ä¸€ä¸ªæ–°æ•°æ®é¡µæ¥ç€å†™å°±å¯ä»¥äº†ã€‚</li><li>å¦‚æœä¸»é”®æ˜¯éè‡ªå¢ idï¼Œä¸ºäº†ç¡®ä¿ç´¢å¼•æœ‰åºï¼Œmysql å°±éœ€è¦å°†æ¯æ¬¡æ’å…¥çš„æ•°æ®éƒ½æ”¾åˆ°åˆé€‚çš„ä½ç½®ä¸Šã€‚å½“å¾€ä¸€ä¸ªå¿«æ»¡æˆ–å·²æ»¡çš„æ•°æ®é¡µä¸­æ’å…¥æ•°æ®æ—¶ï¼Œæ–°æ’å…¥çš„æ•°æ®ä¼šå°†æ•°æ®é¡µå†™æ»¡ï¼Œmysql å°±éœ€è¦ç”³è¯·æ–°çš„æ•°æ®é¡µï¼Œå¹¶ä¸”æŠŠä¸Šä¸ªæ•°æ®é¡µä¸­çš„éƒ¨åˆ†æ•°æ®æŒªåˆ°æ–°çš„æ•°æ®é¡µä¸Šã€‚è¿™å°±é€ æˆäº†é¡µåˆ†è£‚ï¼Œè¿™ä¸ªå¤§é‡ç§»åŠ¨æ•°æ®çš„è¿‡ç¨‹æ˜¯ä¼šä¸¥é‡å½±å“æ’å…¥æ•ˆç‡çš„ã€‚</li></ul><figure><img src="/assets/20210626221023-364923be.png" alt="InnoDBé€»è¾‘ç»“æ„" tabindex="0" loading="lazy"><figcaption>InnoDBé€»è¾‘ç»“æ„</figcaption></figure><p><strong>åœ¨æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œå°½é‡ä½¿ç”¨å ç©ºé—´æ›´å°çš„ä¸»é”®</strong></p><ul><li>ä¸»é”®å ç”¨ç©ºé—´è¶Šå¤§ï¼Œæ¯ä¸ªé¡µå­˜å‚¨çš„ä¸»é”®ä¸ªæ•°è¶Šå°‘ï¼Œè·¯æ ‘å°±è¶Šå°‘ï¼ŒB+æ ‘çš„æ·±åº¦ä¼šè¾¹é•¿ï¼Œå¯¼è‡´IOæ¬¡æ•°ä¼šå˜å¤šã€‚</li><li>æ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šä¿å­˜çš„æ˜¯ä¸»é”® id çš„å€¼ï¼Œå¦‚æœä¸»é”® id å ç©ºé—´è¾ƒå¤§çš„è¯ï¼Œé‚£å°†ä¼šæˆå€å¢åŠ  mysql ç©ºé—´å ç”¨å¤§å°ã€‚</li></ul><figure><img src="/assets/20210626220947-6485abd9.png" alt="ç´¢å¼•æµç¨‹å›¾" tabindex="0" loading="lazy"><figcaption>ç´¢å¼•æµç¨‹å›¾</figcaption></figure><p><strong>æ€»ç»“ï¼šä½¿ç”¨è‡ªå¢ä¸»é”®å¯ä»¥æé«˜æ•ˆç‡(èŒƒå›´æŸ¥è¯¢ã€æ’åºã€æ‰«è¡¨)ï¼Œè€Œä¸”è‡ªå¢æ•°å­—å ç”¨æ›´å°çš„ç©ºé—´ï¼Œå¯ä»¥å­˜å‚¨æ›´å¤šçš„æ•°æ®ã€‚</strong></p><h2 id="_16-å¦‚ä½•åˆ›å»ºç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#_16-å¦‚ä½•åˆ›å»ºç´¢å¼•" aria-hidden="true">#</a> 16 å¦‚ä½•åˆ›å»ºç´¢å¼•ï¼Ÿ</h2><p><strong>1ã€åœ¨æ‰§è¡Œ<code>CREATE TABLE</code>æ—¶åˆ›å»ºç´¢å¼•</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> user_index2
<span class="token punctuation">(</span>
    id          <span class="token keyword">INT</span> <span class="token keyword">auto_increment</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
    name        <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    id_card     <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    information <span class="token keyword">text</span><span class="token punctuation">,</span>
    <span class="token keyword">INDEX</span> <span class="token punctuation">(</span>id_card<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>2ã€ä½¿ç”¨<code>ALTER TABLE</code>å‘½ä»¤å»å¢åŠ ç´¢å¼•</strong></p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">ALTER</span> <span class="token keyword">TABLE</span> table_name
    <span class="token keyword">ADD</span> <span class="token keyword">INDEX</span> index_name <span class="token punctuation">(</span>column_list<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>ALTER TABLEç”¨æ¥åˆ›å»ºæ™®é€šç´¢å¼•ã€UNIQUEç´¢å¼•æˆ–PRIMARY KEYç´¢å¼•ã€‚</p><h2 id="_17-åˆ›å»ºç´¢å¼•æ—¶éœ€è¦æ³¨æ„ä»€ä¹ˆ-å»ºç´¢å¼•çš„åŸåˆ™æœ‰å“ªäº›" tabindex="-1"><a class="header-anchor" href="#_17-åˆ›å»ºç´¢å¼•æ—¶éœ€è¦æ³¨æ„ä»€ä¹ˆ-å»ºç´¢å¼•çš„åŸåˆ™æœ‰å“ªäº›" aria-hidden="true">#</a> 17 åˆ›å»ºç´¢å¼•æ—¶éœ€è¦æ³¨æ„ä»€ä¹ˆï¼Ÿå»ºç´¢å¼•çš„åŸåˆ™æœ‰å“ªäº›ï¼Ÿ</h2><p>æ³¨æ„äº‹é¡¹ï¼š</p><ul><li><strong>è¾ƒé¢‘ç¹çš„ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼•</strong>ã€‚</li><li><strong>å”¯ä¸€æ€§å¤ªå·®çš„å­—æ®µä¸é€‚åˆå•ç‹¬åˆ›å»ºç´¢å¼•</strong>ï¼Œå³ä½¿è¯¥å­—æ®µé¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚</li><li><strong>æ›´æ–°éå¸¸é¢‘ç¹çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•</strong>ã€‚</li><li><strong>éç©ºå­—æ®µ</strong>ï¼šåº”è¯¥æŒ‡å®šåˆ—ä¸ºNOT NULLï¼Œé™¤éä½ æƒ³å­˜å‚¨NULLã€‚åœ¨mysqlä¸­ï¼Œå«æœ‰ç©ºå€¼çš„åˆ—å¾ˆéš¾è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œå› ä¸ºå®ƒä»¬ä½¿å¾—ç´¢å¼•ã€ç´¢å¼•çš„ç»Ÿè®¡ä¿¡æ¯ä»¥åŠæ¯”è¾ƒè¿ç®—æ›´åŠ å¤æ‚ã€‚ä½ åº”è¯¥ç”¨0ã€ä¸€ä¸ªç‰¹æ®Šçš„å€¼æˆ–è€…ä¸€ä¸ªç©ºä¸²ä»£æ›¿ç©ºå€¼ã€‚</li><li><strong>å–å€¼ç¦»æ•£å¤§çš„å­—æ®µ</strong>(å˜é‡å„ä¸ªå–å€¼ä¹‹é—´çš„å·®å¼‚ç¨‹åº¦)ï¼Œå°†å…¶åˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å‰é¢ï¼Œå¯ä»¥é€šè¿‡count()å‡½æ•°æŸ¥çœ‹å­—æ®µçš„å·®å¼‚å€¼ï¼Œè¿”å›å€¼è¶Šå¤§è¯´æ˜å­—æ®µçš„å”¯ä¸€å€¼è¶Šå¤šå­—æ®µçš„ç¦»æ•£ç¨‹åº¦é«˜ã€‚</li><li><strong>ç´¢å¼•å­—æ®µè¶Šå°è¶Šå¥½</strong>ï¼šæ•°æ®åº“çš„æ•°æ®å­˜å‚¨ä»¥é¡µä¸ºå•ä½ä¸€é¡µå­˜å‚¨çš„æ•°æ®è¶Šå¤šä¸€æ¬¡IOæ“ä½œè·å–çš„æ•°æ®è¶Šå¤§æ•ˆç‡è¶Šé«˜ã€‚</li></ul><p>åŸåˆ™ï¼š</p><ul><li><strong>æœ€å·¦å‰ç¼€åŒ¹é…åŸåˆ™</strong>ã€‚åœ¨åˆ›å»ºå¤šåˆ—ç´¢å¼•æ—¶ï¼Œè¦æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œwhereå­å¥ä¸­ä½¿ç”¨æœ€é¢‘ç¹çš„ä¸€åˆ—æ”¾åœ¨æœ€å·¦è¾¹ã€‚</li><li><strong><code>=</code>å’Œ<code>in</code>å¯ä»¥ä¹±åº</strong>ã€‚æ¯”å¦‚<code>a = 1 and b = 2 and c = 3</code> å»ºç«‹(a,b,c)ç´¢å¼•å¯ä»¥ä»»æ„é¡ºåºï¼Œmysqlçš„æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šå¸®ä½ ä¼˜åŒ–æˆç´¢å¼•å¯ä»¥è¯†åˆ«çš„å½¢å¼ã€‚</li><li><strong>å°½é‡é€‰æ‹©åŒºåˆ†åº¦é«˜çš„åˆ—ä½œä¸ºç´¢å¼•</strong>ã€‚åŒºåˆ†åº¦çš„å…¬å¼æ˜¯<code>count(distinct col)/count(*)</code>ï¼Œè¡¨ç¤ºå­—æ®µä¸é‡å¤çš„æ¯”ä¾‹ï¼Œæ¯”ä¾‹è¶Šå¤§æˆ‘ä»¬æ‰«æçš„è®°å½•æ•°è¶Šå°‘ï¼Œå”¯ä¸€é”®çš„åŒºåˆ†åº¦æ˜¯1ã€‚</li><li><strong>ç´¢å¼•åˆ—ä¸èƒ½å‚ä¸è®¡ç®—</strong>ã€‚è®¡ç®—ä»£è¡¨é€»è¾‘è®¡ç®—å’Œä½¿ç”¨å‡½æ•°ï¼Œä¼šä½¿ç´¢å¼•å¤±æ•ˆã€‚</li><li><strong>å°½é‡çš„æ‰©å±•ç´¢å¼•ï¼Œä¸è¦æ–°å»ºç´¢å¼•</strong>ã€‚æ¯”å¦‚è¡¨ä¸­å·²ç»æœ‰açš„ç´¢å¼•ï¼Œç°åœ¨è¦åŠ (a,b)çš„ç´¢å¼•ï¼Œé‚£ä¹ˆåªéœ€è¦ä¿®æ”¹åŸæ¥çš„ç´¢å¼•å³å¯ã€‚</li></ul><h2 id="_18-ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸€å®šèƒ½æé«˜æŸ¥è¯¢çš„æ€§èƒ½å—" tabindex="-1"><a class="header-anchor" href="#_18-ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸€å®šèƒ½æé«˜æŸ¥è¯¢çš„æ€§èƒ½å—" aria-hidden="true">#</a> 18 ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸€å®šèƒ½æé«˜æŸ¥è¯¢çš„æ€§èƒ½å—ï¼Ÿ</h2><p>ä½¿ç”¨ç´¢å¼•æŸ¥è¯¢ä¸ä¸€å®šèƒ½æé«˜æŸ¥è¯¢æ€§èƒ½.</p><p><strong>é€šå¸¸é€šè¿‡ç´¢å¼•æŸ¥è¯¢æ•°æ®æ¯”å…¨è¡¨æ‰«æè¦å¿«ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¿…é¡»æ³¨æ„åˆ°ä½¿ç”¨çš„ä»£ä»·</strong>ã€‚</p><p>ç´¢å¼•éœ€è¦ç©ºé—´æ¥å­˜å‚¨ï¼Œä¹Ÿéœ€è¦å®šæœŸç»´æŠ¤ï¼Œ æ¯å½“æœ‰è®°å½•åœ¨è¡¨ä¸­å¢å‡æˆ–ç´¢å¼•åˆ—è¢«ä¿®æ”¹æ—¶ï¼Œç´¢å¼•æœ¬èº«ä¹Ÿä¼šè¢«ä¿®æ”¹ã€‚</p><p>è¿™æ„å‘³ç€æ¯æ¡è®°å½•çš„<code>INSERT</code>ï¼Œ<code>DELETE</code>ï¼Œ<code>UPDATE</code>å°†ä¸ºæ­¤å¤šä»˜å‡º4ï¼Œ5 æ¬¡çš„ç£ç›˜I/Oã€‚ å› ä¸ºç´¢å¼•éœ€è¦é¢å¤–çš„å­˜å‚¨ç©ºé—´å’Œå¤„ç†ï¼Œé‚£äº›ä¸å¿…è¦çš„ç´¢å¼•åè€Œä¼šä½¿æŸ¥è¯¢ååº”æ—¶é—´å˜æ…¢ã€‚</p><p>ç´¢å¼•èŒƒå›´æŸ¥è¯¢(INDEX RANGE SCAN)é€‚ç”¨äºä¸¤ç§æƒ…å†µ:</p><ol><li><p>åŸºäºä¸€ä¸ªèŒƒå›´çš„æ£€ç´¢ï¼Œä¸€èˆ¬æŸ¥è¯¢è¿”å›ç»“æœé›†å°äºè¡¨ä¸­è®°å½•æ•°çš„30%ã€‚</p></li><li><p>åŸºäºéå”¯ä¸€æ€§ç´¢å¼•çš„æ£€ç´¢ã€‚</p></li></ol><p>å¦åˆ™ç´¢å¼•èŒƒå›´æŸ¥è¯¢çš„æ•ˆç‡ä¼šå¤§å¤§é™ä½ã€‚</p><h2 id="_19-mysqlç´¢å¼•å¯¹nullå€¼å¦‚ä½•å¤„ç†çš„" tabindex="-1"><a class="header-anchor" href="#_19-mysqlç´¢å¼•å¯¹nullå€¼å¦‚ä½•å¤„ç†çš„" aria-hidden="true">#</a> 19. mysqlç´¢å¼•å¯¹Nullå€¼å¦‚ä½•å¤„ç†çš„ï¼Ÿ</h2><ul><li>åªè¦åˆ—ä¸­åŒ…å«æœ‰NULLå€¼éƒ½å°†ä¸ä¼šè¢«åŒ…å«åœ¨ç´¢å¼•ä¸­</li><li>å¤åˆç´¢å¼•ä¸­åªè¦æœ‰ä¸€åˆ—å«æœ‰NULLå€¼ï¼Œé‚£ä¹ˆè¿™ä¸€åˆ—å¯¹äºæ­¤å¤åˆç´¢å¼•å°±æ˜¯æ— æ•ˆçš„ã€‚</li></ul><p>æ‰€ä»¥æˆ‘ä»¬åœ¨æ•°æ®åº“è®¾è®¡æ—¶ä¸è¦è®©å­—æ®µçš„é»˜è®¤å€¼ä¸ºNULLã€‚</p><h2 id="å‚è€ƒ" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ" aria-hidden="true">#</a> å‚è€ƒ</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/113917726" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£ Mysql ç´¢å¼•åº•å±‚åŸç†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (mysqlç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„åŠå®ç°)</li><li><a href="https://zhuanlan.zhihu.com/p/78982303" target="_blank" rel="noopener noreferrer">æˆ‘ä»¥ä¸ºæˆ‘å¯¹Mysqlç´¢å¼•å¾ˆäº†è§£ï¼Œç›´åˆ°æˆ‘é‡åˆ°äº†é˜¿é‡Œçš„é¢è¯•å®˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (mysqlç´¢å¼•å¸¸è§é—®é¢˜)</li><li><a href="https://zhuanlan.zhihu.com/p/364041898" target="_blank" rel="noopener noreferrer">MySQLç´¢å¼•è¿ç¯18é—®ï¼<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (å¾ˆå…¨ï¼ŒåŸºæœ¬éƒ½æ˜¯å¸¸ç”¨çš„)</li><li><a href="https://blog.csdn.net/dhrome/article/details/72853153" target="_blank" rel="noopener noreferrer">mysqlå‰ç¼€ç´¢å¼•çš„ç´¢å¼•é€‰æ‹©æ€§<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/niuben/p/13188277.html" target="_blank" rel="noopener noreferrer">MySQL å‰ç¼€ç´¢å¼•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/67982911" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šInnoDBä¸­ä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/379092178" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šmysql ä¸€æ£µ B+ æ ‘èƒ½å­˜å¤šå°‘æ¡æ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.csdn.net/weixin_33816685/article/details/113276900" target="_blank" rel="noopener noreferrer">mysql å¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰ç”¨åˆ°ç´¢å¼•_mysql å¦‚ä½•æŸ¥çœ‹sqlæŸ¥è¯¢æ˜¯å¦ç”¨åˆ°ç´¢å¼•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/kancy/p/13458991.html" target="_blank" rel="noopener noreferrer">mysql innodbä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨è‡ªå¢æ•°å­—ä½œä¸ºä¸»é”®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/lfs2640666960/p/9147768.html" target="_blank" rel="noopener noreferrer">MySQL å¦‚ä½•åˆ›å»ºç´¢å¼•ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="å‚è€ƒ-1" tabindex="-1"><a class="header-anchor" href="#å‚è€ƒ-1" aria-hidden="true">#</a> å‚è€ƒ</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/113917726" target="_blank" rel="noopener noreferrer">æ·±å…¥ç†è§£ Mysql ç´¢å¼•åº•å±‚åŸç†<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (mysqlç´¢å¼•çš„åº•å±‚æ•°æ®ç»“æ„åŠå®ç°)</li><li><a href="https://zhuanlan.zhihu.com/p/78982303" target="_blank" rel="noopener noreferrer">æˆ‘ä»¥ä¸ºæˆ‘å¯¹Mysqlç´¢å¼•å¾ˆäº†è§£ï¼Œç›´åˆ°æˆ‘é‡åˆ°äº†é˜¿é‡Œçš„é¢è¯•å®˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (mysqlç´¢å¼•å¸¸è§é—®é¢˜)</li><li><a href="https://zhuanlan.zhihu.com/p/364041898" target="_blank" rel="noopener noreferrer">MySQLç´¢å¼•è¿ç¯18é—®ï¼<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> (å¾ˆå…¨ï¼ŒåŸºæœ¬éƒ½æ˜¯å¸¸ç”¨çš„)</li><li><a href="https://blog.csdn.net/dhrome/article/details/72853153" target="_blank" rel="noopener noreferrer">mysqlå‰ç¼€ç´¢å¼•çš„ç´¢å¼•é€‰æ‹©æ€§<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/niuben/p/13188277.html" target="_blank" rel="noopener noreferrer">MySQL å‰ç¼€ç´¢å¼•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/67982911" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šInnoDBä¸­ä¸€æ£µB+æ ‘èƒ½å­˜å¤šå°‘è¡Œæ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://zhuanlan.zhihu.com/p/379092178" target="_blank" rel="noopener noreferrer">é¢è¯•é¢˜ï¼šmysql ä¸€æ£µ B+ æ ‘èƒ½å­˜å¤šå°‘æ¡æ•°æ®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://blog.csdn.net/weixin_33816685/article/details/113276900" target="_blank" rel="noopener noreferrer">mysql å¦‚ä½•æŸ¥çœ‹æ˜¯å¦æœ‰ç”¨åˆ°ç´¢å¼•_mysql å¦‚ä½•æŸ¥çœ‹sqlæŸ¥è¯¢æ˜¯å¦ç”¨åˆ°ç´¢å¼•<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/kancy/p/13458991.html" target="_blank" rel="noopener noreferrer">mysql innodbä¸ºä»€ä¹ˆå»ºè®®ä½¿ç”¨è‡ªå¢æ•°å­—ä½œä¸ºä¸»é”®ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.cnblogs.com/lfs2640666960/p/9147768.html" target="_blank" rel="noopener noreferrer">MySQL å¦‚ä½•åˆ›å»ºç´¢å¼•ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/en/database/dbms/mysql.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page on GitHub" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->Edit this page on GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><!----><!----></div></footer><!----><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Default footer</div><div class="copyright">Copyright Â© 2023 Mr.IIIDelay</div></footer></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app-9ec1fb3d.js" defer></script>
  </body>
</html>
